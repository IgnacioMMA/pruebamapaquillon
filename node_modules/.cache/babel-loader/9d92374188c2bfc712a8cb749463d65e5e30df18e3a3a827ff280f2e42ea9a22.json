{"ast":null,"code":"// src/services/firebaseservices.js\nimport{database}from'../config/firebase';import{ref,set,get,onValue,push,update,remove}from'firebase/database';// ========== SERVICIOS PARA VEH√çCULOS ==========\nexport const vehiculosService={// Escuchar cambios en tiempo real de veh√≠culos\nsubscribeToVehiculos:callback=>{const vehiculosRef=ref(database,'vehiculos');const unsubscribe=onValue(vehiculosRef,snapshot=>{const data=snapshot.val();if(data){const vehiculosArray=Object.entries(data).map(_ref=>{let[id,vehiculo]=_ref;return{id,...vehiculo};});callback(vehiculosArray);}else{callback([]);}});return unsubscribe;},// Actualizar posici√≥n de veh√≠culo\nupdateVehiculoPosition:async(vehiculoId,position)=>{const vehiculoRef=ref(database,`vehiculos/${vehiculoId}`);await update(vehiculoRef,{lat:position.lat,lng:position.lng,ultimaActualizacion:new Date().toISOString()});},// Actualizar estado de veh√≠culo\nupdateVehiculoEstado:async function(vehiculoId,estado){let additionalData=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const vehiculoRef=ref(database,`vehiculos/${vehiculoId}`);await update(vehiculoRef,{estado,...additionalData,ultimaActualizacion:new Date().toISOString()});},// Crear nuevo veh√≠culo\ncreateVehiculo:async vehiculoData=>{const vehiculosRef=ref(database,'vehiculos');const newVehiculoRef=push(vehiculosRef);await set(newVehiculoRef,{...vehiculoData,createdAt:new Date().toISOString()});return newVehiculoRef.key;}};// ========== SERVICIOS PARA ZONAS ==========\nexport const zonasService={// Escuchar cambios en tiempo real de zonas (LEGACY - para compatibilidad)\nsubscribeToZonas:callback=>{const zonasRef=ref(database,'zonas');const unsubscribe=onValue(zonasRef,snapshot=>{const data=snapshot.val();if(data){const zonasArray=Object.entries(data).map(_ref2=>{let[id,zona]=_ref2;return{id,...zona};});callback(zonasArray);}else{callback([]);}});return unsubscribe;},// Escuchar cambios en tiempo real de zonas_asignadas (NUEVO)\nsubscribeToZonasAsignadas:callback=>{const zonasRef=ref(database,'zonas_asignadas');const unsubscribe=onValue(zonasRef,snapshot=>{const data=snapshot.val();console.log('üìç Zonas asignadas desde Firebase:',data);// Debug\nif(data){const zonasArray=Object.entries(data).map(_ref3=>{let[id,zona]=_ref3;return{id,...zona};});console.log('üìç Zonas procesadas:',zonasArray);// Debug\ncallback(zonasArray);}else{console.log('‚ö†Ô∏è No hay zonas en zonas_asignadas');callback([]);}});return unsubscribe;},// Actualizar progreso de zona\nupdateZonaProgreso:async(zonaId,progreso)=>{const zonaRef=ref(database,`zonas/${zonaId}`);await update(zonaRef,{progreso,estado:progreso===100?'completada':'activa',ultimaActualizacion:new Date().toISOString()});},// Actualizar estado de zona\nupdateZonaEstado:async function(zonaId,estado){let additionalData=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const zonaRef=ref(database,`zonas/${zonaId}`);await update(zonaRef,{estado,...additionalData,ultimaActualizacion:new Date().toISOString()});},// Crear nueva zona\ncreateZona:async zonaData=>{const zonasRef=ref(database,'zonas');const newZonaRef=push(zonasRef);await set(newZonaRef,{...zonaData,createdAt:new Date().toISOString()});return newZonaRef.key;},// Eliminar zona\ndeleteZona:async zonaId=>{const zonaRef=ref(database,`zonas/${zonaId}`);await remove(zonaRef);}};// ========== SERVICIOS PARA TRABAJADORES ==========\nexport const trabajadoresService={// Escuchar cambios en tiempo real de trabajadores\nsubscribeToTrabajadores:callback=>{const trabajadoresRef=ref(database,'trabajadores');const unsubscribe=onValue(trabajadoresRef,snapshot=>{const data=snapshot.val();if(data){const trabajadoresArray=Object.entries(data).map(_ref4=>{let[id,trabajador]=_ref4;return{id,...trabajador};});callback(trabajadoresArray);}else{callback([]);}});return unsubscribe;},// Crear o actualizar trabajador (funci√≥n para registro inicial)\ncreateOrUpdateTrabajador:async(trabajadorId,data)=>{const trabajadorRef=ref(database,`trabajadores/${trabajadorId}`);await set(trabajadorRef,{...data,ultimaActualizacion:new Date().toISOString()});},// Actualizar datos generales del trabajador\nupdateTrabajadorData:async(trabajadorId,data)=>{const trabajadorRef=ref(database,`trabajadores/${trabajadorId}`);await update(trabajadorRef,{...data,ultimaActualizacion:new Date().toISOString()});},// Actualizar ubicaci√≥n GPS del trabajador con historial\nupdateTrabajadorLocation:async(trabajadorId,location)=>{try{// Actualizar ubicaci√≥n actual\nconst ubicacionRef=ref(database,`trabajadores/${trabajadorId}/ubicacion`);await set(ubicacionRef,{lat:location.lat,lng:location.lng,timestamp:location.timestamp||new Date().toISOString()});// Guardar en historial de ubicaciones (opcional - √∫til para tracking)\nconst historialRef=ref(database,`historial_ubicaciones/${trabajadorId}/${Date.now()}`);await set(historialRef,{lat:location.lat,lng:location.lng,timestamp:location.timestamp||new Date().toISOString()});console.log('‚úÖ Ubicaci√≥n actualizada en Firebase');}catch(error){console.error('‚ùå Error al actualizar ubicaci√≥n:',error);throw error;}},// Obtener trabajador por ID\ngetTrabajadorById:(trabajadorId,callback)=>{const trabajadorRef=ref(database,`trabajadores/${trabajadorId}`);const unsubscribe=onValue(trabajadorRef,snapshot=>{const data=snapshot.val();callback(data?{id:trabajadorId,...data}:null);});return unsubscribe;},// Iniciar recorrido\nstartRecorrido:async(trabajadorId,zonaData)=>{const recorridoId=`${trabajadorId}_${Date.now()}`;const recorridoRef=ref(database,`recorridos/${recorridoId}`);const recorridoData={trabajadorId,zonaId:zonaData.id,zonaNombre:zonaData.nombre,zonaLat:zonaData.lat,zonaLng:zonaData.lng,horaInicio:new Date().toISOString(),estado:'en_camino'};await set(recorridoRef,recorridoData);// Actualizar estado del trabajador\nconst trabajadorRef=ref(database,`trabajadores/${trabajadorId}`);await update(trabajadorRef,{estado:'en_camino',zonaDestino:zonaData.nombre,recorridoActual:recorridoId});return recorridoId;},// Marcar llegada a zona\nmarkArrival:async(recorridoId,trabajadorId)=>{const recorridoRef=ref(database,`recorridos/${recorridoId}`);await update(recorridoRef,{horaLlegada:new Date().toISOString(),estado:'trabajando'});const trabajadorRef=ref(database,`trabajadores/${trabajadorId}`);await update(trabajadorRef,{estado:'trabajando',horaLlegada:new Date().toISOString()});},// Finalizar trabajo\nfinishWork:async(recorridoId,trabajadorId)=>{const recorridoRef=ref(database,`recorridos/${recorridoId}`);await update(recorridoRef,{horaFin:new Date().toISOString(),estado:'completado'});const trabajadorRef=ref(database,`trabajadores/${trabajadorId}`);await update(trabajadorRef,{estado:'disponible',zonaDestino:null,recorridoActual:null});},// Obtener historial de recorridos\ngetRecorridosHistory:(trabajadorId,callback)=>{const recorridosRef=ref(database,'recorridos');const unsubscribe=onValue(recorridosRef,snapshot=>{const data=snapshot.val();if(data){const recorridos=Object.entries(data).filter(_ref5=>{let[id,recorrido]=_ref5;return recorrido.trabajadorId===trabajadorId;}).map(_ref6=>{let[id,recorrido]=_ref6;return{id,...recorrido};}).sort((a,b)=>new Date(b.horaInicio)-new Date(a.horaInicio));callback(recorridos);}else{callback([]);}});return unsubscribe;},// Obtener todos los recorridos\ngetAllRecorridos:callback=>{const recorridosRef=ref(database,'recorridos');const unsubscribe=onValue(recorridosRef,snapshot=>{const data=snapshot.val();if(data){const recorridos=Object.entries(data).map(_ref7=>{let[id,recorrido]=_ref7;return{id,...recorrido};}).sort((a,b)=>new Date(b.horaInicio)-new Date(a.horaInicio));callback(recorridos);}else{callback([]);}});return unsubscribe;},// Limpiar historial de ubicaciones antiguas (m√°s de 7 d√≠as)\ncleanOldLocationHistory:async()=>{const historialRef=ref(database,'historial_ubicaciones');const snapshot=await get(historialRef);const data=snapshot.val();if(data){const sevenDaysAgo=Date.now()-7*24*60*60*1000;for(const trabajadorId in data){for(const timestamp in data[trabajadorId]){if(parseInt(timestamp)<sevenDaysAgo){const oldRef=ref(database,`historial_ubicaciones/${trabajadorId}/${timestamp}`);await remove(oldRef);}}}}}};// ========== SERVICIOS DE NOTIFICACIONES ==========\nexport const notificacionesService={// Enviar notificaci√≥n\nsendNotification:async notificationData=>{const notificacionesRef=ref(database,'notificaciones');const newNotifRef=push(notificacionesRef);await set(newNotifRef,{...notificationData,timestamp:new Date().toISOString(),leido:false});return newNotifRef.key;},// Escuchar notificaciones para un usuario\nsubscribeToNotifications:(userId,callback)=>{const notificacionesRef=ref(database,'notificaciones');const unsubscribe=onValue(notificacionesRef,snapshot=>{const data=snapshot.val();if(data){const notificaciones=Object.entries(data).filter(_ref8=>{let[id,notif]=_ref8;return notif.destinatario===userId;}).map(_ref9=>{let[id,notif]=_ref9;return{id,...notif};}).sort((a,b)=>new Date(b.timestamp)-new Date(a.timestamp));callback(notificaciones);}else{callback([]);}});return unsubscribe;},// Marcar notificaci√≥n como le√≠da\nmarkAsRead:async notificationId=>{const notifRef=ref(database,`notificaciones/${notificationId}`);await update(notifRef,{leido:true});},// Eliminar notificaci√≥n\ndeleteNotification:async notificationId=>{const notifRef=ref(database,`notificaciones/${notificationId}`);await remove(notifRef);},// Eliminar todas las notificaciones de un usuario\nclearUserNotifications:async userId=>{const notificacionesRef=ref(database,'notificaciones');const snapshot=await get(notificacionesRef);const data=snapshot.val();if(data){const toDelete=Object.entries(data).filter(_ref0=>{let[id,notif]=_ref0;return notif.destinatario===userId;}).map(_ref1=>{let[id]=_ref1;return id;});for(const id of toDelete){await remove(ref(database,`notificaciones/${id}`));}}}};// ========== SERVICIOS DE REPORTES ==========\nexport const reportesService={// Guardar reporte diario\nsaveDailyReport:async reportData=>{const fecha=new Date().toISOString().split('T')[0];const reportRef=ref(database,`reportes/diarios/${fecha}`);await set(reportRef,{...reportData,fecha,timestamp:new Date().toISOString()});},// Obtener reporte por fecha\ngetReportByDate:(fecha,callback)=>{const reportRef=ref(database,`reportes/diarios/${fecha}`);const unsubscribe=onValue(reportRef,snapshot=>{callback(snapshot.val());});return unsubscribe;},// Obtener reportes del mes\ngetMonthlyReports:(year,month,callback)=>{const reportesRef=ref(database,'reportes/diarios');const unsubscribe=onValue(reportesRef,snapshot=>{const data=snapshot.val();if(data){const monthReports=Object.entries(data).filter(_ref10=>{let[fecha]=_ref10;const[reportYear,reportMonth]=fecha.split('-');return reportYear===year.toString()&&reportMonth===month.toString().padStart(2,'0');}).map(_ref11=>{let[fecha,report]=_ref11;return{fecha,...report};});callback(monthReports);}else{callback([]);}});return unsubscribe;},// Obtener estad√≠sticas en tiempo real - VERSI√ìN MEJORADA\ngetRealtimeStats:callback=>{console.log('üìä Iniciando servicio de estad√≠sticas en tiempo real');const stats={vehiculos:{total:0,activos:0,enMantenimiento:0},zonas:{total:0,activas:0,completadas:0,pendientes:0},trabajadores:{total:0,enRuta:0,trabajando:0,disponibles:0}};// Escuchar veh√≠culos\nconst vehiculosRef=ref(database,'vehiculos');onValue(vehiculosRef,snapshot=>{const data=snapshot.val();console.log('üöõ Veh√≠culos recibidos:',data);if(data){const vehiculos=Object.values(data);stats.vehiculos.total=vehiculos.length;stats.vehiculos.enUso=vehiculos.filter(v=>v.estado==='en_uso'// ‚úÖ Contar correctamente 'en_uso'\n).length;stats.vehiculos.activos=vehiculos.filter(v=>v.estado==='disponible'||v.estado==='en_uso'// ‚úÖ Activos = disponibles + en_uso\n).length;stats.vehiculos.enMantenimiento=vehiculos.filter(v=>v.estado==='mantenimiento').length;}else{stats.vehiculos={total:0,activos:0,enMantenimiento:0};}callback({...stats});});// Escuchar zonas_asignadas\nconst zonasRef=ref(database,'zonas_asignadas');onValue(zonasRef,snapshot=>{const data=snapshot.val();console.log('üèóÔ∏è Zonas asignadas recibidas:',data);if(data){const zonas=Object.values(data);stats.zonas.total=zonas.length;stats.zonas.activas=zonas.filter(z=>z.estado==='en_progreso').length;stats.zonas.completadas=zonas.filter(z=>z.estado==='completado').length;stats.zonas.pendientes=zonas.filter(z=>z.estado==='pendiente'||!z.estado).length;console.log('üìä Estad√≠sticas de zonas:',stats.zonas);}else{stats.zonas={total:0,activas:0,completadas:0,pendientes:0};}callback({...stats});});// Escuchar trabajadores\nconst trabajadoresRef=ref(database,'trabajadores');onValue(trabajadoresRef,snapshot=>{const data=snapshot.val();console.log('üë∑ Trabajadores recibidos:',data);if(data){const trabajadores=Object.values(data);stats.trabajadores.total=trabajadores.length;stats.trabajadores.enRuta=trabajadores.filter(t=>t.estado==='en_camino').length;stats.trabajadores.trabajando=trabajadores.filter(t=>t.estado==='trabajando').length;stats.trabajadores.disponibles=trabajadores.filter(t=>t.estado==='disponible'||t.estado==='activo'||!t.estado).length;console.log('üìä Estad√≠sticas de trabajadores:',stats.trabajadores);}else{stats.trabajadores={total:0,enRuta:0,trabajando:0,disponibles:0};}callback({...stats});});},// En vehiculosService, agregar:\ngetVehiculosDisponibles:callback=>{const vehiculosRef=ref(database,'vehiculos');const unsubscribe=onValue(vehiculosRef,snapshot=>{const data=snapshot.val();if(data){const vehiculosArray=Object.entries(data).filter(_ref12=>{let[id,vehiculo]=_ref12;return vehiculo.estado==='disponible';}).map(_ref13=>{let[id,vehiculo]=_ref13;return{id,...vehiculo};});callback(vehiculosArray);}else{callback([]);}});return unsubscribe;},// Asignar veh√≠culo a trabajador\nassignVehiculoToTrabajador:async(vehiculoId,trabajadorId,trabajadorNombre)=>{const vehiculoRef=ref(database,`vehiculos/${vehiculoId}`);await update(vehiculoRef,{estado:'en_uso',asignadoA:trabajadorId,asignadoNombre:trabajadorNombre,fechaAsignacion:new Date().toISOString()});},// Liberar veh√≠culo\nreleaseVehiculo:async vehiculoId=>{const vehiculoRef=ref(database,`vehiculos/${vehiculoId}`);await update(vehiculoRef,{estado:'disponible',asignadoA:null,asignadoNombre:null,destino:null,fechaAsignacion:null});},// Generar reporte de productividad\ngenerateProductivityReport:async(startDate,endDate)=>{const recorridosRef=ref(database,'recorridos');const snapshot=await get(recorridosRef);const data=snapshot.val();if(data){const recorridos=Object.values(data).filter(r=>{const fecha=new Date(r.horaInicio);return fecha>=new Date(startDate)&&fecha<=new Date(endDate);});// Calcular estad√≠sticas\nconst stats={totalRecorridos:recorridos.length,recorridosCompletados:recorridos.filter(r=>r.estado==='completado').length,tiempoPromedioViaje:0,tiempoPromedioTrabajo:0,trabajadoresActivos:new Set(recorridos.map(r=>r.trabajadorId)).size};// Calcular tiempos promedio\nconst tiemposViaje=[];const tiemposTrabajo=[];recorridos.forEach(r=>{if(r.horaLlegada&&r.horaInicio){const tiempoViaje=new Date(r.horaLlegada)-new Date(r.horaInicio);tiemposViaje.push(tiempoViaje);}if(r.horaFin&&r.horaLlegada){const tiempoTrabajo=new Date(r.horaFin)-new Date(r.horaLlegada);tiemposTrabajo.push(tiempoTrabajo);}});if(tiemposViaje.length>0){stats.tiempoPromedioViaje=tiemposViaje.reduce((a,b)=>a+b,0)/tiemposViaje.length;}if(tiemposTrabajo.length>0){stats.tiempoPromedioTrabajo=tiemposTrabajo.reduce((a,b)=>a+b,0)/tiemposTrabajo.length;}return stats;}return null;}};// ========== SERVICIO DE LIMPIEZA AUTOM√ÅTICA ==========\nexport const maintenanceService={// Limpiar datos antiguos (ejecutar peri√≥dicamente)\ncleanOldData:async()=>{try{// Limpiar historial de ubicaciones de m√°s de 7 d√≠as\nawait trabajadoresService.cleanOldLocationHistory();// Limpiar notificaciones le√≠das de m√°s de 30 d√≠as\nconst notificacionesRef=ref(database,'notificaciones');const snapshot=await get(notificacionesRef);const data=snapshot.val();if(data){const thirtyDaysAgo=new Date(Date.now()-30*24*60*60*1000);for(const[id,notif]of Object.entries(data)){if(notif.leido&&new Date(notif.timestamp)<thirtyDaysAgo){await remove(ref(database,`notificaciones/${id}`));}}}console.log('‚úÖ Limpieza de datos antiguos completada');}catch(error){console.error('‚ùå Error en limpieza de datos:',error);}}};","map":{"version":3,"names":["database","ref","set","get","onValue","push","update","remove","vehiculosService","subscribeToVehiculos","callback","vehiculosRef","unsubscribe","snapshot","data","val","vehiculosArray","Object","entries","map","_ref","id","vehiculo","updateVehiculoPosition","vehiculoId","position","vehiculoRef","lat","lng","ultimaActualizacion","Date","toISOString","updateVehiculoEstado","estado","additionalData","arguments","length","undefined","createVehiculo","vehiculoData","newVehiculoRef","createdAt","key","zonasService","subscribeToZonas","zonasRef","zonasArray","_ref2","zona","subscribeToZonasAsignadas","console","log","_ref3","updateZonaProgreso","zonaId","progreso","zonaRef","updateZonaEstado","createZona","zonaData","newZonaRef","deleteZona","trabajadoresService","subscribeToTrabajadores","trabajadoresRef","trabajadoresArray","_ref4","trabajador","createOrUpdateTrabajador","trabajadorId","trabajadorRef","updateTrabajadorData","updateTrabajadorLocation","location","ubicacionRef","timestamp","historialRef","now","error","getTrabajadorById","startRecorrido","recorridoId","recorridoRef","recorridoData","zonaNombre","nombre","zonaLat","zonaLng","horaInicio","zonaDestino","recorridoActual","markArrival","horaLlegada","finishWork","horaFin","getRecorridosHistory","recorridosRef","recorridos","filter","_ref5","recorrido","_ref6","sort","a","b","getAllRecorridos","_ref7","cleanOldLocationHistory","sevenDaysAgo","parseInt","oldRef","notificacionesService","sendNotification","notificationData","notificacionesRef","newNotifRef","leido","subscribeToNotifications","userId","notificaciones","_ref8","notif","destinatario","_ref9","markAsRead","notificationId","notifRef","deleteNotification","clearUserNotifications","toDelete","_ref0","_ref1","reportesService","saveDailyReport","reportData","fecha","split","reportRef","getReportByDate","getMonthlyReports","year","month","reportesRef","monthReports","_ref10","reportYear","reportMonth","toString","padStart","_ref11","report","getRealtimeStats","stats","vehiculos","total","activos","enMantenimiento","zonas","activas","completadas","pendientes","trabajadores","enRuta","trabajando","disponibles","values","enUso","v","z","t","getVehiculosDisponibles","_ref12","_ref13","assignVehiculoToTrabajador","trabajadorNombre","asignadoA","asignadoNombre","fechaAsignacion","releaseVehiculo","destino","generateProductivityReport","startDate","endDate","r","totalRecorridos","recorridosCompletados","tiempoPromedioViaje","tiempoPromedioTrabajo","trabajadoresActivos","Set","size","tiemposViaje","tiemposTrabajo","forEach","tiempoViaje","tiempoTrabajo","reduce","maintenanceService","cleanOldData","thirtyDaysAgo"],"sources":["C:/Users/Izan/Desktop/AppReact/mapa-quillon/src/services/firebaseservices.js"],"sourcesContent":["// src/services/firebaseservices.js\r\nimport { database } from '../config/firebase';\r\nimport { ref, set, get, onValue, push, update, remove } from 'firebase/database';\r\n\r\n// ========== SERVICIOS PARA VEH√çCULOS ==========\r\n\r\nexport const vehiculosService = {\r\n  // Escuchar cambios en tiempo real de veh√≠culos\r\n  subscribeToVehiculos: (callback) => {\r\n    const vehiculosRef = ref(database, 'vehiculos');\r\n    const unsubscribe = onValue(vehiculosRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const vehiculosArray = Object.entries(data).map(([id, vehiculo]) => ({\r\n          id,\r\n          ...vehiculo\r\n        }));\r\n        callback(vehiculosArray);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Actualizar posici√≥n de veh√≠culo\r\n  updateVehiculoPosition: async (vehiculoId, position) => {\r\n    const vehiculoRef = ref(database, `vehiculos/${vehiculoId}`);\r\n    await update(vehiculoRef, {\r\n      lat: position.lat,\r\n      lng: position.lng,\r\n      ultimaActualizacion: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Actualizar estado de veh√≠culo\r\n  updateVehiculoEstado: async (vehiculoId, estado, additionalData = {}) => {\r\n    const vehiculoRef = ref(database, `vehiculos/${vehiculoId}`);\r\n    await update(vehiculoRef, {\r\n      estado,\r\n      ...additionalData,\r\n      ultimaActualizacion: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Crear nuevo veh√≠culo\r\n  createVehiculo: async (vehiculoData) => {\r\n    const vehiculosRef = ref(database, 'vehiculos');\r\n    const newVehiculoRef = push(vehiculosRef);\r\n    await set(newVehiculoRef, {\r\n      ...vehiculoData,\r\n      createdAt: new Date().toISOString()\r\n    });\r\n    return newVehiculoRef.key;\r\n  }\r\n};\r\n\r\n// ========== SERVICIOS PARA ZONAS ==========\r\n\r\nexport const zonasService = {\r\n  // Escuchar cambios en tiempo real de zonas (LEGACY - para compatibilidad)\r\n  subscribeToZonas: (callback) => {\r\n    const zonasRef = ref(database, 'zonas');\r\n    const unsubscribe = onValue(zonasRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const zonasArray = Object.entries(data).map(([id, zona]) => ({\r\n          id,\r\n          ...zona\r\n        }));\r\n        callback(zonasArray);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Escuchar cambios en tiempo real de zonas_asignadas (NUEVO)\r\n  subscribeToZonasAsignadas: (callback) => {\r\n    const zonasRef = ref(database, 'zonas_asignadas');\r\n    const unsubscribe = onValue(zonasRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      console.log('üìç Zonas asignadas desde Firebase:', data); // Debug\r\n      if (data) {\r\n        const zonasArray = Object.entries(data).map(([id, zona]) => ({\r\n          id,\r\n          ...zona\r\n        }));\r\n        console.log('üìç Zonas procesadas:', zonasArray); // Debug\r\n        callback(zonasArray);\r\n      } else {\r\n        console.log('‚ö†Ô∏è No hay zonas en zonas_asignadas');\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Actualizar progreso de zona\r\n  updateZonaProgreso: async (zonaId, progreso) => {\r\n    const zonaRef = ref(database, `zonas/${zonaId}`);\r\n    await update(zonaRef, {\r\n      progreso,\r\n      estado: progreso === 100 ? 'completada' : 'activa',\r\n      ultimaActualizacion: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Actualizar estado de zona\r\n  updateZonaEstado: async (zonaId, estado, additionalData = {}) => {\r\n    const zonaRef = ref(database, `zonas/${zonaId}`);\r\n    await update(zonaRef, {\r\n      estado,\r\n      ...additionalData,\r\n      ultimaActualizacion: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Crear nueva zona\r\n  createZona: async (zonaData) => {\r\n    const zonasRef = ref(database, 'zonas');\r\n    const newZonaRef = push(zonasRef);\r\n    await set(newZonaRef, {\r\n      ...zonaData,\r\n      createdAt: new Date().toISOString()\r\n    });\r\n    return newZonaRef.key;\r\n  },\r\n\r\n  // Eliminar zona\r\n  deleteZona: async (zonaId) => {\r\n    const zonaRef = ref(database, `zonas/${zonaId}`);\r\n    await remove(zonaRef);\r\n  }\r\n};\r\n\r\n// ========== SERVICIOS PARA TRABAJADORES ==========\r\n\r\nexport const trabajadoresService = {\r\n  // Escuchar cambios en tiempo real de trabajadores\r\n  subscribeToTrabajadores: (callback) => {\r\n    const trabajadoresRef = ref(database, 'trabajadores');\r\n    const unsubscribe = onValue(trabajadoresRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const trabajadoresArray = Object.entries(data).map(([id, trabajador]) => ({\r\n          id,\r\n          ...trabajador\r\n        }));\r\n        callback(trabajadoresArray);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Crear o actualizar trabajador (funci√≥n para registro inicial)\r\n  createOrUpdateTrabajador: async (trabajadorId, data) => {\r\n    const trabajadorRef = ref(database, `trabajadores/${trabajadorId}`);\r\n    await set(trabajadorRef, {\r\n      ...data,\r\n      ultimaActualizacion: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Actualizar datos generales del trabajador\r\n  updateTrabajadorData: async (trabajadorId, data) => {\r\n    const trabajadorRef = ref(database, `trabajadores/${trabajadorId}`);\r\n    await update(trabajadorRef, {\r\n      ...data,\r\n      ultimaActualizacion: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Actualizar ubicaci√≥n GPS del trabajador con historial\r\n  updateTrabajadorLocation: async (trabajadorId, location) => {\r\n    try {\r\n      // Actualizar ubicaci√≥n actual\r\n      const ubicacionRef = ref(database, `trabajadores/${trabajadorId}/ubicacion`);\r\n      await set(ubicacionRef, {\r\n        lat: location.lat,\r\n        lng: location.lng,\r\n        timestamp: location.timestamp || new Date().toISOString()\r\n      });\r\n      \r\n      // Guardar en historial de ubicaciones (opcional - √∫til para tracking)\r\n      const historialRef = ref(database, `historial_ubicaciones/${trabajadorId}/${Date.now()}`);\r\n      await set(historialRef, {\r\n        lat: location.lat,\r\n        lng: location.lng,\r\n        timestamp: location.timestamp || new Date().toISOString()\r\n      });\r\n\r\n      console.log('‚úÖ Ubicaci√≥n actualizada en Firebase');\r\n    } catch (error) {\r\n      console.error('‚ùå Error al actualizar ubicaci√≥n:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Obtener trabajador por ID\r\n  getTrabajadorById: (trabajadorId, callback) => {\r\n    const trabajadorRef = ref(database, `trabajadores/${trabajadorId}`);\r\n    const unsubscribe = onValue(trabajadorRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      callback(data ? { id: trabajadorId, ...data } : null);\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Iniciar recorrido\r\n  startRecorrido: async (trabajadorId, zonaData) => {\r\n    const recorridoId = `${trabajadorId}_${Date.now()}`;\r\n    const recorridoRef = ref(database, `recorridos/${recorridoId}`);\r\n    const recorridoData = {\r\n      trabajadorId,\r\n      zonaId: zonaData.id,\r\n      zonaNombre: zonaData.nombre,\r\n      zonaLat: zonaData.lat,\r\n      zonaLng: zonaData.lng,\r\n      horaInicio: new Date().toISOString(),\r\n      estado: 'en_camino'\r\n    };\r\n    \r\n    await set(recorridoRef, recorridoData);\r\n    \r\n    // Actualizar estado del trabajador\r\n    const trabajadorRef = ref(database, `trabajadores/${trabajadorId}`);\r\n    await update(trabajadorRef, {\r\n      estado: 'en_camino',\r\n      zonaDestino: zonaData.nombre,\r\n      recorridoActual: recorridoId\r\n    });\r\n    \r\n    return recorridoId;\r\n  },\r\n\r\n  // Marcar llegada a zona\r\n  markArrival: async (recorridoId, trabajadorId) => {\r\n    const recorridoRef = ref(database, `recorridos/${recorridoId}`);\r\n    await update(recorridoRef, {\r\n      horaLlegada: new Date().toISOString(),\r\n      estado: 'trabajando'\r\n    });\r\n\r\n    const trabajadorRef = ref(database, `trabajadores/${trabajadorId}`);\r\n    await update(trabajadorRef, {\r\n      estado: 'trabajando',\r\n      horaLlegada: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Finalizar trabajo\r\n  finishWork: async (recorridoId, trabajadorId) => {\r\n    const recorridoRef = ref(database, `recorridos/${recorridoId}`);\r\n    await update(recorridoRef, {\r\n      horaFin: new Date().toISOString(),\r\n      estado: 'completado'\r\n    });\r\n\r\n    const trabajadorRef = ref(database, `trabajadores/${trabajadorId}`);\r\n    await update(trabajadorRef, {\r\n      estado: 'disponible',\r\n      zonaDestino: null,\r\n      recorridoActual: null\r\n    });\r\n  },\r\n\r\n  // Obtener historial de recorridos\r\n  getRecorridosHistory: (trabajadorId, callback) => {\r\n    const recorridosRef = ref(database, 'recorridos');\r\n    const unsubscribe = onValue(recorridosRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const recorridos = Object.entries(data)\r\n          .filter(([id, recorrido]) => recorrido.trabajadorId === trabajadorId)\r\n          .map(([id, recorrido]) => ({ id, ...recorrido }))\r\n          .sort((a, b) => new Date(b.horaInicio) - new Date(a.horaInicio));\r\n        callback(recorridos);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Obtener todos los recorridos\r\n  getAllRecorridos: (callback) => {\r\n    const recorridosRef = ref(database, 'recorridos');\r\n    const unsubscribe = onValue(recorridosRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const recorridos = Object.entries(data)\r\n          .map(([id, recorrido]) => ({ id, ...recorrido }))\r\n          .sort((a, b) => new Date(b.horaInicio) - new Date(a.horaInicio));\r\n        callback(recorridos);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Limpiar historial de ubicaciones antiguas (m√°s de 7 d√≠as)\r\n  cleanOldLocationHistory: async () => {\r\n    const historialRef = ref(database, 'historial_ubicaciones');\r\n    const snapshot = await get(historialRef);\r\n    const data = snapshot.val();\r\n    \r\n    if (data) {\r\n      const sevenDaysAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);\r\n      \r\n      for (const trabajadorId in data) {\r\n        for (const timestamp in data[trabajadorId]) {\r\n          if (parseInt(timestamp) < sevenDaysAgo) {\r\n            const oldRef = ref(database, `historial_ubicaciones/${trabajadorId}/${timestamp}`);\r\n            await remove(oldRef);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n// ========== SERVICIOS DE NOTIFICACIONES ==========\r\n\r\nexport const notificacionesService = {\r\n  // Enviar notificaci√≥n\r\n  sendNotification: async (notificationData) => {\r\n    const notificacionesRef = ref(database, 'notificaciones');\r\n    const newNotifRef = push(notificacionesRef);\r\n    await set(newNotifRef, {\r\n      ...notificationData,\r\n      timestamp: new Date().toISOString(),\r\n      leido: false\r\n    });\r\n    return newNotifRef.key;\r\n  },\r\n\r\n  // Escuchar notificaciones para un usuario\r\n  subscribeToNotifications: (userId, callback) => {\r\n    const notificacionesRef = ref(database, 'notificaciones');\r\n    const unsubscribe = onValue(notificacionesRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const notificaciones = Object.entries(data)\r\n          .filter(([id, notif]) => notif.destinatario === userId)\r\n          .map(([id, notif]) => ({ id, ...notif }))\r\n          .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));\r\n        callback(notificaciones);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Marcar notificaci√≥n como le√≠da\r\n  markAsRead: async (notificationId) => {\r\n    const notifRef = ref(database, `notificaciones/${notificationId}`);\r\n    await update(notifRef, { leido: true });\r\n  },\r\n\r\n  // Eliminar notificaci√≥n\r\n  deleteNotification: async (notificationId) => {\r\n    const notifRef = ref(database, `notificaciones/${notificationId}`);\r\n    await remove(notifRef);\r\n  },\r\n\r\n  // Eliminar todas las notificaciones de un usuario\r\n  clearUserNotifications: async (userId) => {\r\n    const notificacionesRef = ref(database, 'notificaciones');\r\n    const snapshot = await get(notificacionesRef);\r\n    const data = snapshot.val();\r\n    \r\n    if (data) {\r\n      const toDelete = Object.entries(data)\r\n        .filter(([id, notif]) => notif.destinatario === userId)\r\n        .map(([id]) => id);\r\n      \r\n      for (const id of toDelete) {\r\n        await remove(ref(database, `notificaciones/${id}`));\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n// ========== SERVICIOS DE REPORTES ==========\r\n\r\nexport const reportesService = {\r\n  // Guardar reporte diario\r\n  saveDailyReport: async (reportData) => {\r\n    const fecha = new Date().toISOString().split('T')[0];\r\n    const reportRef = ref(database, `reportes/diarios/${fecha}`);\r\n    await set(reportRef, {\r\n      ...reportData,\r\n      fecha,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  },\r\n\r\n  // Obtener reporte por fecha\r\n  getReportByDate: (fecha, callback) => {\r\n    const reportRef = ref(database, `reportes/diarios/${fecha}`);\r\n    const unsubscribe = onValue(reportRef, (snapshot) => {\r\n      callback(snapshot.val());\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Obtener reportes del mes\r\n  getMonthlyReports: (year, month, callback) => {\r\n    const reportesRef = ref(database, 'reportes/diarios');\r\n    const unsubscribe = onValue(reportesRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const monthReports = Object.entries(data)\r\n          .filter(([fecha]) => {\r\n            const [reportYear, reportMonth] = fecha.split('-');\r\n            return reportYear === year.toString() && reportMonth === month.toString().padStart(2, '0');\r\n          })\r\n          .map(([fecha, report]) => ({ fecha, ...report }));\r\n        callback(monthReports);\r\n      } else {\r\n        callback([]);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  },\r\n\r\n  // Obtener estad√≠sticas en tiempo real - VERSI√ìN MEJORADA\r\n  getRealtimeStats: (callback) => {\r\n    console.log('üìä Iniciando servicio de estad√≠sticas en tiempo real');\r\n    \r\n    const stats = {\r\n      vehiculos: { total: 0, activos: 0, enMantenimiento: 0 },\r\n      zonas: { total: 0, activas: 0, completadas: 0, pendientes: 0 },\r\n      trabajadores: { total: 0, enRuta: 0, trabajando: 0, disponibles: 0 }\r\n    };\r\n\r\n    // Escuchar veh√≠culos\r\n    const vehiculosRef = ref(database, 'vehiculos');\r\n    onValue(vehiculosRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      console.log('üöõ Veh√≠culos recibidos:', data);\r\n      if (data) {\r\n        const vehiculos = Object.values(data);\r\n        stats.vehiculos.total = vehiculos.length;\r\n        stats.vehiculos.enUso = vehiculos.filter(v => \r\n  v.estado === 'en_uso'  // ‚úÖ Contar correctamente 'en_uso'\r\n).length;\r\n\r\nstats.vehiculos.activos = vehiculos.filter(v => \r\n  v.estado === 'disponible' || v.estado === 'en_uso'  // ‚úÖ Activos = disponibles + en_uso\r\n).length;\r\n        stats.vehiculos.enMantenimiento = vehiculos.filter(v => \r\n          v.estado === 'mantenimiento'\r\n        ).length;\r\n      } else {\r\n        stats.vehiculos = { total: 0, activos: 0, enMantenimiento: 0 };\r\n      }\r\n      callback({ ...stats });\r\n    });\r\n\r\n    // Escuchar zonas_asignadas\r\n    const zonasRef = ref(database, 'zonas_asignadas');\r\n    onValue(zonasRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      console.log('üèóÔ∏è Zonas asignadas recibidas:', data);\r\n      if (data) {\r\n        const zonas = Object.values(data);\r\n        stats.zonas.total = zonas.length;\r\n        stats.zonas.activas = zonas.filter(z => z.estado === 'en_progreso').length;\r\n        stats.zonas.completadas = zonas.filter(z => z.estado === 'completado').length;\r\n        stats.zonas.pendientes = zonas.filter(z => \r\n          z.estado === 'pendiente' || !z.estado\r\n        ).length;\r\n        console.log('üìä Estad√≠sticas de zonas:', stats.zonas);\r\n      } else {\r\n        stats.zonas = { total: 0, activas: 0, completadas: 0, pendientes: 0 };\r\n      }\r\n      callback({ ...stats });\r\n    });\r\n\r\n    // Escuchar trabajadores\r\n    const trabajadoresRef = ref(database, 'trabajadores');\r\n    onValue(trabajadoresRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      console.log('üë∑ Trabajadores recibidos:', data);\r\n      if (data) {\r\n        const trabajadores = Object.values(data);\r\n        stats.trabajadores.total = trabajadores.length;\r\n        stats.trabajadores.enRuta = trabajadores.filter(t => t.estado === 'en_camino').length;\r\n        stats.trabajadores.trabajando = trabajadores.filter(t => t.estado === 'trabajando').length;\r\n        stats.trabajadores.disponibles = trabajadores.filter(t => \r\n          t.estado === 'disponible' || t.estado === 'activo' || !t.estado\r\n        ).length;\r\n        console.log('üìä Estad√≠sticas de trabajadores:', stats.trabajadores);\r\n      } else {\r\n        stats.trabajadores = { total: 0, enRuta: 0, trabajando: 0, disponibles: 0 };\r\n      }\r\n      callback({ ...stats });\r\n    });\r\n  },\r\n  // En vehiculosService, agregar:\r\ngetVehiculosDisponibles: (callback) => {\r\n  const vehiculosRef = ref(database, 'vehiculos');\r\n  const unsubscribe = onValue(vehiculosRef, (snapshot) => {\r\n    const data = snapshot.val();\r\n    if (data) {\r\n      const vehiculosArray = Object.entries(data)\r\n        .filter(([id, vehiculo]) => vehiculo.estado === 'disponible')\r\n        .map(([id, vehiculo]) => ({\r\n          id,\r\n          ...vehiculo\r\n        }));\r\n      callback(vehiculosArray);\r\n    } else {\r\n      callback([]);\r\n    }\r\n  });\r\n  return unsubscribe;\r\n},\r\n\r\n// Asignar veh√≠culo a trabajador\r\nassignVehiculoToTrabajador: async (vehiculoId, trabajadorId, trabajadorNombre) => {\r\n  const vehiculoRef = ref(database, `vehiculos/${vehiculoId}`);\r\n  await update(vehiculoRef, {\r\n    estado: 'en_uso',\r\n    asignadoA: trabajadorId,\r\n    asignadoNombre: trabajadorNombre,\r\n    fechaAsignacion: new Date().toISOString()\r\n  });\r\n},\r\n\r\n// Liberar veh√≠culo\r\nreleaseVehiculo: async (vehiculoId) => {\r\n  const vehiculoRef = ref(database, `vehiculos/${vehiculoId}`);\r\n  await update(vehiculoRef, {\r\n    estado: 'disponible',\r\n    asignadoA: null,\r\n    asignadoNombre: null,\r\n    destino: null,\r\n    fechaAsignacion: null\r\n  });\r\n},\r\n\r\n  // Generar reporte de productividad\r\n  generateProductivityReport: async (startDate, endDate) => {\r\n    const recorridosRef = ref(database, 'recorridos');\r\n    const snapshot = await get(recorridosRef);\r\n    const data = snapshot.val();\r\n    \r\n    if (data) {\r\n      const recorridos = Object.values(data).filter(r => {\r\n        const fecha = new Date(r.horaInicio);\r\n        return fecha >= new Date(startDate) && fecha <= new Date(endDate);\r\n      });\r\n      \r\n      // Calcular estad√≠sticas\r\n      const stats = {\r\n        totalRecorridos: recorridos.length,\r\n        recorridosCompletados: recorridos.filter(r => r.estado === 'completado').length,\r\n        tiempoPromedioViaje: 0,\r\n        tiempoPromedioTrabajo: 0,\r\n        trabajadoresActivos: new Set(recorridos.map(r => r.trabajadorId)).size\r\n      };\r\n      \r\n      // Calcular tiempos promedio\r\n      const tiemposViaje = [];\r\n      const tiemposTrabajo = [];\r\n      \r\n      recorridos.forEach(r => {\r\n        if (r.horaLlegada && r.horaInicio) {\r\n          const tiempoViaje = new Date(r.horaLlegada) - new Date(r.horaInicio);\r\n          tiemposViaje.push(tiempoViaje);\r\n        }\r\n        if (r.horaFin && r.horaLlegada) {\r\n          const tiempoTrabajo = new Date(r.horaFin) - new Date(r.horaLlegada);\r\n          tiemposTrabajo.push(tiempoTrabajo);\r\n        }\r\n      });\r\n      \r\n      if (tiemposViaje.length > 0) {\r\n        stats.tiempoPromedioViaje = tiemposViaje.reduce((a, b) => a + b, 0) / tiemposViaje.length;\r\n      }\r\n      if (tiemposTrabajo.length > 0) {\r\n        stats.tiempoPromedioTrabajo = tiemposTrabajo.reduce((a, b) => a + b, 0) / tiemposTrabajo.length;\r\n      }\r\n      \r\n      return stats;\r\n    }\r\n    \r\n    return null;\r\n  }\r\n};\r\n\r\n// ========== SERVICIO DE LIMPIEZA AUTOM√ÅTICA ==========\r\n\r\nexport const maintenanceService = {\r\n  // Limpiar datos antiguos (ejecutar peri√≥dicamente)\r\n  cleanOldData: async () => {\r\n    try {\r\n      // Limpiar historial de ubicaciones de m√°s de 7 d√≠as\r\n      await trabajadoresService.cleanOldLocationHistory();\r\n      \r\n      // Limpiar notificaciones le√≠das de m√°s de 30 d√≠as\r\n      const notificacionesRef = ref(database, 'notificaciones');\r\n      const snapshot = await get(notificacionesRef);\r\n      const data = snapshot.val();\r\n      \r\n      if (data) {\r\n        const thirtyDaysAgo = new Date(Date.now() - (30 * 24 * 60 * 60 * 1000));\r\n        \r\n        for (const [id, notif] of Object.entries(data)) {\r\n          if (notif.leido && new Date(notif.timestamp) < thirtyDaysAgo) {\r\n            await remove(ref(database, `notificaciones/${id}`));\r\n          }\r\n        }\r\n      }\r\n      \r\n      console.log('‚úÖ Limpieza de datos antiguos completada');\r\n    } catch (error) {\r\n      console.error('‚ùå Error en limpieza de datos:', error);\r\n    }\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}