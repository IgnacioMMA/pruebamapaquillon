{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Izan\\\\Desktop\\\\AppReact\\\\mapa-quillon\\\\src\\\\components\\\\SistemaTrabajadoresFirebase.js\",\n  _s = $RefreshSig$();\n// src/components/SistemaTrabajadoresFirebase.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport { trabajadoresService } from '../services/firebaseservices';\n\n// Zonas de trabajo disponibles (esto podr√≠a venir de Firebase)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst zonasDisponibles = [{\n  id: 1,\n  nombre: \"Obra Sector Norte\",\n  lat: -36.741,\n  lng: -72.538,\n  direccion: \"Av. Principal 123\"\n}, {\n  id: 2,\n  nombre: \"Reparaci√≥n Puente\",\n  lat: -36.728,\n  lng: -72.470,\n  direccion: \"Puente Los Aromos\"\n}, {\n  id: 3,\n  nombre: \"Pavimentaci√≥n Ruta\",\n  lat: -36.720,\n  lng: -72.480,\n  direccion: \"Ruta Q-45 Km 12\"\n}, {\n  id: 4,\n  nombre: \"Construcci√≥n Plaza\",\n  lat: -36.735,\n  lng: -72.465,\n  direccion: \"Plaza Central\"\n}, {\n  id: 5,\n  nombre: \"Mantenci√≥n Parque\",\n  lat: -36.745,\n  lng: -72.455,\n  direccion: \"Parque Municipal\"\n}];\nconst SistemaTrabajadoresFirebase = ({\n  currentUser,\n  onLogout\n}) => {\n  _s();\n  // Estados principales\n  const mapRef = useRef(null);\n  const [map, setMap] = useState(null);\n  const [userPosition, setUserPosition] = useState(null);\n  const [selectedZona, setSelectedZona] = useState(null);\n  const [isTracking, setIsTracking] = useState(false);\n  const [isNavigating, setIsNavigating] = useState(false);\n  const [workStatus, setWorkStatus] = useState('idle'); // idle, traveling, working, completed\n  const [workLog, setWorkLog] = useState({\n    startTime: null,\n    arrivalTime: null,\n    endTime: null,\n    zona: null\n  });\n\n  // Referencias para marcadores y servicios\n  const userMarkerRef = useRef(null);\n  const zonaMarkerRef = useRef(null);\n  const directionsServiceRef = useRef(null);\n  const directionsRendererRef = useRef(null);\n  const watchIdRef = useRef(null);\n  const lastUpdateRef = useRef(null);\n\n  // Estados de UI\n  const [mapLoaded, setMapLoaded] = useState(false);\n  const [error, setError] = useState(null);\n  const [distance, setDistance] = useState(null);\n  const [duration, setDuration] = useState(null);\n  const [showWorkLog, setShowWorkLog] = useState(false);\n  const [gpsStatus, setGpsStatus] = useState('inactive'); // inactive, activating, active, error\n\n  const API_KEY = 'AIzaSyA7DrdL36n5cx-RNzuXGAQggFeGCheHDbY';\n\n  // Funci√≥n para cargar Google Maps\n  useEffect(() => {\n    const loadGoogleMaps = () => {\n      return new Promise((resolve, reject) => {\n        if (window.google && window.google.maps) {\n          resolve(window.google.maps);\n          return;\n        }\n        const existingScript = document.querySelector('script[src*=\"maps.googleapis.com\"]');\n        if (existingScript) {\n          existingScript.addEventListener('load', () => {\n            if (window.google && window.google.maps) {\n              resolve(window.google.maps);\n            } else {\n              reject(new Error('Google Maps no disponible'));\n            }\n          });\n          return;\n        }\n        const script = document.createElement('script');\n        script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places,geometry&v=weekly`;\n        script.async = true;\n        script.defer = true;\n        script.onload = () => {\n          if (window.google && window.google.maps) {\n            resolve(window.google.maps);\n          } else {\n            reject(new Error('Google Maps no disponible'));\n          }\n        };\n        script.onerror = () => {\n          reject(new Error('Error al cargar Google Maps'));\n        };\n        document.head.appendChild(script);\n      });\n    };\n    const initMap = async () => {\n      try {\n        const maps = await loadGoogleMaps();\n        if (!mapRef.current) return;\n        const mapInstance = new maps.Map(mapRef.current, {\n          center: {\n            lat: -36.7333,\n            lng: -72.4667\n          },\n          zoom: 13,\n          mapTypeId: 'roadmap',\n          zoomControl: true,\n          mapTypeControl: false,\n          scaleControl: false,\n          streetViewControl: false,\n          rotateControl: false,\n          fullscreenControl: true\n        });\n        setMap(mapInstance);\n\n        // Inicializar servicios de direcciones\n        directionsServiceRef.current = new maps.DirectionsService();\n        directionsRendererRef.current = new maps.DirectionsRenderer({\n          map: mapInstance,\n          suppressMarkers: false,\n          polylineOptions: {\n            strokeColor: '#4285F4',\n            strokeWeight: 6,\n            strokeOpacity: 0.8\n          }\n        });\n        setMapLoaded(true);\n      } catch (err) {\n        setError('Error al cargar el mapa: ' + err.message);\n      }\n    };\n    initMap();\n  }, []);\n\n  // üî• FUNCI√ìN CR√çTICA - Actualizar posici√≥n del usuario Y ENVIAR A FIREBASE\n  const updateUserPosition = position => {\n    console.log('üîÑ Actualizando posici√≥n:', position);\n    setUserPosition(position);\n\n    // üî• ENVIAR UBICACI√ìN A FIREBASE - ESTO ES LO QUE FALTABA\n    // Solo actualizar si ha pasado al menos 5 segundos desde la √∫ltima actualizaci√≥n\n    const ahora = Date.now();\n    if (!lastUpdateRef.current || ahora - lastUpdateRef.current > 5000) {\n      console.log('üìç Enviando ubicaci√≥n a Firebase:', position);\n      if (currentUser && currentUser.uid) {\n        // Actualizar ubicaci√≥n en Firebase\n        trabajadoresService.updateTrabajadorLocation(currentUser.uid, {\n          lat: position.lat,\n          lng: position.lng,\n          timestamp: new Date().toISOString()\n        }).then(() => {\n          console.log('‚úÖ Ubicaci√≥n enviada a Firebase exitosamente');\n          console.log('   - Trabajador ID:', currentUser.uid);\n          console.log('   - Posici√≥n:', position);\n        }).catch(error => {\n          console.error('‚ùå Error al enviar ubicaci√≥n a Firebase:', error);\n          console.error('   - Detalles:', error.message);\n        });\n\n        // Tambi√©n actualizar el estado del trabajador si es necesario\n        const estadoActual = workStatus === 'traveling' ? 'en_camino' : workStatus === 'working' ? 'trabajando' : 'disponible';\n\n        // Actualizar datos adicionales del trabajador\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\n          nombre: currentUser.name || currentUser.email,\n          email: currentUser.email,\n          estado: estadoActual,\n          zonaDestino: selectedZona ? selectedZona.nombre : null,\n          ultimaActualizacion: new Date().toISOString()\n        }).then(() => {\n          console.log('‚úÖ Datos del trabajador actualizados');\n        }).catch(error => {\n          console.error('‚ùå Error al actualizar datos del trabajador:', error);\n        });\n        lastUpdateRef.current = ahora;\n      }\n    }\n\n    // Actualizar marcador en el mapa local\n    if (!map || !window.google) return;\n\n    // Crear o actualizar marcador del usuario\n    if (!userMarkerRef.current) {\n      userMarkerRef.current = new window.google.maps.Marker({\n        position: position,\n        map: map,\n        title: 'Tu ubicaci√≥n',\n        icon: {\n          path: window.google.maps.SymbolPath.CIRCLE,\n          scale: 10,\n          fillColor: '#4285F4',\n          fillOpacity: 1,\n          strokeColor: '#ffffff',\n          strokeWeight: 3\n        },\n        zIndex: 1000\n      });\n\n      // Centrar mapa en usuario\n      map.setCenter(position);\n      map.setZoom(15);\n    } else {\n      userMarkerRef.current.setPosition(position);\n    }\n\n    // Si est√° navegando, actualizar distancia\n    if (isNavigating && selectedZona) {\n      const distance = window.google.maps.geometry.spherical.computeDistanceBetween(new window.google.maps.LatLng(position.lat, position.lng), new window.google.maps.LatLng(selectedZona.lat, selectedZona.lng));\n\n      // Si lleg√≥ al destino (menos de 50 metros)\n      if (distance < 50 && workStatus === 'traveling') {\n        handleArrival();\n      }\n    }\n  };\n\n  // Funci√≥n para activar/desactivar GPS\n  const toggleGPS = () => {\n    if (isTracking) {\n      // Detener tracking\n      if (watchIdRef.current) {\n        // Limpiar el interval de simulaci√≥n o el watch del GPS\n        if (typeof watchIdRef.current === 'number') {\n          clearInterval(watchIdRef.current);\n        } else {\n          navigator.geolocation.clearWatch(watchIdRef.current);\n        }\n        watchIdRef.current = null;\n      }\n      setIsTracking(false);\n      setGpsStatus('inactive');\n\n      // Limpiar marcador de usuario\n      if (userMarkerRef.current) {\n        userMarkerRef.current.setMap(null);\n        userMarkerRef.current = null;\n      }\n\n      // Limpiar ubicaci√≥n en Firebase al desactivar GPS (sin await)\n      if (currentUser && currentUser.uid) {\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\n          estado: 'inactivo',\n          ubicacion: null,\n          ultimaActualizacion: new Date().toISOString()\n        }).then(() => {\n          console.log('üìç GPS desactivado y ubicaci√≥n limpiada en Firebase');\n        }).catch(error => {\n          console.error('Error al limpiar ubicaci√≥n en Firebase:', error);\n        });\n      }\n      setUserPosition(null);\n    } else {\n      // Iniciar tracking\n      if (!navigator.geolocation) {\n        alert('Tu navegador no soporta geolocalizaci√≥n');\n        setGpsStatus('error');\n        return;\n      }\n      console.log('üîÑ Iniciando GPS...');\n      setIsTracking(true);\n      setGpsStatus('activating');\n\n      // Registrar el trabajador en Firebase si no existe (sin bloquear)\n      if (currentUser && currentUser.uid) {\n        trabajadoresService.createOrUpdateTrabajador(currentUser.uid, {\n          nombre: currentUser.name || currentUser.email,\n          email: currentUser.email,\n          telefono: currentUser.phone || '',\n          estado: 'disponible',\n          rol: 'trabajador',\n          createdAt: new Date().toISOString()\n        }).then(() => {\n          console.log('‚úÖ Trabajador registrado en Firebase');\n        }).catch(error => {\n          console.error('Error al registrar trabajador:', error);\n        });\n      }\n\n      // Obtener posici√≥n inicial\n      navigator.geolocation.getCurrentPosition(position => {\n        console.log('üìç Posici√≥n obtenida:', position.coords);\n        const pos = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n        updateUserPosition(pos);\n        setGpsStatus('active');\n      }, error => {\n        console.error('‚ùå Error al obtener ubicaci√≥n:', error);\n\n        // Si es timeout, ofrecer usar ubicaci√≥n de prueba autom√°ticamente\n        if (error.code === error.TIMEOUT) {\n          console.log('‚è±Ô∏è Timeout del GPS - Usando ubicaci√≥n de prueba');\n          // Usar ubicaci√≥n de prueba autom√°ticamente\n          const testPosition = {\n            lat: -36.7333 + (Math.random() - 0.5) * 0.01,\n            // A√±adir peque√±a variaci√≥n\n            lng: -72.4667 + (Math.random() - 0.5) * 0.01\n          };\n          updateUserPosition(testPosition);\n          setGpsStatus('active');\n\n          // Notificar al usuario\n          console.log('üìç Usando ubicaci√≥n simulada debido a timeout del GPS');\n        } else {\n          let errorMessage = 'Error al obtener tu ubicaci√≥n. ';\n          switch (error.code) {\n            case error.PERMISSION_DENIED:\n              errorMessage += 'Permiso denegado. Habilita el GPS en tu navegador.';\n              break;\n            case error.POSITION_UNAVAILABLE:\n              errorMessage += 'Ubicaci√≥n no disponible.';\n              break;\n            default:\n              errorMessage += 'Error desconocido.';\n          }\n          alert(errorMessage);\n          setIsTracking(false);\n          setGpsStatus('error');\n        }\n      }, {\n        enableHighAccuracy: false,\n        // Cambiar a false para evitar timeouts\n        timeout: 5000,\n        // Reducir timeout\n        maximumAge: 0\n      });\n\n      // Seguimiento continuo con simulaci√≥n\n      watchIdRef.current = setInterval(() => {\n        if (userPosition) {\n          // Simular movimiento peque√±o para desarrollo\n          const newPos = {\n            lat: userPosition.lat + (Math.random() - 0.5) * 0.0005,\n            lng: userPosition.lng + (Math.random() - 0.5) * 0.0005\n          };\n          console.log('üìç Simulando movimiento:', newPos);\n          updateUserPosition(newPos);\n        }\n      }, 5000); // Actualizar cada 5 segundos\n\n      // Tambi√©n intentar GPS real (sin bloquear si falla)\n      navigator.geolocation.watchPosition(position => {\n        console.log('üìç GPS Real - Actualizaci√≥n de posici√≥n:', position.coords);\n        const pos = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n        updateUserPosition(pos);\n        setGpsStatus('active');\n\n        // Si funciona el GPS real, cancelar la simulaci√≥n\n        if (watchIdRef.current) {\n          clearInterval(watchIdRef.current);\n          watchIdRef.current = null;\n        }\n      }, error => {\n        console.warn('‚ö†Ô∏è GPS Real no disponible, usando simulaci√≥n:', error.message);\n        // No hacer nada, dejar que la simulaci√≥n contin√∫e\n      }, {\n        enableHighAccuracy: false,\n        timeout: 5000,\n        maximumAge: 0\n      });\n    }\n  };\n\n  // Seleccionar zona de trabajo\n  const selectZona = zona => {\n    setSelectedZona(zona);\n    if (!map || !window.google) return;\n\n    // Limpiar marcador anterior\n    if (zonaMarkerRef.current) {\n      zonaMarkerRef.current.setMap(null);\n    }\n\n    // Crear marcador de zona\n    zonaMarkerRef.current = new window.google.maps.Marker({\n      position: {\n        lat: zona.lat,\n        lng: zona.lng\n      },\n      map: map,\n      title: zona.nombre,\n      icon: {\n        path: window.google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,\n        scale: 8,\n        fillColor: '#22c55e',\n        fillOpacity: 1,\n        strokeColor: '#ffffff',\n        strokeWeight: 2\n      }\n    });\n\n    // Ajustar vista para mostrar ambos puntos\n    if (userPosition) {\n      const bounds = new window.google.maps.LatLngBounds();\n      bounds.extend(userPosition);\n      bounds.extend({\n        lat: zona.lat,\n        lng: zona.lng\n      });\n      map.fitBounds(bounds, 100);\n    } else {\n      map.setCenter({\n        lat: zona.lat,\n        lng: zona.lng\n      });\n      map.setZoom(15);\n    }\n  };\n\n  // Iniciar navegaci√≥n\n  const startNavigation = async () => {\n    if (!selectedZona || !userPosition) {\n      alert('Debes activar el GPS y seleccionar una zona primero');\n      return;\n    }\n    setIsNavigating(true);\n    setWorkStatus('traveling');\n    setWorkLog({\n      ...workLog,\n      startTime: new Date().toISOString(),\n      zona: selectedZona\n    });\n\n    // üî• Actualizar estado en Firebase\n    try {\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\n        estado: 'en_camino',\n        zonaDestino: selectedZona.nombre,\n        recorridoInicio: new Date().toISOString()\n      });\n      console.log('‚úÖ Estado actualizado a \"en_camino\" en Firebase');\n    } catch (error) {\n      console.error('Error al actualizar estado en Firebase:', error);\n    }\n\n    // Calcular y mostrar ruta\n    const request = {\n      origin: userPosition,\n      destination: {\n        lat: selectedZona.lat,\n        lng: selectedZona.lng\n      },\n      travelMode: window.google.maps.TravelMode.DRIVING\n    };\n    directionsServiceRef.current.route(request, (result, status) => {\n      if (status === 'OK') {\n        directionsRendererRef.current.setDirections(result);\n        const route = result.routes[0];\n        const leg = route.legs[0];\n        setDistance(leg.distance.text);\n        setDuration(leg.duration.text);\n      } else {\n        alert('No se pudo calcular la ruta: ' + status);\n      }\n    });\n  };\n\n  // Manejar llegada a la zona\n  const handleArrival = async () => {\n    setWorkStatus('working');\n    setWorkLog({\n      ...workLog,\n      arrivalTime: new Date().toISOString()\n    });\n\n    // üî• Actualizar estado en Firebase\n    try {\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\n        estado: 'trabajando',\n        horaLlegada: new Date().toISOString()\n      });\n      console.log('‚úÖ Llegada registrada en Firebase');\n    } catch (error) {\n      console.error('Error al registrar llegada en Firebase:', error);\n    }\n    alert('¬°Has llegado a la zona de trabajo! Puedes iniciar tu tarea.');\n  };\n\n  // Finalizar trabajo\n  const finishWork = async () => {\n    const endTime = new Date().toISOString();\n    const finalLog = {\n      ...workLog,\n      endTime: endTime\n    };\n    setWorkLog(finalLog);\n    setWorkStatus('completed');\n    setIsNavigating(false);\n    setShowWorkLog(true);\n\n    // Limpiar ruta\n    if (directionsRendererRef.current) {\n      directionsRendererRef.current.setDirections({\n        routes: []\n      });\n    }\n\n    // üî• Registrar finalizaci√≥n en Firebase\n    try {\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\n        estado: 'disponible',\n        zonaDestino: null,\n        ultimoTrabajo: {\n          zona: selectedZona.nombre,\n          horaInicio: workLog.startTime,\n          horaLlegada: workLog.arrivalTime,\n          horaFin: endTime\n        }\n      });\n      console.log('‚úÖ Trabajo finalizado y registrado en Firebase');\n    } catch (error) {\n      console.error('Error al registrar finalizaci√≥n en Firebase:', error);\n    }\n    console.log('Registro de trabajo:', finalLog);\n  };\n\n  // Resetear para nuevo trabajo\n  const resetWork = () => {\n    setSelectedZona(null);\n    setWorkStatus('idle');\n    setWorkLog({\n      startTime: null,\n      arrivalTime: null,\n      endTime: null,\n      zona: null\n    });\n    setIsNavigating(false);\n    setDistance(null);\n    setDuration(null);\n    setShowWorkLog(false);\n    if (zonaMarkerRef.current) {\n      zonaMarkerRef.current.setMap(null);\n      zonaMarkerRef.current = null;\n    }\n    if (directionsRendererRef.current) {\n      directionsRendererRef.current.setDirections({\n        routes: []\n      });\n    }\n  };\n\n  // Formatear tiempo\n  const formatTime = isoString => {\n    if (!isoString) return '--:--';\n    const date = new Date(isoString);\n    return date.toLocaleTimeString('es-CL', {\n      hour: '2-digit',\n      minute: '2-digit',\n      hour12: false\n    });\n  };\n\n  // Calcular duraci√≥n\n  const calculateDuration = (start, end) => {\n    if (!start || !end) return '--';\n    const diff = new Date(end) - new Date(start);\n    const hours = Math.floor(diff / 3600000);\n    const minutes = Math.floor(diff % 3600000 / 60000);\n    return `${hours}h ${minutes}m`;\n  };\n\n  // Limpiar al desmontar componente\n  useEffect(() => {\n    return () => {\n      // Limpiar GPS al salir\n      if (watchIdRef.current) {\n        navigator.geolocation.clearWatch(watchIdRef.current);\n      }\n\n      // Marcar como inactivo en Firebase\n      if (currentUser !== null && currentUser !== void 0 && currentUser.uid) {\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\n          estado: 'inactivo',\n          ubicacion: null\n        }).catch(console.error);\n      }\n    };\n  }, [currentUser]);\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '20px',\n        textAlign: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 593,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => window.location.reload(),\n        children: \"Reintentar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 592,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: '100%',\n      height: '100vh',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        right: 0,\n        background: 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\n        color: 'white',\n        padding: '15px 20px',\n        zIndex: 1000,\n        boxShadow: '0 2px 10px rgba(0,0,0,0.1)'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            style: {\n              margin: 0,\n              fontSize: '20px',\n              fontWeight: '600'\n            },\n            children: \"\\uD83D\\uDC77\\u200D\\u2642\\uFE0F Panel del Trabajador\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              margin: '4px 0 0 0',\n              fontSize: '14px',\n              opacity: 0.95\n            },\n            children: [\"GPS y Navegaci\\xF3n a Zona de Trabajo - \", currentUser.name || currentUser.email]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 619,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 615,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onLogout,\n          style: {\n            padding: '8px 16px',\n            background: 'rgba(255,255,255,0.2)',\n            color: 'white',\n            border: '1px solid rgba(255,255,255,0.3)',\n            borderRadius: '6px',\n            cursor: 'pointer',\n            fontSize: '14px'\n          },\n          children: \"Cerrar Sesi\\xF3n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 614,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 603,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '80px',\n        left: '10px',\n        right: '10px',\n        background: 'white',\n        borderRadius: '12px',\n        padding: '15px',\n        boxShadow: '0 4px 20px rgba(0,0,0,0.1)',\n        zIndex: 1000,\n        maxWidth: '400px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: toggleGPS,\n          style: {\n            width: '100%',\n            padding: '12px',\n            background: isTracking ? '#ef4444' : '#22c55e',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            fontSize: '16px',\n            fontWeight: '500',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            gap: '8px'\n          },\n          children: isTracking ? 'üìç Desactivar GPS' : 'üìç Activar GPS'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 11\n        }, this), gpsStatus !== 'inactive' && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '8px',\n            fontSize: '12px',\n            textAlign: 'center',\n            padding: '6px',\n            borderRadius: '6px',\n            background: gpsStatus === 'active' ? '#dcfce7' : gpsStatus === 'activating' ? '#fef3c7' : gpsStatus === 'error' ? '#fee2e2' : '#f3f4f6',\n            color: gpsStatus === 'active' ? '#166534' : gpsStatus === 'activating' ? '#92400e' : gpsStatus === 'error' ? '#991b1b' : '#374151'\n          },\n          children: [gpsStatus === 'active' && 'üü¢ GPS activo - Transmitiendo ubicaci√≥n', gpsStatus === 'activating' && 'üü° Activando GPS... (Acepta los permisos del navegador)', gpsStatus === 'error' && 'üî¥ Error en GPS - Verificar permisos del navegador']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 678,\n          columnNumber: 13\n        }, this), userPosition && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '8px',\n            fontSize: '12px',\n            color: '#666',\n            textAlign: 'center',\n            background: '#f0f9ff',\n            padding: '8px',\n            borderRadius: '6px'\n          },\n          children: [\"\\uD83D\\uDCCD \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Ubicaci\\xF3n actual:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 707,\n            columnNumber: 18\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 707,\n            columnNumber: 52\n          }, this), \"Lat: \", userPosition.lat.toFixed(6), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 708,\n            columnNumber: 49\n          }, this), \"Lng: \", userPosition.lng.toFixed(6)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 698,\n          columnNumber: 13\n        }, this), !userPosition && isTracking && gpsStatus === 'activating' && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            // Usar ubicaci√≥n de prueba en Quill√≥n si el GPS real falla\n            const testPosition = {\n              lat: -36.7333,\n              lng: -72.4667\n            };\n            console.log('üìç Usando ubicaci√≥n de prueba');\n            updateUserPosition(testPosition);\n            setGpsStatus('active');\n          },\n          style: {\n            marginTop: '8px',\n            width: '100%',\n            padding: '8px',\n            background: '#6b7280',\n            color: 'white',\n            border: 'none',\n            borderRadius: '6px',\n            fontSize: '12px',\n            cursor: 'pointer'\n          },\n          children: \"\\uD83D\\uDD27 Usar ubicaci\\xF3n de prueba (Quill\\xF3n)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 715,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 654,\n        columnNumber: 9\n      }, this), isTracking && workStatus === 'idle' && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '8px',\n            fontSize: '14px',\n            fontWeight: '500'\n          },\n          children: \"\\uD83C\\uDFD7\\uFE0F Seleccionar Zona de Trabajo:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 746,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: (selectedZona === null || selectedZona === void 0 ? void 0 : selectedZona.id) || '',\n          onChange: e => {\n            const zona = zonasDisponibles.find(z => z.id === parseInt(e.target.value));\n            if (zona) selectZona(zona);\n          },\n          style: {\n            width: '100%',\n            padding: '10px',\n            borderRadius: '6px',\n            border: '1px solid #ddd',\n            fontSize: '14px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"-- Seleccionar zona --\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 768,\n            columnNumber: 15\n          }, this), zonasDisponibles.map(zona => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: zona.id,\n            children: [zona.nombre, \" - \", zona.direccion]\n          }, zona.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 770,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 754,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 745,\n        columnNumber: 11\n      }, this), selectedZona && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: '#f0f9ff',\n          padding: '12px',\n          borderRadius: '8px',\n          marginBottom: '15px',\n          border: '1px solid #bae6fd'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            margin: '0 0 8px 0',\n            color: '#0369a1',\n            fontSize: '14px'\n          },\n          children: \"Zona Seleccionada:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 787,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '13px',\n            color: '#333'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: selectedZona.nombre\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 791,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 791,\n            columnNumber: 53\n          }, this), \"\\uD83D\\uDCCD \", selectedZona.direccion, distance && duration && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: '8px',\n              color: '#666'\n            },\n            children: [\"\\uD83D\\uDE97 \", distance, \" \\u2022 \\u23F1\\uFE0F \", duration]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 794,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 790,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 780,\n        columnNumber: 11\n      }, this), workStatus === 'idle' && selectedZona && userPosition && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startNavigation,\n        style: {\n          width: '100%',\n          padding: '12px',\n          background: '#3b82f6',\n          color: 'white',\n          border: 'none',\n          borderRadius: '8px',\n          fontSize: '16px',\n          fontWeight: '500',\n          cursor: 'pointer'\n        },\n        children: \"\\uD83D\\uDE97 Iniciar Recorrido\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 804,\n        columnNumber: 11\n      }, this), workStatus === 'traveling' && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: '#fef3c7',\n          padding: '12px',\n          borderRadius: '8px',\n          textAlign: 'center',\n          border: '1px solid #fde68a'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '16px',\n            fontWeight: '500',\n            color: '#92400e'\n          },\n          children: \"\\uD83D\\uDE97 En camino...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            marginTop: '4px',\n            color: '#78350f'\n          },\n          children: [\"Hora de salida: \", formatTime(workLog.startTime)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 833,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 823,\n        columnNumber: 11\n      }, this), workStatus === 'working' && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: '#dcfce7',\n            padding: '12px',\n            borderRadius: '8px',\n            marginBottom: '12px',\n            border: '1px solid #bbf7d0'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '16px',\n              fontWeight: '500',\n              color: '#14532d'\n            },\n            children: \"\\u2705 En zona de trabajo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 848,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              marginTop: '4px',\n              color: '#166534'\n            },\n            children: [\"Llegada: \", formatTime(workLog.arrivalTime)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 851,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 841,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: finishWork,\n          style: {\n            width: '100%',\n            padding: '12px',\n            background: '#dc2626',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            fontSize: '16px',\n            fontWeight: '500',\n            cursor: 'pointer'\n          },\n          children: \"\\uD83C\\uDFC1 Finalizar Trabajo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 855,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 840,\n        columnNumber: 11\n      }, this), workStatus === 'completed' && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: '#e0e7ff',\n            padding: '12px',\n            borderRadius: '8px',\n            marginBottom: '12px',\n            border: '1px solid #c7d2fe'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '16px',\n              fontWeight: '500',\n              color: '#312e81'\n            },\n            children: \"\\u2705 Trabajo Completado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 883,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowWorkLog(!showWorkLog),\n            style: {\n              marginTop: '8px',\n              padding: '6px 12px',\n              background: '#4f46e5',\n              color: 'white',\n              border: 'none',\n              borderRadius: '6px',\n              fontSize: '12px',\n              cursor: 'pointer'\n            },\n            children: \"\\uD83D\\uDCCB Ver Resumen\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 886,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 876,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: resetWork,\n          style: {\n            width: '100%',\n            padding: '12px',\n            background: '#22c55e',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            fontSize: '16px',\n            fontWeight: '500',\n            cursor: 'pointer'\n          },\n          children: \"\\uD83D\\uDD04 Nuevo Trabajo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 902,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 875,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 641,\n      columnNumber: 7\n    }, this), showWorkLog && workLog.zona && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0,0,0,0.5)',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        zIndex: 2000,\n        padding: '20px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: 'white',\n          borderRadius: '12px',\n          padding: '20px',\n          maxWidth: '400px',\n          width: '100%',\n          maxHeight: '80vh',\n          overflow: 'auto'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            margin: '0 0 20px 0',\n            color: '#1f2937'\n          },\n          children: \"\\uD83D\\uDCCB Resumen del Trabajo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 946,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '14px',\n            lineHeight: '1.8'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '15px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Zona de trabajo:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 952,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 952,\n              columnNumber: 50\n            }, this), workLog.zona.nombre, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 953,\n              columnNumber: 38\n            }, this), \"\\uD83D\\uDCCD \", workLog.zona.direccion]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 951,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: '#f8fafc',\n              padding: '12px',\n              borderRadius: '8px',\n              marginBottom: '15px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\uD83D\\uDE97 Hora de salida:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 964,\n                columnNumber: 19\n              }, this), \" \", formatTime(workLog.startTime)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 963,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u2705 Hora de llegada:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 967,\n                columnNumber: 19\n              }, this), \" \", formatTime(workLog.arrivalTime)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 966,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\uD83C\\uDFC1 Hora de t\\xE9rmino:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 970,\n                columnNumber: 19\n              }, this), \" \", formatTime(workLog.endTime)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 969,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n              style: {\n                margin: '10px 0',\n                border: 'none',\n                borderTop: '1px solid #e5e7eb'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 972,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u23F1\\uFE0F Tiempo de viaje:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 974,\n                columnNumber: 19\n              }, this), \" \", calculateDuration(workLog.startTime, workLog.arrivalTime)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 973,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u23F1\\uFE0F Tiempo trabajado:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 977,\n                columnNumber: 19\n              }, this), \" \", calculateDuration(workLog.arrivalTime, workLog.endTime)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 976,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u23F1\\uFE0F Tiempo total:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 980,\n                columnNumber: 19\n              }, this), \" \", calculateDuration(workLog.startTime, workLog.endTime)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 979,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 957,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowWorkLog(false),\n            style: {\n              width: '100%',\n              padding: '10px',\n              background: '#6b7280',\n              color: 'white',\n              border: 'none',\n              borderRadius: '6px',\n              fontSize: '14px',\n              cursor: 'pointer'\n            },\n            children: \"Cerrar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 984,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 950,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 937,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 924,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      style: {\n        width: '100%',\n        height: '100%'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1005,\n      columnNumber: 7\n    }, this), !mapLoaded && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n        transform: 'translate(-50%, -50%)',\n        textAlign: 'center',\n        zIndex: 1001\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '50px',\n          height: '50px',\n          border: '4px solid #f3f3f3',\n          borderTop: '4px solid #22c55e',\n          borderRadius: '50%',\n          animation: 'spin 1s linear infinite'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1023,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          marginTop: '10px',\n          color: '#666'\n        },\n        children: \"Cargando mapa...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1031,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1015,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      jsx: true,\n      children: `\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1035,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 601,\n    columnNumber: 5\n  }, this);\n};\n_s(SistemaTrabajadoresFirebase, \"tcsIPt+jDddUXmU8wB6YttwGerg=\");\n_c = SistemaTrabajadoresFirebase;\nexport default SistemaTrabajadoresFirebase;\nvar _c;\n$RefreshReg$(_c, \"SistemaTrabajadoresFirebase\");","map":{"version":3,"names":["React","useEffect","useRef","useState","trabajadoresService","jsxDEV","_jsxDEV","zonasDisponibles","id","nombre","lat","lng","direccion","SistemaTrabajadoresFirebase","currentUser","onLogout","_s","mapRef","map","setMap","userPosition","setUserPosition","selectedZona","setSelectedZona","isTracking","setIsTracking","isNavigating","setIsNavigating","workStatus","setWorkStatus","workLog","setWorkLog","startTime","arrivalTime","endTime","zona","userMarkerRef","zonaMarkerRef","directionsServiceRef","directionsRendererRef","watchIdRef","lastUpdateRef","mapLoaded","setMapLoaded","error","setError","distance","setDistance","duration","setDuration","showWorkLog","setShowWorkLog","gpsStatus","setGpsStatus","API_KEY","loadGoogleMaps","Promise","resolve","reject","window","google","maps","existingScript","document","querySelector","addEventListener","Error","script","createElement","src","async","defer","onload","onerror","head","appendChild","initMap","current","mapInstance","Map","center","zoom","mapTypeId","zoomControl","mapTypeControl","scaleControl","streetViewControl","rotateControl","fullscreenControl","DirectionsService","DirectionsRenderer","suppressMarkers","polylineOptions","strokeColor","strokeWeight","strokeOpacity","err","message","updateUserPosition","position","console","log","ahora","Date","now","uid","updateTrabajadorLocation","timestamp","toISOString","then","catch","estadoActual","updateTrabajadorData","name","email","estado","zonaDestino","ultimaActualizacion","Marker","title","icon","path","SymbolPath","CIRCLE","scale","fillColor","fillOpacity","zIndex","setCenter","setZoom","setPosition","geometry","spherical","computeDistanceBetween","LatLng","handleArrival","toggleGPS","clearInterval","navigator","geolocation","clearWatch","ubicacion","alert","createOrUpdateTrabajador","telefono","phone","rol","createdAt","getCurrentPosition","coords","pos","latitude","longitude","code","TIMEOUT","testPosition","Math","random","errorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","enableHighAccuracy","timeout","maximumAge","setInterval","newPos","watchPosition","warn","selectZona","BACKWARD_CLOSED_ARROW","bounds","LatLngBounds","extend","fitBounds","startNavigation","recorridoInicio","request","origin","destination","travelMode","TravelMode","DRIVING","route","result","status","setDirections","routes","leg","legs","text","horaLlegada","finishWork","finalLog","ultimoTrabajo","horaInicio","horaFin","resetWork","formatTime","isoString","date","toLocaleTimeString","hour","minute","hour12","calculateDuration","start","end","diff","hours","floor","minutes","style","padding","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","location","reload","width","height","top","left","right","background","color","boxShadow","display","justifyContent","alignItems","margin","fontSize","fontWeight","opacity","border","borderRadius","cursor","maxWidth","marginBottom","gap","marginTop","toFixed","value","onChange","e","find","z","parseInt","target","bottom","maxHeight","overflow","lineHeight","borderTop","ref","transform","animation","jsx","_c","$RefreshReg$"],"sources":["C:/Users/Izan/Desktop/AppReact/mapa-quillon/src/components/SistemaTrabajadoresFirebase.js"],"sourcesContent":["// src/components/SistemaTrabajadoresFirebase.js\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { trabajadoresService } from '../services/firebaseservices';\r\n\r\n// Zonas de trabajo disponibles (esto podr√≠a venir de Firebase)\r\nconst zonasDisponibles = [\r\n  { id: 1, nombre: \"Obra Sector Norte\", lat: -36.741, lng: -72.538, direccion: \"Av. Principal 123\" },\r\n  { id: 2, nombre: \"Reparaci√≥n Puente\", lat: -36.728, lng: -72.470, direccion: \"Puente Los Aromos\" },\r\n  { id: 3, nombre: \"Pavimentaci√≥n Ruta\", lat: -36.720, lng: -72.480, direccion: \"Ruta Q-45 Km 12\" },\r\n  { id: 4, nombre: \"Construcci√≥n Plaza\", lat: -36.735, lng: -72.465, direccion: \"Plaza Central\" },\r\n  { id: 5, nombre: \"Mantenci√≥n Parque\", lat: -36.745, lng: -72.455, direccion: \"Parque Municipal\" },\r\n];\r\n\r\nconst SistemaTrabajadoresFirebase = ({ currentUser, onLogout }) => {\r\n  // Estados principales\r\n  const mapRef = useRef(null);\r\n  const [map, setMap] = useState(null);\r\n  const [userPosition, setUserPosition] = useState(null);\r\n  const [selectedZona, setSelectedZona] = useState(null);\r\n  const [isTracking, setIsTracking] = useState(false);\r\n  const [isNavigating, setIsNavigating] = useState(false);\r\n  const [workStatus, setWorkStatus] = useState('idle'); // idle, traveling, working, completed\r\n  const [workLog, setWorkLog] = useState({\r\n    startTime: null,\r\n    arrivalTime: null,\r\n    endTime: null,\r\n    zona: null\r\n  });\r\n  \r\n  // Referencias para marcadores y servicios\r\n  const userMarkerRef = useRef(null);\r\n  const zonaMarkerRef = useRef(null);\r\n  const directionsServiceRef = useRef(null);\r\n  const directionsRendererRef = useRef(null);\r\n  const watchIdRef = useRef(null);\r\n  const lastUpdateRef = useRef(null);\r\n  \r\n  // Estados de UI\r\n  const [mapLoaded, setMapLoaded] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [distance, setDistance] = useState(null);\r\n  const [duration, setDuration] = useState(null);\r\n  const [showWorkLog, setShowWorkLog] = useState(false);\r\n  const [gpsStatus, setGpsStatus] = useState('inactive'); // inactive, activating, active, error\r\n\r\n  const API_KEY = 'AIzaSyA7DrdL36n5cx-RNzuXGAQggFeGCheHDbY';\r\n\r\n  // Funci√≥n para cargar Google Maps\r\n  useEffect(() => {\r\n    const loadGoogleMaps = () => {\r\n      return new Promise((resolve, reject) => {\r\n        if (window.google && window.google.maps) {\r\n          resolve(window.google.maps);\r\n          return;\r\n        }\r\n\r\n        const existingScript = document.querySelector('script[src*=\"maps.googleapis.com\"]');\r\n        if (existingScript) {\r\n          existingScript.addEventListener('load', () => {\r\n            if (window.google && window.google.maps) {\r\n              resolve(window.google.maps);\r\n            } else {\r\n              reject(new Error('Google Maps no disponible'));\r\n            }\r\n          });\r\n          return;\r\n        }\r\n\r\n        const script = document.createElement('script');\r\n        script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places,geometry&v=weekly`;\r\n        script.async = true;\r\n        script.defer = true;\r\n\r\n        script.onload = () => {\r\n          if (window.google && window.google.maps) {\r\n            resolve(window.google.maps);\r\n          } else {\r\n            reject(new Error('Google Maps no disponible'));\r\n          }\r\n        };\r\n\r\n        script.onerror = () => {\r\n          reject(new Error('Error al cargar Google Maps'));\r\n        };\r\n\r\n        document.head.appendChild(script);\r\n      });\r\n    };\r\n\r\n    const initMap = async () => {\r\n      try {\r\n        const maps = await loadGoogleMaps();\r\n        \r\n        if (!mapRef.current) return;\r\n\r\n        const mapInstance = new maps.Map(mapRef.current, {\r\n          center: { lat: -36.7333, lng: -72.4667 },\r\n          zoom: 13,\r\n          mapTypeId: 'roadmap',\r\n          zoomControl: true,\r\n          mapTypeControl: false,\r\n          scaleControl: false,\r\n          streetViewControl: false,\r\n          rotateControl: false,\r\n          fullscreenControl: true\r\n        });\r\n\r\n        setMap(mapInstance);\r\n        \r\n        // Inicializar servicios de direcciones\r\n        directionsServiceRef.current = new maps.DirectionsService();\r\n        directionsRendererRef.current = new maps.DirectionsRenderer({\r\n          map: mapInstance,\r\n          suppressMarkers: false,\r\n          polylineOptions: {\r\n            strokeColor: '#4285F4',\r\n            strokeWeight: 6,\r\n            strokeOpacity: 0.8\r\n          }\r\n        });\r\n\r\n        setMapLoaded(true);\r\n      } catch (err) {\r\n        setError('Error al cargar el mapa: ' + err.message);\r\n      }\r\n    };\r\n\r\n    initMap();\r\n  }, []);\r\n\r\n  // üî• FUNCI√ìN CR√çTICA - Actualizar posici√≥n del usuario Y ENVIAR A FIREBASE\r\n  const updateUserPosition = (position) => {\r\n    console.log('üîÑ Actualizando posici√≥n:', position);\r\n    setUserPosition(position);\r\n    \r\n    // üî• ENVIAR UBICACI√ìN A FIREBASE - ESTO ES LO QUE FALTABA\r\n    // Solo actualizar si ha pasado al menos 5 segundos desde la √∫ltima actualizaci√≥n\r\n    const ahora = Date.now();\r\n    if (!lastUpdateRef.current || (ahora - lastUpdateRef.current) > 5000) {\r\n      console.log('üìç Enviando ubicaci√≥n a Firebase:', position);\r\n      \r\n      if (currentUser && currentUser.uid) {\r\n        // Actualizar ubicaci√≥n en Firebase\r\n        trabajadoresService.updateTrabajadorLocation(currentUser.uid, {\r\n          lat: position.lat,\r\n          lng: position.lng,\r\n          timestamp: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('‚úÖ Ubicaci√≥n enviada a Firebase exitosamente');\r\n          console.log('   - Trabajador ID:', currentUser.uid);\r\n          console.log('   - Posici√≥n:', position);\r\n        }).catch(error => {\r\n          console.error('‚ùå Error al enviar ubicaci√≥n a Firebase:', error);\r\n          console.error('   - Detalles:', error.message);\r\n        });\r\n        \r\n        // Tambi√©n actualizar el estado del trabajador si es necesario\r\n        const estadoActual = workStatus === 'traveling' ? 'en_camino' : \r\n                            workStatus === 'working' ? 'trabajando' : \r\n                            'disponible';\r\n        \r\n        // Actualizar datos adicionales del trabajador\r\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n          nombre: currentUser.name || currentUser.email,\r\n          email: currentUser.email,\r\n          estado: estadoActual,\r\n          zonaDestino: selectedZona ? selectedZona.nombre : null,\r\n          ultimaActualizacion: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('‚úÖ Datos del trabajador actualizados');\r\n        }).catch(error => {\r\n          console.error('‚ùå Error al actualizar datos del trabajador:', error);\r\n        });\r\n        \r\n        lastUpdateRef.current = ahora;\r\n      }\r\n    }\r\n    \r\n    // Actualizar marcador en el mapa local\r\n    if (!map || !window.google) return;\r\n\r\n    // Crear o actualizar marcador del usuario\r\n    if (!userMarkerRef.current) {\r\n      userMarkerRef.current = new window.google.maps.Marker({\r\n        position: position,\r\n        map: map,\r\n        title: 'Tu ubicaci√≥n',\r\n        icon: {\r\n          path: window.google.maps.SymbolPath.CIRCLE,\r\n          scale: 10,\r\n          fillColor: '#4285F4',\r\n          fillOpacity: 1,\r\n          strokeColor: '#ffffff',\r\n          strokeWeight: 3\r\n        },\r\n        zIndex: 1000\r\n      });\r\n      \r\n      // Centrar mapa en usuario\r\n      map.setCenter(position);\r\n      map.setZoom(15);\r\n    } else {\r\n      userMarkerRef.current.setPosition(position);\r\n    }\r\n\r\n    // Si est√° navegando, actualizar distancia\r\n    if (isNavigating && selectedZona) {\r\n      const distance = window.google.maps.geometry.spherical.computeDistanceBetween(\r\n        new window.google.maps.LatLng(position.lat, position.lng),\r\n        new window.google.maps.LatLng(selectedZona.lat, selectedZona.lng)\r\n      );\r\n      \r\n      // Si lleg√≥ al destino (menos de 50 metros)\r\n      if (distance < 50 && workStatus === 'traveling') {\r\n        handleArrival();\r\n      }\r\n    }\r\n  };\r\n\r\n  // Funci√≥n para activar/desactivar GPS\r\n  const toggleGPS = () => {\r\n    if (isTracking) {\r\n      // Detener tracking\r\n      if (watchIdRef.current) {\r\n        // Limpiar el interval de simulaci√≥n o el watch del GPS\r\n        if (typeof watchIdRef.current === 'number') {\r\n          clearInterval(watchIdRef.current);\r\n        } else {\r\n          navigator.geolocation.clearWatch(watchIdRef.current);\r\n        }\r\n        watchIdRef.current = null;\r\n      }\r\n      setIsTracking(false);\r\n      setGpsStatus('inactive');\r\n      \r\n      // Limpiar marcador de usuario\r\n      if (userMarkerRef.current) {\r\n        userMarkerRef.current.setMap(null);\r\n        userMarkerRef.current = null;\r\n      }\r\n      \r\n      // Limpiar ubicaci√≥n en Firebase al desactivar GPS (sin await)\r\n      if (currentUser && currentUser.uid) {\r\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n          estado: 'inactivo',\r\n          ubicacion: null,\r\n          ultimaActualizacion: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('üìç GPS desactivado y ubicaci√≥n limpiada en Firebase');\r\n        }).catch(error => {\r\n          console.error('Error al limpiar ubicaci√≥n en Firebase:', error);\r\n        });\r\n      }\r\n      \r\n      setUserPosition(null);\r\n    } else {\r\n      // Iniciar tracking\r\n      if (!navigator.geolocation) {\r\n        alert('Tu navegador no soporta geolocalizaci√≥n');\r\n        setGpsStatus('error');\r\n        return;\r\n      }\r\n\r\n      console.log('üîÑ Iniciando GPS...');\r\n      setIsTracking(true);\r\n      setGpsStatus('activating');\r\n      \r\n      // Registrar el trabajador en Firebase si no existe (sin bloquear)\r\n      if (currentUser && currentUser.uid) {\r\n        trabajadoresService.createOrUpdateTrabajador(currentUser.uid, {\r\n          nombre: currentUser.name || currentUser.email,\r\n          email: currentUser.email,\r\n          telefono: currentUser.phone || '',\r\n          estado: 'disponible',\r\n          rol: 'trabajador',\r\n          createdAt: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('‚úÖ Trabajador registrado en Firebase');\r\n        }).catch(error => {\r\n          console.error('Error al registrar trabajador:', error);\r\n        });\r\n      }\r\n      \r\n      // Obtener posici√≥n inicial\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          console.log('üìç Posici√≥n obtenida:', position.coords);\r\n          const pos = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          updateUserPosition(pos);\r\n          setGpsStatus('active');\r\n        },\r\n        (error) => {\r\n          console.error('‚ùå Error al obtener ubicaci√≥n:', error);\r\n          \r\n          // Si es timeout, ofrecer usar ubicaci√≥n de prueba autom√°ticamente\r\n          if (error.code === error.TIMEOUT) {\r\n            console.log('‚è±Ô∏è Timeout del GPS - Usando ubicaci√≥n de prueba');\r\n            // Usar ubicaci√≥n de prueba autom√°ticamente\r\n            const testPosition = {\r\n              lat: -36.7333 + (Math.random() - 0.5) * 0.01, // A√±adir peque√±a variaci√≥n\r\n              lng: -72.4667 + (Math.random() - 0.5) * 0.01\r\n            };\r\n            updateUserPosition(testPosition);\r\n            setGpsStatus('active');\r\n            \r\n            // Notificar al usuario\r\n            console.log('üìç Usando ubicaci√≥n simulada debido a timeout del GPS');\r\n          } else {\r\n            let errorMessage = 'Error al obtener tu ubicaci√≥n. ';\r\n            \r\n            switch(error.code) {\r\n              case error.PERMISSION_DENIED:\r\n                errorMessage += 'Permiso denegado. Habilita el GPS en tu navegador.';\r\n                break;\r\n              case error.POSITION_UNAVAILABLE:\r\n                errorMessage += 'Ubicaci√≥n no disponible.';\r\n                break;\r\n              default:\r\n                errorMessage += 'Error desconocido.';\r\n            }\r\n            \r\n            alert(errorMessage);\r\n            setIsTracking(false);\r\n            setGpsStatus('error');\r\n          }\r\n        },\r\n        {\r\n          enableHighAccuracy: false, // Cambiar a false para evitar timeouts\r\n          timeout: 5000, // Reducir timeout\r\n          maximumAge: 0\r\n        }\r\n      );\r\n\r\n      // Seguimiento continuo con simulaci√≥n\r\n      watchIdRef.current = setInterval(() => {\r\n        if (userPosition) {\r\n          // Simular movimiento peque√±o para desarrollo\r\n          const newPos = {\r\n            lat: userPosition.lat + (Math.random() - 0.5) * 0.0005,\r\n            lng: userPosition.lng + (Math.random() - 0.5) * 0.0005\r\n          };\r\n          console.log('üìç Simulando movimiento:', newPos);\r\n          updateUserPosition(newPos);\r\n        }\r\n      }, 5000); // Actualizar cada 5 segundos\r\n      \r\n      // Tambi√©n intentar GPS real (sin bloquear si falla)\r\n      navigator.geolocation.watchPosition(\r\n        (position) => {\r\n          console.log('üìç GPS Real - Actualizaci√≥n de posici√≥n:', position.coords);\r\n          const pos = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          updateUserPosition(pos);\r\n          setGpsStatus('active');\r\n          \r\n          // Si funciona el GPS real, cancelar la simulaci√≥n\r\n          if (watchIdRef.current) {\r\n            clearInterval(watchIdRef.current);\r\n            watchIdRef.current = null;\r\n          }\r\n        },\r\n        (error) => {\r\n          console.warn('‚ö†Ô∏è GPS Real no disponible, usando simulaci√≥n:', error.message);\r\n          // No hacer nada, dejar que la simulaci√≥n contin√∫e\r\n        },\r\n        {\r\n          enableHighAccuracy: false,\r\n          timeout: 5000,\r\n          maximumAge: 0\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  // Seleccionar zona de trabajo\r\n  const selectZona = (zona) => {\r\n    setSelectedZona(zona);\r\n    \r\n    if (!map || !window.google) return;\r\n\r\n    // Limpiar marcador anterior\r\n    if (zonaMarkerRef.current) {\r\n      zonaMarkerRef.current.setMap(null);\r\n    }\r\n\r\n    // Crear marcador de zona\r\n    zonaMarkerRef.current = new window.google.maps.Marker({\r\n      position: { lat: zona.lat, lng: zona.lng },\r\n      map: map,\r\n      title: zona.nombre,\r\n      icon: {\r\n        path: window.google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,\r\n        scale: 8,\r\n        fillColor: '#22c55e',\r\n        fillOpacity: 1,\r\n        strokeColor: '#ffffff',\r\n        strokeWeight: 2\r\n      }\r\n    });\r\n\r\n    // Ajustar vista para mostrar ambos puntos\r\n    if (userPosition) {\r\n      const bounds = new window.google.maps.LatLngBounds();\r\n      bounds.extend(userPosition);\r\n      bounds.extend({ lat: zona.lat, lng: zona.lng });\r\n      map.fitBounds(bounds, 100);\r\n    } else {\r\n      map.setCenter({ lat: zona.lat, lng: zona.lng });\r\n      map.setZoom(15);\r\n    }\r\n  };\r\n\r\n  // Iniciar navegaci√≥n\r\n  const startNavigation = async () => {\r\n    if (!selectedZona || !userPosition) {\r\n      alert('Debes activar el GPS y seleccionar una zona primero');\r\n      return;\r\n    }\r\n\r\n    setIsNavigating(true);\r\n    setWorkStatus('traveling');\r\n    setWorkLog({\r\n      ...workLog,\r\n      startTime: new Date().toISOString(),\r\n      zona: selectedZona\r\n    });\r\n\r\n    // üî• Actualizar estado en Firebase\r\n    try {\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        estado: 'en_camino',\r\n        zonaDestino: selectedZona.nombre,\r\n        recorridoInicio: new Date().toISOString()\r\n      });\r\n      console.log('‚úÖ Estado actualizado a \"en_camino\" en Firebase');\r\n    } catch (error) {\r\n      console.error('Error al actualizar estado en Firebase:', error);\r\n    }\r\n\r\n    // Calcular y mostrar ruta\r\n    const request = {\r\n      origin: userPosition,\r\n      destination: { lat: selectedZona.lat, lng: selectedZona.lng },\r\n      travelMode: window.google.maps.TravelMode.DRIVING\r\n    };\r\n\r\n    directionsServiceRef.current.route(request, (result, status) => {\r\n      if (status === 'OK') {\r\n        directionsRendererRef.current.setDirections(result);\r\n        \r\n        const route = result.routes[0];\r\n        const leg = route.legs[0];\r\n        \r\n        setDistance(leg.distance.text);\r\n        setDuration(leg.duration.text);\r\n      } else {\r\n        alert('No se pudo calcular la ruta: ' + status);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Manejar llegada a la zona\r\n  const handleArrival = async () => {\r\n    setWorkStatus('working');\r\n    setWorkLog({\r\n      ...workLog,\r\n      arrivalTime: new Date().toISOString()\r\n    });\r\n    \r\n    // üî• Actualizar estado en Firebase\r\n    try {\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        estado: 'trabajando',\r\n        horaLlegada: new Date().toISOString()\r\n      });\r\n      console.log('‚úÖ Llegada registrada en Firebase');\r\n    } catch (error) {\r\n      console.error('Error al registrar llegada en Firebase:', error);\r\n    }\r\n    \r\n    alert('¬°Has llegado a la zona de trabajo! Puedes iniciar tu tarea.');\r\n  };\r\n\r\n  // Finalizar trabajo\r\n  const finishWork = async () => {\r\n    const endTime = new Date().toISOString();\r\n    const finalLog = {\r\n      ...workLog,\r\n      endTime: endTime\r\n    };\r\n    \r\n    setWorkLog(finalLog);\r\n    setWorkStatus('completed');\r\n    setIsNavigating(false);\r\n    setShowWorkLog(true);\r\n    \r\n    // Limpiar ruta\r\n    if (directionsRendererRef.current) {\r\n      directionsRendererRef.current.setDirections({ routes: [] });\r\n    }\r\n    \r\n    // üî• Registrar finalizaci√≥n en Firebase\r\n    try {\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        estado: 'disponible',\r\n        zonaDestino: null,\r\n        ultimoTrabajo: {\r\n          zona: selectedZona.nombre,\r\n          horaInicio: workLog.startTime,\r\n          horaLlegada: workLog.arrivalTime,\r\n          horaFin: endTime\r\n        }\r\n      });\r\n      console.log('‚úÖ Trabajo finalizado y registrado en Firebase');\r\n    } catch (error) {\r\n      console.error('Error al registrar finalizaci√≥n en Firebase:', error);\r\n    }\r\n    \r\n    console.log('Registro de trabajo:', finalLog);\r\n  };\r\n\r\n  // Resetear para nuevo trabajo\r\n  const resetWork = () => {\r\n    setSelectedZona(null);\r\n    setWorkStatus('idle');\r\n    setWorkLog({\r\n      startTime: null,\r\n      arrivalTime: null,\r\n      endTime: null,\r\n      zona: null\r\n    });\r\n    setIsNavigating(false);\r\n    setDistance(null);\r\n    setDuration(null);\r\n    setShowWorkLog(false);\r\n    \r\n    if (zonaMarkerRef.current) {\r\n      zonaMarkerRef.current.setMap(null);\r\n      zonaMarkerRef.current = null;\r\n    }\r\n    \r\n    if (directionsRendererRef.current) {\r\n      directionsRendererRef.current.setDirections({ routes: [] });\r\n    }\r\n  };\r\n\r\n  // Formatear tiempo\r\n  const formatTime = (isoString) => {\r\n    if (!isoString) return '--:--';\r\n    const date = new Date(isoString);\r\n    return date.toLocaleTimeString('es-CL', { \r\n      hour: '2-digit', \r\n      minute: '2-digit',\r\n      hour12: false \r\n    });\r\n  };\r\n\r\n  // Calcular duraci√≥n\r\n  const calculateDuration = (start, end) => {\r\n    if (!start || !end) return '--';\r\n    const diff = new Date(end) - new Date(start);\r\n    const hours = Math.floor(diff / 3600000);\r\n    const minutes = Math.floor((diff % 3600000) / 60000);\r\n    return `${hours}h ${minutes}m`;\r\n  };\r\n\r\n  // Limpiar al desmontar componente\r\n  useEffect(() => {\r\n    return () => {\r\n      // Limpiar GPS al salir\r\n      if (watchIdRef.current) {\r\n        navigator.geolocation.clearWatch(watchIdRef.current);\r\n      }\r\n      \r\n      // Marcar como inactivo en Firebase\r\n      if (currentUser?.uid) {\r\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n          estado: 'inactivo',\r\n          ubicacion: null\r\n        }).catch(console.error);\r\n      }\r\n    };\r\n  }, [currentUser]);\r\n\r\n  if (error) {\r\n    return (\r\n      <div style={{ padding: '20px', textAlign: 'center' }}>\r\n        <h2>Error</h2>\r\n        <p>{error}</p>\r\n        <button onClick={() => window.location.reload()}>Reintentar</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ width: '100%', height: '100vh', position: 'relative' }}>\r\n      {/* Encabezado */}\r\n      <div style={{\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        background: 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\r\n        color: 'white',\r\n        padding: '15px 20px',\r\n        zIndex: 1000,\r\n        boxShadow: '0 2px 10px rgba(0,0,0,0.1)'\r\n      }}>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, fontSize: '20px', fontWeight: '600' }}>\r\n              üë∑‚Äç‚ôÇÔ∏è Panel del Trabajador\r\n            </h1>\r\n            <p style={{ margin: '4px 0 0 0', fontSize: '14px', opacity: 0.95 }}>\r\n              GPS y Navegaci√≥n a Zona de Trabajo - {currentUser.name || currentUser.email}\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onLogout}\r\n            style={{\r\n              padding: '8px 16px',\r\n              background: 'rgba(255,255,255,0.2)',\r\n              color: 'white',\r\n              border: '1px solid rgba(255,255,255,0.3)',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px'\r\n            }}\r\n          >\r\n            Cerrar Sesi√≥n\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Panel de control principal */}\r\n      <div style={{\r\n        position: 'absolute',\r\n        top: '80px',\r\n        left: '10px',\r\n        right: '10px',\r\n        background: 'white',\r\n        borderRadius: '12px',\r\n        padding: '15px',\r\n        boxShadow: '0 4px 20px rgba(0,0,0,0.1)',\r\n        zIndex: 1000,\r\n        maxWidth: '400px'\r\n      }}>\r\n        {/* Activaci√≥n GPS con indicador de estado */}\r\n        <div style={{ marginBottom: '15px' }}>\r\n          <button\r\n            onClick={toggleGPS}\r\n            style={{\r\n              width: '100%',\r\n              padding: '12px',\r\n              background: isTracking ? '#ef4444' : '#22c55e',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '16px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gap: '8px'\r\n            }}\r\n          >\r\n            {isTracking ? 'üìç Desactivar GPS' : 'üìç Activar GPS'}\r\n          </button>\r\n          \r\n          {/* Indicador de estado del GPS */}\r\n          {gpsStatus !== 'inactive' && (\r\n            <div style={{ \r\n              marginTop: '8px', \r\n              fontSize: '12px', \r\n              textAlign: 'center',\r\n              padding: '6px',\r\n              borderRadius: '6px',\r\n              background: gpsStatus === 'active' ? '#dcfce7' : \r\n                         gpsStatus === 'activating' ? '#fef3c7' : \r\n                         gpsStatus === 'error' ? '#fee2e2' : '#f3f4f6',\r\n              color: gpsStatus === 'active' ? '#166534' : \r\n                     gpsStatus === 'activating' ? '#92400e' : \r\n                     gpsStatus === 'error' ? '#991b1b' : '#374151'\r\n            }}>\r\n              {gpsStatus === 'active' && 'üü¢ GPS activo - Transmitiendo ubicaci√≥n'}\r\n              {gpsStatus === 'activating' && 'üü° Activando GPS... (Acepta los permisos del navegador)'}\r\n              {gpsStatus === 'error' && 'üî¥ Error en GPS - Verificar permisos del navegador'}\r\n            </div>\r\n          )}\r\n          \r\n          {userPosition && (\r\n            <div style={{ \r\n              marginTop: '8px', \r\n              fontSize: '12px', \r\n              color: '#666',\r\n              textAlign: 'center',\r\n              background: '#f0f9ff',\r\n              padding: '8px',\r\n              borderRadius: '6px'\r\n            }}>\r\n              üìç <strong>Ubicaci√≥n actual:</strong><br/>\r\n              Lat: {userPosition.lat.toFixed(6)}<br/>\r\n              Lng: {userPosition.lng.toFixed(6)}\r\n            </div>\r\n          )}\r\n          \r\n          {/* Bot√≥n de prueba manual de ubicaci√≥n */}\r\n          {!userPosition && isTracking && gpsStatus === 'activating' && (\r\n            <button\r\n              onClick={() => {\r\n                // Usar ubicaci√≥n de prueba en Quill√≥n si el GPS real falla\r\n                const testPosition = {\r\n                  lat: -36.7333,\r\n                  lng: -72.4667\r\n                };\r\n                console.log('üìç Usando ubicaci√≥n de prueba');\r\n                updateUserPosition(testPosition);\r\n                setGpsStatus('active');\r\n              }}\r\n              style={{\r\n                marginTop: '8px',\r\n                width: '100%',\r\n                padding: '8px',\r\n                background: '#6b7280',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                fontSize: '12px',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              üîß Usar ubicaci√≥n de prueba (Quill√≥n)\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Selector de zona */}\r\n        {isTracking && workStatus === 'idle' && (\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ \r\n              display: 'block', \r\n              marginBottom: '8px', \r\n              fontSize: '14px', \r\n              fontWeight: '500' \r\n            }}>\r\n              üèóÔ∏è Seleccionar Zona de Trabajo:\r\n            </label>\r\n            <select\r\n              value={selectedZona?.id || ''}\r\n              onChange={(e) => {\r\n                const zona = zonasDisponibles.find(z => z.id === parseInt(e.target.value));\r\n                if (zona) selectZona(zona);\r\n              }}\r\n              style={{\r\n                width: '100%',\r\n                padding: '10px',\r\n                borderRadius: '6px',\r\n                border: '1px solid #ddd',\r\n                fontSize: '14px'\r\n              }}\r\n            >\r\n              <option value=\"\">-- Seleccionar zona --</option>\r\n              {zonasDisponibles.map(zona => (\r\n                <option key={zona.id} value={zona.id}>\r\n                  {zona.nombre} - {zona.direccion}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        )}\r\n\r\n        {/* Informaci√≥n de zona seleccionada */}\r\n        {selectedZona && (\r\n          <div style={{\r\n            background: '#f0f9ff',\r\n            padding: '12px',\r\n            borderRadius: '8px',\r\n            marginBottom: '15px',\r\n            border: '1px solid #bae6fd'\r\n          }}>\r\n            <h4 style={{ margin: '0 0 8px 0', color: '#0369a1', fontSize: '14px' }}>\r\n              Zona Seleccionada:\r\n            </h4>\r\n            <div style={{ fontSize: '13px', color: '#333' }}>\r\n              <strong>{selectedZona.nombre}</strong><br/>\r\n              üìç {selectedZona.direccion}\r\n              {distance && duration && (\r\n                <div style={{ marginTop: '8px', color: '#666' }}>\r\n                  üöó {distance} ‚Ä¢ ‚è±Ô∏è {duration}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Botones de acci√≥n seg√∫n estado */}\r\n        {workStatus === 'idle' && selectedZona && userPosition && (\r\n          <button\r\n            onClick={startNavigation}\r\n            style={{\r\n              width: '100%',\r\n              padding: '12px',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '16px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer'\r\n            }}\r\n          >\r\n            üöó Iniciar Recorrido\r\n          </button>\r\n        )}\r\n\r\n        {workStatus === 'traveling' && (\r\n          <div style={{\r\n            background: '#fef3c7',\r\n            padding: '12px',\r\n            borderRadius: '8px',\r\n            textAlign: 'center',\r\n            border: '1px solid #fde68a'\r\n          }}>\r\n            <div style={{ fontSize: '16px', fontWeight: '500', color: '#92400e' }}>\r\n              üöó En camino...\r\n            </div>\r\n            <div style={{ fontSize: '12px', marginTop: '4px', color: '#78350f' }}>\r\n              Hora de salida: {formatTime(workLog.startTime)}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {workStatus === 'working' && (\r\n          <div>\r\n            <div style={{\r\n              background: '#dcfce7',\r\n              padding: '12px',\r\n              borderRadius: '8px',\r\n              marginBottom: '12px',\r\n              border: '1px solid #bbf7d0'\r\n            }}>\r\n              <div style={{ fontSize: '16px', fontWeight: '500', color: '#14532d' }}>\r\n                ‚úÖ En zona de trabajo\r\n              </div>\r\n              <div style={{ fontSize: '12px', marginTop: '4px', color: '#166534' }}>\r\n                Llegada: {formatTime(workLog.arrivalTime)}\r\n              </div>\r\n            </div>\r\n            <button\r\n              onClick={finishWork}\r\n              style={{\r\n                width: '100%',\r\n                padding: '12px',\r\n                background: '#dc2626',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '8px',\r\n                fontSize: '16px',\r\n                fontWeight: '500',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              üèÅ Finalizar Trabajo\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {workStatus === 'completed' && (\r\n          <div>\r\n            <div style={{\r\n              background: '#e0e7ff',\r\n              padding: '12px',\r\n              borderRadius: '8px',\r\n              marginBottom: '12px',\r\n              border: '1px solid #c7d2fe'\r\n            }}>\r\n              <div style={{ fontSize: '16px', fontWeight: '500', color: '#312e81' }}>\r\n                ‚úÖ Trabajo Completado\r\n              </div>\r\n              <button\r\n                onClick={() => setShowWorkLog(!showWorkLog)}\r\n                style={{\r\n                  marginTop: '8px',\r\n                  padding: '6px 12px',\r\n                  background: '#4f46e5',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  fontSize: '12px',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                üìã Ver Resumen\r\n              </button>\r\n            </div>\r\n            <button\r\n              onClick={resetWork}\r\n              style={{\r\n                width: '100%',\r\n                padding: '12px',\r\n                background: '#22c55e',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '8px',\r\n                fontSize: '16px',\r\n                fontWeight: '500',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              üîÑ Nuevo Trabajo\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modal de resumen de trabajo */}\r\n      {showWorkLog && workLog.zona && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.5)',\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          zIndex: 2000,\r\n          padding: '20px'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            borderRadius: '12px',\r\n            padding: '20px',\r\n            maxWidth: '400px',\r\n            width: '100%',\r\n            maxHeight: '80vh',\r\n            overflow: 'auto'\r\n          }}>\r\n            <h3 style={{ margin: '0 0 20px 0', color: '#1f2937' }}>\r\n              üìã Resumen del Trabajo\r\n            </h3>\r\n            \r\n            <div style={{ fontSize: '14px', lineHeight: '1.8' }}>\r\n              <div style={{ marginBottom: '15px' }}>\r\n                <strong>Zona de trabajo:</strong><br/>\r\n                {workLog.zona.nombre}<br/>\r\n                üìç {workLog.zona.direccion}\r\n              </div>\r\n              \r\n              <div style={{\r\n                background: '#f8fafc',\r\n                padding: '12px',\r\n                borderRadius: '8px',\r\n                marginBottom: '15px'\r\n              }}>\r\n                <div style={{ marginBottom: '8px' }}>\r\n                  <strong>üöó Hora de salida:</strong> {formatTime(workLog.startTime)}\r\n                </div>\r\n                <div style={{ marginBottom: '8px' }}>\r\n                  <strong>‚úÖ Hora de llegada:</strong> {formatTime(workLog.arrivalTime)}\r\n                </div>\r\n                <div style={{ marginBottom: '8px' }}>\r\n                  <strong>üèÅ Hora de t√©rmino:</strong> {formatTime(workLog.endTime)}\r\n                </div>\r\n                <hr style={{ margin: '10px 0', border: 'none', borderTop: '1px solid #e5e7eb' }}/>\r\n                <div>\r\n                  <strong>‚è±Ô∏è Tiempo de viaje:</strong> {calculateDuration(workLog.startTime, workLog.arrivalTime)}\r\n                </div>\r\n                <div>\r\n                  <strong>‚è±Ô∏è Tiempo trabajado:</strong> {calculateDuration(workLog.arrivalTime, workLog.endTime)}\r\n                </div>\r\n                <div>\r\n                  <strong>‚è±Ô∏è Tiempo total:</strong> {calculateDuration(workLog.startTime, workLog.endTime)}\r\n                </div>\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setShowWorkLog(false)}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '10px',\r\n                  background: '#6b7280',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  fontSize: '14px',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Cerrar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Mapa */}\r\n      <div \r\n        ref={mapRef}\r\n        style={{ \r\n          width: '100%', \r\n          height: '100%'\r\n        }} \r\n      />\r\n      \r\n      {/* Indicador de carga */}\r\n      {!mapLoaded && (\r\n        <div style={{\r\n          position: 'absolute',\r\n          top: '50%',\r\n          left: '50%',\r\n          transform: 'translate(-50%, -50%)',\r\n          textAlign: 'center',\r\n          zIndex: 1001\r\n        }}>\r\n          <div style={{\r\n            width: '50px',\r\n            height: '50px',\r\n            border: '4px solid #f3f3f3',\r\n            borderTop: '4px solid #22c55e',\r\n            borderRadius: '50%',\r\n            animation: 'spin 1s linear infinite'\r\n          }}></div>\r\n          <p style={{ marginTop: '10px', color: '#666' }}>Cargando mapa...</p>\r\n        </div>\r\n      )}\r\n\r\n      <style jsx>{`\r\n        @keyframes spin {\r\n          0% { transform: rotate(0deg); }\r\n          100% { transform: rotate(360deg); }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SistemaTrabajadoresFirebase;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}