{"ast":null,"code":"// src/components/Login.js\nimport React,{useState}from'react';import PasswordRecovery from'./PasswordRecovery';import{signInWithEmailAndPassword,updatePassword,EmailAuthProvider,reauthenticateWithCredential,createUserWithEmailAndPassword,signOut}from'firebase/auth';import{auth,firestore}from'../config/firebase';import{doc,getDoc,updateDoc,query,where,collection,getDocs,setDoc}from'firebase/firestore';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Login=_ref=>{let{onLogin}=_ref;const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[successMessage,setSuccessMessage]=useState('');// Estados para cambio de contraseña obligatorio\nconst[showChangePassword,setShowChangePassword]=useState(false);const[currentUser,setCurrentUser]=useState(null);const[newPassword,setNewPassword]=useState('');const[confirmPassword,setConfirmPassword]=useState('');const[oldPassword,setOldPassword]=useState('');const[showPasswordRecovery,setShowPasswordRecovery]=useState(false);const handleLogin=async e=>{e.preventDefault();setLoading(true);setError('');setSuccessMessage('');const normalizedEmail=email.toLowerCase().trim();console.log('🔐 Intentando login con email:',normalizedEmail);console.log('🔑 Contraseña ingresada:',password);try{// PRIMERO: Verificar si existe una contraseña temporal en Firestore\nconst usersRef=collection(firestore,'users');const q=query(usersRef,where('email','==',normalizedEmail));const querySnapshot=await getDocs(q);if(!querySnapshot.empty){const userDoc=querySnapshot.docs[0];const userFirestoreData=userDoc.data();const userDocId=userDoc.id;console.log('📋 Usuario encontrado en Firestore:');console.log('  - ID documento:',userDocId);console.log('  - Email en DB:',userFirestoreData.email);console.log('  - Tiene contraseña temporal?:',!!userFirestoreData.tempPassword);console.log('  - Requiere cambio?:',userFirestoreData.requirePasswordChange);// Verificar si hay contraseña temporal\nif(userFirestoreData.tempPassword){try{const tempPasswordDecoded=atob(userFirestoreData.tempPassword);console.log('🔐 Contraseña temporal decodificada:',tempPasswordDecoded);console.log('🔑 Contraseña ingresada:',password);console.log('✅ Coinciden?:',password===tempPasswordDecoded);if(password===tempPasswordDecoded){console.log('✅ Login con contraseña temporal exitoso!');console.log('🔍 Requiere cambio de contraseña?:',userFirestoreData.requirePasswordChange);// Login exitoso con contraseña temporal\n// Actualizar última conexión\nawait updateDoc(doc(firestore,'users',userDocId),{lastLogin:new Date().toISOString()});// SOLO marcar para cambio de contraseña si realmente lo requiere\nif(userFirestoreData.requirePasswordChange===true){console.log('➡️ Redirigiendo a cambio de contraseña obligatorio');setCurrentUser({uid:userDocId,email:userFirestoreData.email,role:userFirestoreData.role,name:userFirestoreData.name,...userFirestoreData,isTempPasswordLogin:true});setOldPassword(password);setShowChangePassword(true);setLoading(false);return;}else{console.log('✅ Contraseña ya fue cambiada, continuando con login normal');// La contraseña ya fue cambiada, continuar con login normal\nonLogin({uid:userDocId,email:userFirestoreData.email,role:userFirestoreData.role,name:userFirestoreData.name,...userFirestoreData});setLoading(false);return;}}else{console.log('❌ Las contraseñas NO coinciden');console.log('  - Esperada:',tempPasswordDecoded);console.log('  - Recibida:',password);}}catch(e){console.log('❌ Error decodificando contraseña temporal:',e);}}else{console.log('ℹ️ Usuario no tiene contraseña temporal, intentando login normal...');}}else{console.log('⚠️ No se encontró usuario en Firestore con email:',normalizedEmail);}// SEGUNDO: Si no es contraseña temporal o no coincide, intentar login normal con Firebase Auth\nconsole.log('🔐 Intentando login normal con Firebase Auth...');try{const userCredential=await signInWithEmailAndPassword(auth,normalizedEmail,password);const user=userCredential.user;console.log('✅ Login exitoso con Firebase Auth, UID:',user.uid);// Obtener datos del usuario desde Firestore usando el UID de Auth\nconst userDoc=await getDoc(doc(firestore,'users',user.uid));if(userDoc.exists()){const userData=userDoc.data();// Verificar si debe cambiar contraseña\nif(userData.requirePasswordChange||userData.firstLogin!==false){// Limpiar flags de contraseña temporal si existen\nif(userData.tempPassword){await updateDoc(doc(firestore,'users',user.uid),{tempPassword:null,lastTempPassword:userData.tempPassword// Guardar para referencia\n});}setCurrentUser({uid:user.uid,email:user.email,role:userData.role,name:userData.name,...userData});setOldPassword(password);setShowChangePassword(true);}else{// Login exitoso - actualizar última conexión\nawait updateDoc(doc(firestore,'users',user.uid),{lastLogin:new Date().toISOString()});// Login normal\nonLogin({uid:user.uid,email:user.email,role:userData.role,name:userData.name,...userData});}}else{console.log('❌ Usuario autenticado pero no encontrado en Firestore, UID:',user.uid);setError('No se encontraron datos del usuario');}}catch(authError){console.log('❌ Error en Firebase Auth:',authError.code);// Si falla el login con Firebase Auth, verificar si la contraseña está en Firestore como fallback\nif(authError.code==='auth/invalid-credential'||authError.code==='auth/wrong-password'){console.log('🔄 Verificando contraseña en Firestore como fallback...');// Buscar el usuario en Firestore nuevamente\nconst usersRef=collection(firestore,'users');const q=query(usersRef,where('email','==',normalizedEmail));const querySnapshot=await getDocs(q);if(!querySnapshot.empty){const userDoc=querySnapshot.docs[0];const userFirestoreData=userDoc.data();const userDocId=userDoc.id;// Verificar si hay una contraseña guardada en Firestore (fallback)\nif(userFirestoreData.tempPassword){try{const storedPassword=atob(userFirestoreData.tempPassword);if(password===storedPassword){console.log('✅ Login exitoso con contraseña de Firestore (fallback)');console.log('🔍 Necesita sincronización con Auth?:',userFirestoreData.needsAuthSync);console.log('🔍 Requiere cambio de contraseña?:',userFirestoreData.requirePasswordChange);// Si needsAuthSync es true, intentar sincronizar\nif(userFirestoreData.needsAuthSync===true){// Intentar sincronizar con Firebase Auth\ntry{console.log('🔄 Intentando sincronizar con Firebase Auth...');await createUserWithEmailAndPassword(auth,normalizedEmail,password);console.log('✅ Usuario sincronizado con Firebase Auth');const firebaseUser=auth.currentUser;if(firebaseUser&&firebaseUser.uid!==userDocId){// Migrar datos al nuevo UID de Firebase\nconsole.log('🔄 Migrando datos al UID de Firebase Auth...');// Crear nuevo documento con el UID de Firebase\nawait setDoc(doc(firestore,'users',firebaseUser.uid),{...userFirestoreData,tempPassword:null,// Limpiar contraseña temporal\nneedsAuthSync:false,authPasswordSynced:true,requirePasswordChange:false,lastLogin:new Date().toISOString()});// Cerrar sesión y usar el nuevo UID para el login\nawait signOut(auth);onLogin({uid:firebaseUser.uid,email:userFirestoreData.email,role:userFirestoreData.role,name:userFirestoreData.name,...userFirestoreData,requirePasswordChange:false});}else{// Limpiar flags de sincronización\nawait updateDoc(doc(firestore,'users',userDocId),{tempPassword:null,// Limpiar contraseña temporal ya sincronizada\nneedsAuthSync:false,authPasswordSynced:true,requirePasswordChange:false,lastLogin:new Date().toISOString()});// Cerrar sesión\nif(auth.currentUser){await signOut(auth);}// Login exitoso\nonLogin({uid:userDocId,email:userFirestoreData.email,role:userFirestoreData.role,name:userFirestoreData.name,...userFirestoreData,requirePasswordChange:false});}}catch(syncError){console.log('⚠️ No se pudo sincronizar con Auth:',syncError.code);if(syncError.code==='auth/email-already-in-use'){// El usuario ya existe en Auth, continuar sin sincronizar\nconsole.log('ℹ️ Usuario ya existe en Auth, continuando con Firestore...');}// Actualizar última conexión\nawait updateDoc(doc(firestore,'users',userDocId),{lastLogin:new Date().toISOString()});// Login exitoso con Firestore\nonLogin({uid:userDocId,email:userFirestoreData.email,role:userFirestoreData.role,name:userFirestoreData.name,...userFirestoreData,requirePasswordChange:false});}}else{// No necesita sincronización, login directo\nawait updateDoc(doc(firestore,'users',userDocId),{lastLogin:new Date().toISOString()});onLogin({uid:userDocId,email:userFirestoreData.email,role:userFirestoreData.role,name:userFirestoreData.name,...userFirestoreData,requirePasswordChange:false});}setLoading(false);return;}}catch(e){console.log('Error verificando contraseña de fallback:',e);}}}}// Si llegamos aquí, el login falló completamente\nthrow authError;}}catch(error){console.error('❌ Error al iniciar sesión:',error);console.error('Código de error:',error.code);console.error('Mensaje:',error.message);// Mensajes de error en español\nswitch(error.code){case'auth/user-not-found':setError('Usuario no encontrado. Verifica tu email');break;case'auth/wrong-password':setError('Contraseña incorrecta');break;case'auth/invalid-email':setError('Email inválido');break;case'auth/too-many-requests':setError('Demasiados intentos. Intenta más tarde');break;case'auth/invalid-credential':setError('Credenciales inválidas. Verifica tu email y contraseña');break;case'auth/network-request-failed':setError('Error de conexión. Verifica tu internet');break;default:setError('Error al iniciar sesión. Intenta nuevamente');}}finally{setLoading(false);}};const handleChangePassword=async e=>{e.preventDefault();// Validaciones\nif(newPassword.length<6){setError('La contraseña debe tener al menos 6 caracteres');return;}if(newPassword!==confirmPassword){setError('Las contraseñas no coinciden');return;}if(newPassword===oldPassword){setError('La nueva contraseña debe ser diferente a la anterior');return;}// Validación adicional de seguridad\nconst hasNumber=/\\d/.test(newPassword);const hasLetter=/[a-zA-Z]/.test(newPassword);if(!hasNumber||!hasLetter){setError('La contraseña debe contener al menos una letra y un número');return;}setLoading(true);setError('');try{// Verificar si es un login con contraseña temporal\nif(currentUser.isTempPasswordLogin){console.log('🔄 Actualizando desde contraseña temporal...');let authUpdated=false;// ESTRATEGIA MEJORADA: Intentar múltiples métodos para actualizar en Firebase Auth\n// Método 1: Intentar crear el usuario nuevo\ntry{await createUserWithEmailAndPassword(auth,currentUser.email,newPassword);console.log('✅ Usuario creado en Firebase Auth con nueva contraseña');authUpdated=true;// Si se creó exitosamente, obtener el UID real de Firebase Auth\nconst firebaseUser=auth.currentUser;if(firebaseUser){// Actualizar el UID en Firestore si es diferente\nif(currentUser.uid!==firebaseUser.uid){console.log('🔄 Migrando datos al nuevo UID en Firestore...');// Copiar datos del documento antiguo al nuevo\nconst oldUserDoc=await getDoc(doc(firestore,'users',currentUser.uid));const oldUserData=oldUserDoc.exists()?oldUserDoc.data():{};// Crear o actualizar el documento con el nuevo UID\nawait setDoc(doc(firestore,'users',firebaseUser.uid),{...oldUserData,email:currentUser.email,requirePasswordChange:false,firstLogin:false,passwordChangedAt:new Date().toISOString(),tempPassword:null,lastTempPassword:null,resetMethod:null,authPasswordSynced:true});// Actualizar el currentUser con el nuevo UID\ncurrentUser.uid=firebaseUser.uid;}else{// Si el UID es el mismo, solo actualizar\nawait updateDoc(doc(firestore,'users',currentUser.uid),{requirePasswordChange:false,firstLogin:false,passwordChangedAt:new Date().toISOString(),tempPassword:null,lastTempPassword:null,resetMethod:null,authPasswordSynced:true});}// Cerrar sesión para hacer un login limpio después\nawait signOut(auth);}}catch(createError){console.log('❌ No se pudo crear usuario:',createError.code);if(createError.code==='auth/email-already-in-use'){// Método 2: El usuario existe, intentar múltiples formas de actualizar\n// Método 2a: Intentar con la última contraseña temporal conocida\nif(currentUser.lastTempPassword){try{const lastTemp=atob(currentUser.lastTempPassword);await signInWithEmailAndPassword(auth,currentUser.email,lastTemp);await updatePassword(auth.currentUser,newPassword);console.log('✅ Contraseña actualizada usando última temporal');authUpdated=true;// Cerrar sesión para hacer un login limpio después\nawait signOut(auth);}catch(e){console.log('❌ No funcionó con última temporal');}}// Método 2b: Intentar con la contraseña temporal actual\nif(!authUpdated){try{await signInWithEmailAndPassword(auth,currentUser.email,oldPassword);await updatePassword(auth.currentUser,newPassword);console.log('✅ Contraseña actualizada con temporal actual');authUpdated=true;// Cerrar sesión para hacer un login limpio después\nawait signOut(auth);}catch(e){console.log('❌ No funcionó con temporal actual');}}// Método 2c: Si nada funcionó, guardar la nueva contraseña como temporal en Firestore\nif(!authUpdated){console.log('⚠️ Guardando nueva contraseña en Firestore como fallback');// IMPORTANTE: Marcar requirePasswordChange como FALSE para evitar el ciclo\nawait updateDoc(doc(firestore,'users',currentUser.uid),{tempPassword:btoa(newPassword),requirePasswordChange:false,// IMPORTANTE: false para evitar ciclo\nfirstLogin:false,passwordChangedAt:new Date().toISOString(),lastTempPassword:btoa(oldPassword),resetMethod:'FALLBACK_FIRESTORE',authPasswordSynced:false,needsAuthSync:true});console.log('✅ Contraseña guardada en Firestore');setSuccessMessage('✅ Contraseña actualizada correctamente. La página se recargará en 3 segundos...');// Esperar y recargar la página\nsetTimeout(()=>{console.log('🔄 Recargando página para aplicar cambios...');window.location.reload();},3000);return;// Salir aquí para usar el flujo especial\n}}else{throw createError;}}// Si llegamos aquí, la contraseña se actualizó en Auth exitosamente\nif(authUpdated){// Verificar si el documento existe en Firestore antes de actualizar\nconst userDocRef=doc(firestore,'users',currentUser.uid);const userDocSnap=await getDoc(userDocRef);if(userDocSnap.exists()){// Actualizar en Firestore (limpiar campos temporales)\nawait updateDoc(userDocRef,{requirePasswordChange:false,firstLogin:false,passwordChangedAt:new Date().toISOString(),tempPassword:null,lastTempPassword:null,resetMethod:null,authPasswordSynced:true,needsAuthSync:false});}else{// Si no existe, crear el documento\nawait setDoc(userDocRef,{email:currentUser.email,role:currentUser.role||'worker',name:currentUser.name||'',requirePasswordChange:false,firstLogin:false,passwordChangedAt:new Date().toISOString(),tempPassword:null,lastTempPassword:null,resetMethod:null,authPasswordSynced:true,needsAuthSync:false});}setSuccessMessage('✅ Contraseña actualizada exitosamente');// Hacer login automático con la nueva contraseña\nsetTimeout(async()=>{try{// Asegurar que no hay sesión activa\nif(auth.currentUser){console.log('⚠️ Cerrando sesión activa antes de auto-login...');await signOut(auth);// Esperar un momento para asegurar que se cerró la sesión\nawait new Promise(resolve=>setTimeout(resolve,500));}console.log('🔐 Intentando auto-login con nueva contraseña...');// Iniciar sesión con la nueva contraseña\nconst userCredential=await signInWithEmailAndPassword(auth,currentUser.email,newPassword);const user=userCredential.user;console.log('✅ Auto-login exitoso, UID:',user.uid);// Obtener datos actualizados de Firestore con el UID correcto\nconst userDocRef=doc(firestore,'users',user.uid);const userDocSnap=await getDoc(userDocRef);if(userDocSnap.exists()){const userData=userDocSnap.data();onLogin({uid:user.uid,email:user.email,role:userData.role,name:userData.name,...userData,requirePasswordChange:false,firstLogin:false,isTempPasswordLogin:false});}else{// Si no existe con el UID de Auth, usar los datos que tenemos\nonLogin({...currentUser,uid:user.uid,requirePasswordChange:false,firstLogin:false,isTempPasswordLogin:false});}}catch(error){console.log('❌ Error en auto-login:',error.code,error.message);// Si falla el auto-login, continuar de todos modos\nonLogin({...currentUser,requirePasswordChange:false,firstLogin:false,isTempPasswordLogin:false});}},2000);// Aumentar el tiempo de espera\n}}else{// Usuario autenticado normalmente con Firebase Auth\nconst user=auth.currentUser;if(user){// Actualizar contraseña en Firebase Auth\nawait updatePassword(user,newPassword);// Actualizar en Firestore\nawait updateDoc(doc(firestore,'users',user.uid),{requirePasswordChange:false,firstLogin:false,passwordChangedAt:new Date().toISOString(),tempPassword:null,lastTempPassword:null,resetMethod:null});setSuccessMessage('✅ Contraseña actualizada exitosamente');// Esperar un momento antes de continuar\nsetTimeout(()=>{onLogin({...currentUser,requirePasswordChange:false,firstLogin:false});},2000);}else{setError('Error de autenticación. Por favor, vuelve a iniciar sesión');}}}catch(error){console.error('Error al cambiar contraseña:',error);switch(error.code){case'auth/weak-password':setError('La contraseña es muy débil. Usa al menos 6 caracteres con letras y números');break;case'auth/requires-recent-login':setError('Por seguridad, vuelve a iniciar sesión');break;case'auth/network-request-failed':setError('Error de conexión. Verifica tu internet');break;default:setError('Error al cambiar la contraseña. Intenta nuevamente');}}finally{setLoading(false);}};// Formulario de cambio de contraseña obligatorio\nif(showChangePassword){return/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:'100vh',display:'flex',justifyContent:'center',alignItems:'center',background:'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',fontFamily:'Arial, sans-serif'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'40px',borderRadius:'20px',boxShadow:'0 20px 40px rgba(0,0,0,0.1)',maxWidth:'400px',width:'90%'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginBottom:'30px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',marginBottom:'10px'},children:\"\\uD83D\\uDD10\"}),/*#__PURE__*/_jsx(\"h2\",{style:{color:'#1f2937',margin:'0 0 10px 0',fontSize:'24px',fontWeight:'700'},children:\"Cambio de Contrase\\xF1a Obligatorio\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#6b7280',margin:0,fontSize:'14px'},children:\"Por seguridad, debes cambiar tu contrase\\xF1a temporal\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleChangePassword,children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'#374151',fontSize:'14px',fontWeight:'500'},children:\"Nueva Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:newPassword,onChange:e=>setNewPassword(e.target.value),required:true,placeholder:\"M\\xEDnimo 6 caracteres con letras y n\\xFAmeros\",style:{width:'100%',padding:'12px',border:'1px solid #d1d5db',borderRadius:'8px',fontSize:'14px',outline:'none',transition:'border-color 0.2s'},onFocus:e=>e.target.style.borderColor='#667eea',onBlur:e=>e.target.style.borderColor='#d1d5db'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'24px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'#374151',fontSize:'14px',fontWeight:'500'},children:\"Confirmar Nueva Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:confirmPassword,onChange:e=>setConfirmPassword(e.target.value),required:true,placeholder:\"Repite la contrase\\xF1a\",style:{width:'100%',padding:'12px',border:'1px solid #d1d5db',borderRadius:'8px',fontSize:'14px',outline:'none',transition:'border-color 0.2s'},onFocus:e=>e.target.style.borderColor='#667eea',onBlur:e=>e.target.style.borderColor='#d1d5db'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',padding:'12px',background:'#f3f4f6',borderRadius:'6px',fontSize:'12px',color:'#6b7280'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Requisitos de la contrase\\xF1a:\"}),/*#__PURE__*/_jsxs(\"ul\",{style:{margin:'5px 0 0 0',paddingLeft:'20px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"M\\xEDnimo 6 caracteres\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Al menos una letra\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Al menos un n\\xFAmero\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Diferente a la contrase\\xF1a anterior\"})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{style:{background:'#fef2f2',border:'1px solid #fecaca',color:'#dc2626',padding:'10px',borderRadius:'6px',marginBottom:'20px',fontSize:'14px',textAlign:'center'},children:error}),successMessage&&/*#__PURE__*/_jsx(\"div\",{style:{background:'#dcfce7',border:'1px solid #86efac',color:'#166534',padding:'10px',borderRadius:'6px',marginBottom:'20px',fontSize:'14px',textAlign:'center'},children:successMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{width:'100%',padding:'14px',background:loading?'#9ca3af':'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'600',cursor:loading?'not-allowed':'pointer',transition:'transform 0.2s',display:'flex',alignItems:'center',justifyContent:'center',gap:'8px'},children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner\"}),\"Actualizando...\"]}):'✅ Cambiar Contraseña'})]})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n          .spinner {\n            width: 16px;\n            height: 16px;\n            border: 2px solid #ffffff;\n            border-top-color: transparent;\n            border-radius: 50%;\n            animation: spin 0.6s linear infinite;\n          }\n          \n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `})]});}// Formulario de login principal\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:'100vh',display:'flex',justifyContent:'center',alignItems:'center',background:'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',fontFamily:'Arial, sans-serif'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'40px',borderRadius:'20px',boxShadow:'0 20px 40px rgba(0,0,0,0.1)',maxWidth:'400px',width:'90%'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginBottom:'30px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',marginBottom:'10px'},children:\"\\uD83D\\uDDFA\\uFE0F\"}),/*#__PURE__*/_jsx(\"h1\",{style:{color:'#1f2937',margin:'0 0 10px 0',fontSize:'28px',fontWeight:'700'},children:\"MapaQuill\\xF3n\"}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'#6b7280',margin:0,fontSize:'14px'},children:[\"Sistema de Control de Flota\",/*#__PURE__*/_jsx(\"br\",{}),\"Municipalidad de Quill\\xF3n\"]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'#374151',fontSize:'14px',fontWeight:'500'},children:\"Correo Electr\\xF3nico\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true,placeholder:\"ejemplo@gmail.com\",style:{width:'100%',padding:'12px',border:'1px solid #d1d5db',borderRadius:'8px',fontSize:'14px',outline:'none',transition:'border-color 0.2s'},onFocus:e=>e.target.style.borderColor='#667eea',onBlur:e=>e.target.style.borderColor='#d1d5db'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',color:'#374151',fontSize:'14px',fontWeight:'500'},children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\",style:{width:'100%',padding:'12px',border:'1px solid #d1d5db',borderRadius:'8px',fontSize:'14px',outline:'none',transition:'border-color 0.2s'},onFocus:e=>e.target.style.borderColor='#667eea',onBlur:e=>e.target.style.borderColor='#d1d5db'})]}),error&&/*#__PURE__*/_jsx(\"div\",{style:{background:'#fef2f2',border:'1px solid #fecaca',color:'#dc2626',padding:'10px',borderRadius:'6px',marginBottom:'20px',fontSize:'14px',textAlign:'center'},children:error}),successMessage&&/*#__PURE__*/_jsx(\"div\",{style:{background:'#dcfce7',border:'1px solid #86efac',color:'#166534',padding:'10px',borderRadius:'6px',marginBottom:'20px',fontSize:'14px',textAlign:'center'},children:successMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{width:'100%',padding:'14px',background:loading?'#9ca3af':'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'600',cursor:loading?'not-allowed':'pointer',transition:'transform 0.2s',display:'flex',alignItems:'center',justifyContent:'center',gap:'8px'},onMouseOver:e=>!loading&&(e.currentTarget.style.transform='translateY(-2px)'),onMouseOut:e=>e.currentTarget.style.transform='translateY(0px)',children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner\"}),\"Iniciando sesi\\xF3n...\"]}):'Iniciar Sesión'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPasswordRecovery(true),style:{width:'100%',padding:'12px',background:'transparent',color:'#3b82f6',border:'1px solid #3b82f6',borderRadius:'8px',fontSize:'14px',fontWeight:'500',cursor:'pointer',marginTop:'10px'},children:\"\\uD83D\\uDD13 \\xBFOlvidaste tu contrase\\xF1a?\"}),showPasswordRecovery&&/*#__PURE__*/_jsx(PasswordRecovery,{onClose:()=>setShowPasswordRecovery(false),onSuccess:()=>{setShowPasswordRecovery(false);setSuccessMessage('✅ Ya puedes iniciar sesión con tu contraseña temporal');setTimeout(()=>setSuccessMessage(''),5000);}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px',padding:'15px',background:'#f9fafb',borderRadius:'8px',fontSize:'12px',color:'#6b7280',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\xBFNecesitas ayuda?\"}),/*#__PURE__*/_jsx(\"br\",{}),\"Contacta al administrador del sistema\",/*#__PURE__*/_jsx(\"br\",{}),\"\\uD83D\\uDCDE +56 9 1234 5678\"]})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n        .spinner {\n          width: 16px;\n          height: 16px;\n          border: 2px solid #ffffff;\n          border-top-color: transparent;\n          border-radius: 50%;\n          animation: spin 0.6s linear infinite;\n          display: inline-block;\n        }\n        \n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `})]});};export default Login;","map":{"version":3,"names":["React","useState","PasswordRecovery","signInWithEmailAndPassword","updatePassword","EmailAuthProvider","reauthenticateWithCredential","createUserWithEmailAndPassword","signOut","auth","firestore","doc","getDoc","updateDoc","query","where","collection","getDocs","setDoc","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","_ref","onLogin","email","setEmail","password","setPassword","loading","setLoading","error","setError","successMessage","setSuccessMessage","showChangePassword","setShowChangePassword","currentUser","setCurrentUser","newPassword","setNewPassword","confirmPassword","setConfirmPassword","oldPassword","setOldPassword","showPasswordRecovery","setShowPasswordRecovery","handleLogin","e","preventDefault","normalizedEmail","toLowerCase","trim","console","log","usersRef","q","querySnapshot","empty","userDoc","docs","userFirestoreData","data","userDocId","id","tempPassword","requirePasswordChange","tempPasswordDecoded","atob","lastLogin","Date","toISOString","uid","role","name","isTempPasswordLogin","userCredential","user","exists","userData","firstLogin","lastTempPassword","authError","code","storedPassword","needsAuthSync","firebaseUser","authPasswordSynced","syncError","message","handleChangePassword","length","hasNumber","test","hasLetter","authUpdated","oldUserDoc","oldUserData","passwordChangedAt","resetMethod","createError","lastTemp","btoa","setTimeout","window","location","reload","userDocRef","userDocSnap","Promise","resolve","style","width","height","display","justifyContent","alignItems","background","fontFamily","children","padding","borderRadius","boxShadow","maxWidth","textAlign","marginBottom","fontSize","color","margin","fontWeight","onSubmit","type","value","onChange","target","required","placeholder","border","outline","transition","onFocus","borderColor","onBlur","paddingLeft","disabled","cursor","gap","className","onMouseOver","currentTarget","transform","onMouseOut","onClick","marginTop","onClose","onSuccess"],"sources":["C:/Users/Izan/Desktop/AppReact/mapa-quillon/src/components/Login.js"],"sourcesContent":["// src/components/Login.js\r\nimport React, { useState } from 'react';\r\nimport PasswordRecovery from './PasswordRecovery';\r\nimport {\r\n  signInWithEmailAndPassword,\r\n  updatePassword,\r\n  EmailAuthProvider,\r\n  reauthenticateWithCredential,\r\n  createUserWithEmailAndPassword,\r\n  signOut\r\n} from 'firebase/auth';\r\nimport { auth, firestore } from '../config/firebase';\r\nimport { doc, getDoc, updateDoc, query, where, collection, getDocs, setDoc } from 'firebase/firestore';\r\n\r\nconst Login = ({ onLogin }) => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n\r\n  // Estados para cambio de contraseña obligatorio\r\n  const [showChangePassword, setShowChangePassword] = useState(false);\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [oldPassword, setOldPassword] = useState('');\r\n  const [showPasswordRecovery, setShowPasswordRecovery] = useState(false);\r\n\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError('');\r\n    setSuccessMessage('');\r\n\r\n    const normalizedEmail = email.toLowerCase().trim();\r\n    console.log('🔐 Intentando login con email:', normalizedEmail);\r\n    console.log('🔑 Contraseña ingresada:', password);\r\n\r\n    try {\r\n      // PRIMERO: Verificar si existe una contraseña temporal en Firestore\r\n      const usersRef = collection(firestore, 'users');\r\n      const q = query(usersRef, where('email', '==', normalizedEmail));\r\n      const querySnapshot = await getDocs(q);\r\n\r\n      if (!querySnapshot.empty) {\r\n        const userDoc = querySnapshot.docs[0];\r\n        const userFirestoreData = userDoc.data();\r\n        const userDocId = userDoc.id;\r\n\r\n        console.log('📋 Usuario encontrado en Firestore:');\r\n        console.log('  - ID documento:', userDocId);\r\n        console.log('  - Email en DB:', userFirestoreData.email);\r\n        console.log('  - Tiene contraseña temporal?:', !!userFirestoreData.tempPassword);\r\n        console.log('  - Requiere cambio?:', userFirestoreData.requirePasswordChange);\r\n\r\n        // Verificar si hay contraseña temporal\r\n        if (userFirestoreData.tempPassword) {\r\n          try {\r\n            const tempPasswordDecoded = atob(userFirestoreData.tempPassword);\r\n            console.log('🔐 Contraseña temporal decodificada:', tempPasswordDecoded);\r\n            console.log('🔑 Contraseña ingresada:', password);\r\n            console.log('✅ Coinciden?:', password === tempPasswordDecoded);\r\n            \r\n            if (password === tempPasswordDecoded) {\r\n              console.log('✅ Login con contraseña temporal exitoso!');\r\n              console.log('🔍 Requiere cambio de contraseña?:', userFirestoreData.requirePasswordChange);\r\n              \r\n              // Login exitoso con contraseña temporal\r\n              // Actualizar última conexión\r\n              await updateDoc(doc(firestore, 'users', userDocId), {\r\n                lastLogin: new Date().toISOString()\r\n              });\r\n              \r\n              // SOLO marcar para cambio de contraseña si realmente lo requiere\r\n              if (userFirestoreData.requirePasswordChange === true) {\r\n                console.log('➡️ Redirigiendo a cambio de contraseña obligatorio');\r\n                setCurrentUser({\r\n                  uid: userDocId,\r\n                  email: userFirestoreData.email,\r\n                  role: userFirestoreData.role,\r\n                  name: userFirestoreData.name,\r\n                  ...userFirestoreData,\r\n                  isTempPasswordLogin: true\r\n                });\r\n                setOldPassword(password);\r\n                setShowChangePassword(true);\r\n                setLoading(false);\r\n                return;\r\n              } else {\r\n                console.log('✅ Contraseña ya fue cambiada, continuando con login normal');\r\n                // La contraseña ya fue cambiada, continuar con login normal\r\n                onLogin({\r\n                  uid: userDocId,\r\n                  email: userFirestoreData.email,\r\n                  role: userFirestoreData.role,\r\n                  name: userFirestoreData.name,\r\n                  ...userFirestoreData\r\n                });\r\n                setLoading(false);\r\n                return;\r\n              }\r\n            } else {\r\n              console.log('❌ Las contraseñas NO coinciden');\r\n              console.log('  - Esperada:', tempPasswordDecoded);\r\n              console.log('  - Recibida:', password);\r\n            }\r\n          } catch (e) {\r\n            console.log('❌ Error decodificando contraseña temporal:', e);\r\n          }\r\n        } else {\r\n          console.log('ℹ️ Usuario no tiene contraseña temporal, intentando login normal...');\r\n        }\r\n      } else {\r\n        console.log('⚠️ No se encontró usuario en Firestore con email:', normalizedEmail);\r\n      }\r\n\r\n      // SEGUNDO: Si no es contraseña temporal o no coincide, intentar login normal con Firebase Auth\r\n      console.log('🔐 Intentando login normal con Firebase Auth...');\r\n      \r\n      try {\r\n        const userCredential = await signInWithEmailAndPassword(auth, normalizedEmail, password);\r\n        const user = userCredential.user;\r\n        console.log('✅ Login exitoso con Firebase Auth, UID:', user.uid);\r\n\r\n        // Obtener datos del usuario desde Firestore usando el UID de Auth\r\n        const userDoc = await getDoc(doc(firestore, 'users', user.uid));\r\n\r\n        if (userDoc.exists()) {\r\n          const userData = userDoc.data();\r\n\r\n          // Verificar si debe cambiar contraseña\r\n          if (userData.requirePasswordChange || userData.firstLogin !== false) {\r\n            // Limpiar flags de contraseña temporal si existen\r\n            if (userData.tempPassword) {\r\n              await updateDoc(doc(firestore, 'users', user.uid), {\r\n                tempPassword: null,\r\n                lastTempPassword: userData.tempPassword // Guardar para referencia\r\n              });\r\n            }\r\n\r\n            setCurrentUser({\r\n              uid: user.uid,\r\n              email: user.email,\r\n              role: userData.role,\r\n              name: userData.name,\r\n              ...userData\r\n            });\r\n            setOldPassword(password);\r\n            setShowChangePassword(true);\r\n          } else {\r\n            // Login exitoso - actualizar última conexión\r\n            await updateDoc(doc(firestore, 'users', user.uid), {\r\n              lastLogin: new Date().toISOString()\r\n            });\r\n\r\n            // Login normal\r\n            onLogin({\r\n              uid: user.uid,\r\n              email: user.email,\r\n              role: userData.role,\r\n              name: userData.name,\r\n              ...userData\r\n            });\r\n          }\r\n        } else {\r\n          console.log('❌ Usuario autenticado pero no encontrado en Firestore, UID:', user.uid);\r\n          setError('No se encontraron datos del usuario');\r\n        }\r\n      } catch (authError) {\r\n        console.log('❌ Error en Firebase Auth:', authError.code);\r\n        \r\n        // Si falla el login con Firebase Auth, verificar si la contraseña está en Firestore como fallback\r\n        if (authError.code === 'auth/invalid-credential' || authError.code === 'auth/wrong-password') {\r\n          console.log('🔄 Verificando contraseña en Firestore como fallback...');\r\n          \r\n          // Buscar el usuario en Firestore nuevamente\r\n          const usersRef = collection(firestore, 'users');\r\n          const q = query(usersRef, where('email', '==', normalizedEmail));\r\n          const querySnapshot = await getDocs(q);\r\n          \r\n          if (!querySnapshot.empty) {\r\n            const userDoc = querySnapshot.docs[0];\r\n            const userFirestoreData = userDoc.data();\r\n            const userDocId = userDoc.id;\r\n            \r\n            // Verificar si hay una contraseña guardada en Firestore (fallback)\r\n            if (userFirestoreData.tempPassword) {\r\n              try {\r\n                const storedPassword = atob(userFirestoreData.tempPassword);\r\n                \r\n                if (password === storedPassword) {\r\n                  console.log('✅ Login exitoso con contraseña de Firestore (fallback)');\r\n                  console.log('🔍 Necesita sincronización con Auth?:', userFirestoreData.needsAuthSync);\r\n                  console.log('🔍 Requiere cambio de contraseña?:', userFirestoreData.requirePasswordChange);\r\n                  \r\n                  // Si needsAuthSync es true, intentar sincronizar\r\n                  if (userFirestoreData.needsAuthSync === true) {\r\n                    // Intentar sincronizar con Firebase Auth\r\n                    try {\r\n                      console.log('🔄 Intentando sincronizar con Firebase Auth...');\r\n                      await createUserWithEmailAndPassword(auth, normalizedEmail, password);\r\n                      console.log('✅ Usuario sincronizado con Firebase Auth');\r\n                      \r\n                      const firebaseUser = auth.currentUser;\r\n                      if (firebaseUser && firebaseUser.uid !== userDocId) {\r\n                        // Migrar datos al nuevo UID de Firebase\r\n                        console.log('🔄 Migrando datos al UID de Firebase Auth...');\r\n                        \r\n                        // Crear nuevo documento con el UID de Firebase\r\n                        await setDoc(doc(firestore, 'users', firebaseUser.uid), {\r\n                          ...userFirestoreData,\r\n                          tempPassword: null, // Limpiar contraseña temporal\r\n                          needsAuthSync: false,\r\n                          authPasswordSynced: true,\r\n                          requirePasswordChange: false,\r\n                          lastLogin: new Date().toISOString()\r\n                        });\r\n                        \r\n                        // Cerrar sesión y usar el nuevo UID para el login\r\n                        await signOut(auth);\r\n                        \r\n                        onLogin({\r\n                          uid: firebaseUser.uid,\r\n                          email: userFirestoreData.email,\r\n                          role: userFirestoreData.role,\r\n                          name: userFirestoreData.name,\r\n                          ...userFirestoreData,\r\n                          requirePasswordChange: false\r\n                        });\r\n                      } else {\r\n                        // Limpiar flags de sincronización\r\n                        await updateDoc(doc(firestore, 'users', userDocId), {\r\n                          tempPassword: null, // Limpiar contraseña temporal ya sincronizada\r\n                          needsAuthSync: false,\r\n                          authPasswordSynced: true,\r\n                          requirePasswordChange: false,\r\n                          lastLogin: new Date().toISOString()\r\n                        });\r\n                        \r\n                        // Cerrar sesión\r\n                        if (auth.currentUser) {\r\n                          await signOut(auth);\r\n                        }\r\n                        \r\n                        // Login exitoso\r\n                        onLogin({\r\n                          uid: userDocId,\r\n                          email: userFirestoreData.email,\r\n                          role: userFirestoreData.role,\r\n                          name: userFirestoreData.name,\r\n                          ...userFirestoreData,\r\n                          requirePasswordChange: false\r\n                        });\r\n                      }\r\n                    } catch (syncError) {\r\n                      console.log('⚠️ No se pudo sincronizar con Auth:', syncError.code);\r\n                      \r\n                      if (syncError.code === 'auth/email-already-in-use') {\r\n                        // El usuario ya existe en Auth, continuar sin sincronizar\r\n                        console.log('ℹ️ Usuario ya existe en Auth, continuando con Firestore...');\r\n                      }\r\n                      \r\n                      // Actualizar última conexión\r\n                      await updateDoc(doc(firestore, 'users', userDocId), {\r\n                        lastLogin: new Date().toISOString()\r\n                      });\r\n                      \r\n                      // Login exitoso con Firestore\r\n                      onLogin({\r\n                        uid: userDocId,\r\n                        email: userFirestoreData.email,\r\n                        role: userFirestoreData.role,\r\n                        name: userFirestoreData.name,\r\n                        ...userFirestoreData,\r\n                        requirePasswordChange: false\r\n                      });\r\n                    }\r\n                  } else {\r\n                    // No necesita sincronización, login directo\r\n                    await updateDoc(doc(firestore, 'users', userDocId), {\r\n                      lastLogin: new Date().toISOString()\r\n                    });\r\n                    \r\n                    onLogin({\r\n                      uid: userDocId,\r\n                      email: userFirestoreData.email,\r\n                      role: userFirestoreData.role,\r\n                      name: userFirestoreData.name,\r\n                      ...userFirestoreData,\r\n                      requirePasswordChange: false\r\n                    });\r\n                  }\r\n                  \r\n                  setLoading(false);\r\n                  return;\r\n                }\r\n              } catch (e) {\r\n                console.log('Error verificando contraseña de fallback:', e);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        \r\n        // Si llegamos aquí, el login falló completamente\r\n        throw authError;\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error al iniciar sesión:', error);\r\n      console.error('Código de error:', error.code);\r\n      console.error('Mensaje:', error.message);\r\n\r\n      // Mensajes de error en español\r\n      switch (error.code) {\r\n        case 'auth/user-not-found':\r\n          setError('Usuario no encontrado. Verifica tu email');\r\n          break;\r\n        case 'auth/wrong-password':\r\n          setError('Contraseña incorrecta');\r\n          break;\r\n        case 'auth/invalid-email':\r\n          setError('Email inválido');\r\n          break;\r\n        case 'auth/too-many-requests':\r\n          setError('Demasiados intentos. Intenta más tarde');\r\n          break;\r\n        case 'auth/invalid-credential':\r\n          setError('Credenciales inválidas. Verifica tu email y contraseña');\r\n          break;\r\n        case 'auth/network-request-failed':\r\n          setError('Error de conexión. Verifica tu internet');\r\n          break;\r\n        default:\r\n          setError('Error al iniciar sesión. Intenta nuevamente');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleChangePassword = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Validaciones\r\n    if (newPassword.length < 6) {\r\n      setError('La contraseña debe tener al menos 6 caracteres');\r\n      return;\r\n    }\r\n\r\n    if (newPassword !== confirmPassword) {\r\n      setError('Las contraseñas no coinciden');\r\n      return;\r\n    }\r\n\r\n    if (newPassword === oldPassword) {\r\n      setError('La nueva contraseña debe ser diferente a la anterior');\r\n      return;\r\n    }\r\n\r\n    // Validación adicional de seguridad\r\n    const hasNumber = /\\d/.test(newPassword);\r\n    const hasLetter = /[a-zA-Z]/.test(newPassword);\r\n    \r\n    if (!hasNumber || !hasLetter) {\r\n      setError('La contraseña debe contener al menos una letra y un número');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      // Verificar si es un login con contraseña temporal\r\n      if (currentUser.isTempPasswordLogin) {\r\n        console.log('🔄 Actualizando desde contraseña temporal...');\r\n        \r\n        let authUpdated = false;\r\n        \r\n        // ESTRATEGIA MEJORADA: Intentar múltiples métodos para actualizar en Firebase Auth\r\n        \r\n        // Método 1: Intentar crear el usuario nuevo\r\n        try {\r\n          await createUserWithEmailAndPassword(auth, currentUser.email, newPassword);\r\n          console.log('✅ Usuario creado en Firebase Auth con nueva contraseña');\r\n          authUpdated = true;\r\n          \r\n          // Si se creó exitosamente, obtener el UID real de Firebase Auth\r\n          const firebaseUser = auth.currentUser;\r\n          if (firebaseUser) {\r\n            // Actualizar el UID en Firestore si es diferente\r\n            if (currentUser.uid !== firebaseUser.uid) {\r\n              console.log('🔄 Migrando datos al nuevo UID en Firestore...');\r\n              // Copiar datos del documento antiguo al nuevo\r\n              const oldUserDoc = await getDoc(doc(firestore, 'users', currentUser.uid));\r\n              const oldUserData = oldUserDoc.exists() ? oldUserDoc.data() : {};\r\n              \r\n              // Crear o actualizar el documento con el nuevo UID\r\n              await setDoc(doc(firestore, 'users', firebaseUser.uid), {\r\n                ...oldUserData,\r\n                email: currentUser.email,\r\n                requirePasswordChange: false,\r\n                firstLogin: false,\r\n                passwordChangedAt: new Date().toISOString(),\r\n                tempPassword: null,\r\n                lastTempPassword: null,\r\n                resetMethod: null,\r\n                authPasswordSynced: true\r\n              });\r\n              \r\n              // Actualizar el currentUser con el nuevo UID\r\n              currentUser.uid = firebaseUser.uid;\r\n            } else {\r\n              // Si el UID es el mismo, solo actualizar\r\n              await updateDoc(doc(firestore, 'users', currentUser.uid), {\r\n                requirePasswordChange: false,\r\n                firstLogin: false,\r\n                passwordChangedAt: new Date().toISOString(),\r\n                tempPassword: null,\r\n                lastTempPassword: null,\r\n                resetMethod: null,\r\n                authPasswordSynced: true\r\n              });\r\n            }\r\n            \r\n            // Cerrar sesión para hacer un login limpio después\r\n            await signOut(auth);\r\n          }\r\n        } catch (createError) {\r\n          console.log('❌ No se pudo crear usuario:', createError.code);\r\n          \r\n          if (createError.code === 'auth/email-already-in-use') {\r\n            // Método 2: El usuario existe, intentar múltiples formas de actualizar\r\n            \r\n            // Método 2a: Intentar con la última contraseña temporal conocida\r\n            if (currentUser.lastTempPassword) {\r\n              try {\r\n                const lastTemp = atob(currentUser.lastTempPassword);\r\n                await signInWithEmailAndPassword(auth, currentUser.email, lastTemp);\r\n                await updatePassword(auth.currentUser, newPassword);\r\n                console.log('✅ Contraseña actualizada usando última temporal');\r\n                authUpdated = true;\r\n                // Cerrar sesión para hacer un login limpio después\r\n                await signOut(auth);\r\n              } catch (e) {\r\n                console.log('❌ No funcionó con última temporal');\r\n              }\r\n            }\r\n            \r\n            // Método 2b: Intentar con la contraseña temporal actual\r\n            if (!authUpdated) {\r\n              try {\r\n                await signInWithEmailAndPassword(auth, currentUser.email, oldPassword);\r\n                await updatePassword(auth.currentUser, newPassword);\r\n                console.log('✅ Contraseña actualizada con temporal actual');\r\n                authUpdated = true;\r\n                // Cerrar sesión para hacer un login limpio después\r\n                await signOut(auth);\r\n              } catch (e) {\r\n                console.log('❌ No funcionó con temporal actual');\r\n              }\r\n            }\r\n            \r\n            // Método 2c: Si nada funcionó, guardar la nueva contraseña como temporal en Firestore\r\n            if (!authUpdated) {\r\n              console.log('⚠️ Guardando nueva contraseña en Firestore como fallback');\r\n              \r\n              // IMPORTANTE: Marcar requirePasswordChange como FALSE para evitar el ciclo\r\n              await updateDoc(doc(firestore, 'users', currentUser.uid), {\r\n                tempPassword: btoa(newPassword),\r\n                requirePasswordChange: false, // IMPORTANTE: false para evitar ciclo\r\n                firstLogin: false,\r\n                passwordChangedAt: new Date().toISOString(),\r\n                lastTempPassword: btoa(oldPassword),\r\n                resetMethod: 'FALLBACK_FIRESTORE',\r\n                authPasswordSynced: false,\r\n                needsAuthSync: true\r\n              });\r\n              \r\n              console.log('✅ Contraseña guardada en Firestore');\r\n              setSuccessMessage('✅ Contraseña actualizada correctamente. La página se recargará en 3 segundos...');\r\n              \r\n              // Esperar y recargar la página\r\n              setTimeout(() => {\r\n                console.log('🔄 Recargando página para aplicar cambios...');\r\n                window.location.reload();\r\n              }, 3000);\r\n              \r\n              return; // Salir aquí para usar el flujo especial\r\n            }\r\n          } else {\r\n            throw createError;\r\n          }\r\n        }\r\n\r\n        // Si llegamos aquí, la contraseña se actualizó en Auth exitosamente\r\n        if (authUpdated) {\r\n          // Verificar si el documento existe en Firestore antes de actualizar\r\n          const userDocRef = doc(firestore, 'users', currentUser.uid);\r\n          const userDocSnap = await getDoc(userDocRef);\r\n          \r\n          if (userDocSnap.exists()) {\r\n            // Actualizar en Firestore (limpiar campos temporales)\r\n            await updateDoc(userDocRef, {\r\n              requirePasswordChange: false,\r\n              firstLogin: false,\r\n              passwordChangedAt: new Date().toISOString(),\r\n              tempPassword: null,\r\n              lastTempPassword: null,\r\n              resetMethod: null,\r\n              authPasswordSynced: true,\r\n              needsAuthSync: false\r\n            });\r\n          } else {\r\n            // Si no existe, crear el documento\r\n            await setDoc(userDocRef, {\r\n              email: currentUser.email,\r\n              role: currentUser.role || 'worker',\r\n              name: currentUser.name || '',\r\n              requirePasswordChange: false,\r\n              firstLogin: false,\r\n              passwordChangedAt: new Date().toISOString(),\r\n              tempPassword: null,\r\n              lastTempPassword: null,\r\n              resetMethod: null,\r\n              authPasswordSynced: true,\r\n              needsAuthSync: false\r\n            });\r\n          }\r\n\r\n          setSuccessMessage('✅ Contraseña actualizada exitosamente');\r\n          \r\n          // Hacer login automático con la nueva contraseña\r\n          setTimeout(async () => {\r\n            try {\r\n              // Asegurar que no hay sesión activa\r\n              if (auth.currentUser) {\r\n                console.log('⚠️ Cerrando sesión activa antes de auto-login...');\r\n                await signOut(auth);\r\n                // Esperar un momento para asegurar que se cerró la sesión\r\n                await new Promise(resolve => setTimeout(resolve, 500));\r\n              }\r\n              \r\n              console.log('🔐 Intentando auto-login con nueva contraseña...');\r\n              \r\n              // Iniciar sesión con la nueva contraseña\r\n              const userCredential = await signInWithEmailAndPassword(auth, currentUser.email, newPassword);\r\n              const user = userCredential.user;\r\n              \r\n              console.log('✅ Auto-login exitoso, UID:', user.uid);\r\n              \r\n              // Obtener datos actualizados de Firestore con el UID correcto\r\n              const userDocRef = doc(firestore, 'users', user.uid);\r\n              const userDocSnap = await getDoc(userDocRef);\r\n              \r\n              if (userDocSnap.exists()) {\r\n                const userData = userDocSnap.data();\r\n                onLogin({\r\n                  uid: user.uid,\r\n                  email: user.email,\r\n                  role: userData.role,\r\n                  name: userData.name,\r\n                  ...userData,\r\n                  requirePasswordChange: false,\r\n                  firstLogin: false,\r\n                  isTempPasswordLogin: false\r\n                });\r\n              } else {\r\n                // Si no existe con el UID de Auth, usar los datos que tenemos\r\n                onLogin({\r\n                  ...currentUser,\r\n                  uid: user.uid,\r\n                  requirePasswordChange: false,\r\n                  firstLogin: false,\r\n                  isTempPasswordLogin: false\r\n                });\r\n              }\r\n            } catch (error) {\r\n              console.log('❌ Error en auto-login:', error.code, error.message);\r\n              // Si falla el auto-login, continuar de todos modos\r\n              onLogin({\r\n                ...currentUser,\r\n                requirePasswordChange: false,\r\n                firstLogin: false,\r\n                isTempPasswordLogin: false\r\n              });\r\n            }\r\n          }, 2000); // Aumentar el tiempo de espera\r\n        }\r\n        \r\n      } else {\r\n        // Usuario autenticado normalmente con Firebase Auth\r\n        const user = auth.currentUser;\r\n\r\n        if (user) {\r\n          // Actualizar contraseña en Firebase Auth\r\n          await updatePassword(user, newPassword);\r\n\r\n          // Actualizar en Firestore\r\n          await updateDoc(doc(firestore, 'users', user.uid), {\r\n            requirePasswordChange: false,\r\n            firstLogin: false,\r\n            passwordChangedAt: new Date().toISOString(),\r\n            tempPassword: null,\r\n            lastTempPassword: null,\r\n            resetMethod: null\r\n          });\r\n\r\n          setSuccessMessage('✅ Contraseña actualizada exitosamente');\r\n          \r\n          // Esperar un momento antes de continuar\r\n          setTimeout(() => {\r\n            onLogin({\r\n              ...currentUser,\r\n              requirePasswordChange: false,\r\n              firstLogin: false\r\n            });\r\n          }, 2000);\r\n        } else {\r\n          setError('Error de autenticación. Por favor, vuelve a iniciar sesión');\r\n        }\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Error al cambiar contraseña:', error);\r\n\r\n      switch (error.code) {\r\n        case 'auth/weak-password':\r\n          setError('La contraseña es muy débil. Usa al menos 6 caracteres con letras y números');\r\n          break;\r\n        case 'auth/requires-recent-login':\r\n          setError('Por seguridad, vuelve a iniciar sesión');\r\n          break;\r\n        case 'auth/network-request-failed':\r\n          setError('Error de conexión. Verifica tu internet');\r\n          break;\r\n        default:\r\n          setError('Error al cambiar la contraseña. Intenta nuevamente');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Formulario de cambio de contraseña obligatorio\r\n  if (showChangePassword) {\r\n    return (\r\n      <div style={{\r\n        width: '100%',\r\n        height: '100vh',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n        fontFamily: 'Arial, sans-serif'\r\n      }}>\r\n        <div style={{\r\n          background: 'white',\r\n          padding: '40px',\r\n          borderRadius: '20px',\r\n          boxShadow: '0 20px 40px rgba(0,0,0,0.1)',\r\n          maxWidth: '400px',\r\n          width: '90%'\r\n        }}>\r\n          <div style={{ textAlign: 'center', marginBottom: '30px' }}>\r\n            <div style={{ fontSize: '48px', marginBottom: '10px' }}>🔐</div>\r\n            <h2 style={{\r\n              color: '#1f2937',\r\n              margin: '0 0 10px 0',\r\n              fontSize: '24px',\r\n              fontWeight: '700'\r\n            }}>\r\n              Cambio de Contraseña Obligatorio\r\n            </h2>\r\n            <p style={{\r\n              color: '#6b7280',\r\n              margin: 0,\r\n              fontSize: '14px'\r\n            }}>\r\n              Por seguridad, debes cambiar tu contraseña temporal\r\n            </p>\r\n          </div>\r\n\r\n          <form onSubmit={handleChangePassword}>\r\n            <div style={{ marginBottom: '20px' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                marginBottom: '8px',\r\n                color: '#374151',\r\n                fontSize: '14px',\r\n                fontWeight: '500'\r\n              }}>\r\n                Nueva Contraseña\r\n              </label>\r\n              <input\r\n                type=\"password\"\r\n                value={newPassword}\r\n                onChange={(e) => setNewPassword(e.target.value)}\r\n                required\r\n                placeholder=\"Mínimo 6 caracteres con letras y números\"\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '12px',\r\n                  border: '1px solid #d1d5db',\r\n                  borderRadius: '8px',\r\n                  fontSize: '14px',\r\n                  outline: 'none',\r\n                  transition: 'border-color 0.2s'\r\n                }}\r\n                onFocus={(e) => e.target.style.borderColor = '#667eea'}\r\n                onBlur={(e) => e.target.style.borderColor = '#d1d5db'}\r\n              />\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '24px' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                marginBottom: '8px',\r\n                color: '#374151',\r\n                fontSize: '14px',\r\n                fontWeight: '500'\r\n              }}>\r\n                Confirmar Nueva Contraseña\r\n              </label>\r\n              <input\r\n                type=\"password\"\r\n                value={confirmPassword}\r\n                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                required\r\n                placeholder=\"Repite la contraseña\"\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '12px',\r\n                  border: '1px solid #d1d5db',\r\n                  borderRadius: '8px',\r\n                  fontSize: '14px',\r\n                  outline: 'none',\r\n                  transition: 'border-color 0.2s'\r\n                }}\r\n                onFocus={(e) => e.target.style.borderColor = '#667eea'}\r\n                onBlur={(e) => e.target.style.borderColor = '#d1d5db'}\r\n              />\r\n            </div>\r\n\r\n            {/* Requisitos de contraseña */}\r\n            <div style={{\r\n              marginBottom: '20px',\r\n              padding: '12px',\r\n              background: '#f3f4f6',\r\n              borderRadius: '6px',\r\n              fontSize: '12px',\r\n              color: '#6b7280'\r\n            }}>\r\n              <strong>Requisitos de la contraseña:</strong>\r\n              <ul style={{ margin: '5px 0 0 0', paddingLeft: '20px' }}>\r\n                <li>Mínimo 6 caracteres</li>\r\n                <li>Al menos una letra</li>\r\n                <li>Al menos un número</li>\r\n                <li>Diferente a la contraseña anterior</li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Mensajes */}\r\n            {error && (\r\n              <div style={{\r\n                background: '#fef2f2',\r\n                border: '1px solid #fecaca',\r\n                color: '#dc2626',\r\n                padding: '10px',\r\n                borderRadius: '6px',\r\n                marginBottom: '20px',\r\n                fontSize: '14px',\r\n                textAlign: 'center'\r\n              }}>\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {successMessage && (\r\n              <div style={{\r\n                background: '#dcfce7',\r\n                border: '1px solid #86efac',\r\n                color: '#166534',\r\n                padding: '10px',\r\n                borderRadius: '6px',\r\n                marginBottom: '20px',\r\n                fontSize: '14px',\r\n                textAlign: 'center'\r\n              }}>\r\n                {successMessage}\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              style={{\r\n                width: '100%',\r\n                padding: '14px',\r\n                background: loading ? '#9ca3af' : 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '8px',\r\n                fontSize: '16px',\r\n                fontWeight: '600',\r\n                cursor: loading ? 'not-allowed' : 'pointer',\r\n                transition: 'transform 0.2s',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                gap: '8px'\r\n              }}\r\n            >\r\n              {loading ? (\r\n                <>\r\n                  <span className=\"spinner\"></span>\r\n                  Actualizando...\r\n                </>\r\n              ) : (\r\n                '✅ Cambiar Contraseña'\r\n              )}\r\n            </button>\r\n          </form>\r\n        </div>\r\n\r\n        <style>{`\r\n          .spinner {\r\n            width: 16px;\r\n            height: 16px;\r\n            border: 2px solid #ffffff;\r\n            border-top-color: transparent;\r\n            border-radius: 50%;\r\n            animation: spin 0.6s linear infinite;\r\n          }\r\n          \r\n          @keyframes spin {\r\n            0% { transform: rotate(0deg); }\r\n            100% { transform: rotate(360deg); }\r\n          }\r\n        `}</style>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Formulario de login principal\r\n  return (\r\n    <div style={{\r\n      width: '100%',\r\n      height: '100vh',\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n      fontFamily: 'Arial, sans-serif'\r\n    }}>\r\n      <div style={{\r\n        background: 'white',\r\n        padding: '40px',\r\n        borderRadius: '20px',\r\n        boxShadow: '0 20px 40px rgba(0,0,0,0.1)',\r\n        maxWidth: '400px',\r\n        width: '90%'\r\n      }}>\r\n        {/* Logo y título */}\r\n        <div style={{ textAlign: 'center', marginBottom: '30px' }}>\r\n          <div style={{ fontSize: '48px', marginBottom: '10px' }}>🗺️</div>\r\n          <h1 style={{\r\n            color: '#1f2937',\r\n            margin: '0 0 10px 0',\r\n            fontSize: '28px',\r\n            fontWeight: '700'\r\n          }}>\r\n            MapaQuillón\r\n          </h1>\r\n          <p style={{\r\n            color: '#6b7280',\r\n            margin: 0,\r\n            fontSize: '14px'\r\n          }}>\r\n            Sistema de Control de Flota<br />\r\n            Municipalidad de Quillón\r\n          </p>\r\n        </div>\r\n\r\n        {/* Formulario */}\r\n        <form onSubmit={handleLogin}>\r\n          <div style={{ marginBottom: '20px' }}>\r\n            <label style={{\r\n              display: 'block',\r\n              marginBottom: '8px',\r\n              color: '#374151',\r\n              fontSize: '14px',\r\n              fontWeight: '500'\r\n            }}>\r\n              Correo Electrónico\r\n            </label>\r\n            <input\r\n              type=\"email\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              required\r\n              placeholder=\"ejemplo@gmail.com\"\r\n              style={{\r\n                width: '100%',\r\n                padding: '12px',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '8px',\r\n                fontSize: '14px',\r\n                outline: 'none',\r\n                transition: 'border-color 0.2s'\r\n              }}\r\n              onFocus={(e) => e.target.style.borderColor = '#667eea'}\r\n              onBlur={(e) => e.target.style.borderColor = '#d1d5db'}\r\n            />\r\n          </div>\r\n\r\n          <div style={{ marginBottom: '12px' }}>\r\n            <label style={{\r\n              display: 'block',\r\n              marginBottom: '8px',\r\n              color: '#374151',\r\n              fontSize: '14px',\r\n              fontWeight: '500'\r\n            }}>\r\n              Contraseña\r\n            </label>\r\n            <input\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              required\r\n              placeholder=\"••••••••\"\r\n              style={{\r\n                width: '100%',\r\n                padding: '12px',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '8px',\r\n                fontSize: '14px',\r\n                outline: 'none',\r\n                transition: 'border-color 0.2s'\r\n              }}\r\n              onFocus={(e) => e.target.style.borderColor = '#667eea'}\r\n              onBlur={(e) => e.target.style.borderColor = '#d1d5db'}\r\n            />\r\n          </div>\r\n\r\n          {/* Mensajes */}\r\n          {error && (\r\n            <div style={{\r\n              background: '#fef2f2',\r\n              border: '1px solid #fecaca',\r\n              color: '#dc2626',\r\n              padding: '10px',\r\n              borderRadius: '6px',\r\n              marginBottom: '20px',\r\n              fontSize: '14px',\r\n              textAlign: 'center'\r\n            }}>\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          {successMessage && (\r\n            <div style={{\r\n              background: '#dcfce7',\r\n              border: '1px solid #86efac',\r\n              color: '#166534',\r\n              padding: '10px',\r\n              borderRadius: '6px',\r\n              marginBottom: '20px',\r\n              fontSize: '14px',\r\n              textAlign: 'center'\r\n            }}>\r\n              {successMessage}\r\n            </div>\r\n          )}\r\n\r\n          {/* Botón de login */}\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            style={{\r\n              width: '100%',\r\n              padding: '14px',\r\n              background: loading ? '#9ca3af' : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '16px',\r\n              fontWeight: '600',\r\n              cursor: loading ? 'not-allowed' : 'pointer',\r\n              transition: 'transform 0.2s',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gap: '8px'\r\n            }}\r\n            onMouseOver={(e) => !loading && (e.currentTarget.style.transform = 'translateY(-2px)')}\r\n            onMouseOut={(e) => e.currentTarget.style.transform = 'translateY(0px)'}\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <span className=\"spinner\"></span>\r\n                Iniciando sesión...\r\n              </>\r\n            ) : (\r\n              'Iniciar Sesión'\r\n            )}\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setShowPasswordRecovery(true)}\r\n            style={{\r\n              width: '100%',\r\n              padding: '12px',\r\n              background: 'transparent',\r\n              color: '#3b82f6',\r\n              border: '1px solid #3b82f6',\r\n              borderRadius: '8px',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              marginTop: '10px'\r\n            }}\r\n          >\r\n            🔓 ¿Olvidaste tu contraseña?\r\n          </button>\r\n\r\n          {/* Modal de recuperación de contraseña */}\r\n          {showPasswordRecovery && (\r\n            <PasswordRecovery\r\n              onClose={() => setShowPasswordRecovery(false)}\r\n              onSuccess={() => {\r\n                setShowPasswordRecovery(false);\r\n                setSuccessMessage('✅ Ya puedes iniciar sesión con tu contraseña temporal');\r\n                setTimeout(() => setSuccessMessage(''), 5000);\r\n              }}\r\n            />\r\n          )}\r\n        </form>\r\n\r\n        {/* Información de contacto */}\r\n        <div style={{\r\n          marginTop: '30px',\r\n          padding: '15px',\r\n          background: '#f9fafb',\r\n          borderRadius: '8px',\r\n          fontSize: '12px',\r\n          color: '#6b7280',\r\n          textAlign: 'center'\r\n        }}>\r\n          <strong>¿Necesitas ayuda?</strong><br />\r\n          Contacta al administrador del sistema<br />\r\n          📞 +56 9 1234 5678\r\n        </div>\r\n      </div>\r\n\r\n      <style>{`\r\n        .spinner {\r\n          width: 16px;\r\n          height: 16px;\r\n          border: 2px solid #ffffff;\r\n          border-top-color: transparent;\r\n          border-radius: 50%;\r\n          animation: spin 0.6s linear infinite;\r\n          display: inline-block;\r\n        }\r\n        \r\n        @keyframes spin {\r\n          0% { transform: rotate(0deg); }\r\n          100% { transform: rotate(360deg); }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}