{"ast":null,"code":"// src/components/TrabajadorVehiclePanel.js\nimport React,{useState,useEffect}from'react';import{vehiculosService,trabajadoresService}from'../services/firebaseservices';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TrabajadorVehiclePanel=_ref=>{let{currentUser,onClose}=_ref;const[vehiculoAsignado,setVehiculoAsignado]=useState(null);const[loading,setLoading]=useState(false);const[loadingVehiculo,setLoadingVehiculo]=useState(true);// NUEVO: Estado de carga inicial\nconst[message,setMessage]=useState(null);const[trabajadorData,setTrabajadorData]=useState(null);// Estados del formulario de viaje\nconst[formViaje,setFormViaje]=useState({fechaSalida:new Date().toISOString().split('T')[0],// Fecha de hoy\nhoraSalida:new Date().toLocaleTimeString('es-CL',{hour:'2-digit',minute:'2-digit'}),kilometrajeSalida:'',destino:'',motivoViaje:'trabajo',// trabajo, emergencia, mantenimiento\nobservaciones:''});// Estado para el viaje activo\nconst[viajeActivo,setViajeActivo]=useState(null);// Cargar datos del trabajador y su vehículo\nuseEffect(()=>{const loadData=async()=>{setLoadingVehiculo(true);// Indicar que estamos cargando\ntry{let trabajadorInfo=null;// Cargar datos del trabajador primero\nconst unsubscribeTrabajador=trabajadoresService.getTrabajadorById(currentUser.uid,data=>{trabajadorInfo=data;setTrabajadorData(data);if(data!==null&&data!==void 0&&data.viajeActivo){setViajeActivo(data.viajeActivo);}});// Esperar un poco para asegurar que los datos del trabajador se carguen\nawait new Promise(resolve=>setTimeout(resolve,500));// Cargar vehículos y buscar el asignado\nconst unsubscribeVehiculos=vehiculosService.subscribeToVehiculos(vehiculosData=>{var _trabajadorInfo;// Buscar vehículo asignado por diferentes campos posibles\nlet vehiculoEncontrado=null;// Primera prioridad: buscar por asignación directa\nvehiculoEncontrado=vehiculosData.find(v=>v.asignadoA===currentUser.uid||v.operadorAsignado===currentUser.uid||v.trabajadorAsignado===currentUser.uid);// Segunda prioridad: buscar por ID del vehículo en datos del trabajador\nif(!vehiculoEncontrado&&(_trabajadorInfo=trabajadorInfo)!==null&&_trabajadorInfo!==void 0&&_trabajadorInfo.vehiculoAsignado){vehiculoEncontrado=vehiculosData.find(v=>v.id===trabajadorInfo.vehiculoAsignado);}// Tercera prioridad: buscar por vehicleId del usuario\nif(!vehiculoEncontrado&&currentUser.vehicleId){vehiculoEncontrado=vehiculosData.find(v=>v.id===currentUser.vehicleId);}// Establecer el vehículo encontrado (o null si no hay)\nif(vehiculoEncontrado){setVehiculoAsignado(vehiculoEncontrado);setFormViaje(prev=>{var _vehiculoEncontrado$k;return{...prev,kilometrajeSalida:((_vehiculoEncontrado$k=vehiculoEncontrado.kilometraje)===null||_vehiculoEncontrado$k===void 0?void 0:_vehiculoEncontrado$k.toString())||''};});}else{setVehiculoAsignado(null);// Explícitamente establecer null si no hay vehículo\n}setLoadingVehiculo(false);// Terminó la carga\n});return()=>{unsubscribeTrabajador();unsubscribeVehiculos();};}catch(error){console.error('Error al cargar datos:',error);setMessage({type:'error',text:'❌ Error al cargar información'});setLoadingVehiculo(false);}};loadData();},[currentUser.uid]);// Removí la dependencia problemática\n// Iniciar viaje\nconst handleIniciarViaje=async()=>{// Validaciones\nif(!formViaje.destino){setMessage({type:'error',text:'⚠️ Debes indicar el destino'});return;}if(!formViaje.kilometrajeSalida){setMessage({type:'error',text:'⚠️ Debes indicar el kilometraje actual'});return;}setLoading(true);try{const viajeData={vehiculoId:vehiculoAsignado.id,vehiculoNombre:vehiculoAsignado.nombre,trabajadorId:currentUser.uid,trabajadorNombre:currentUser.name,fechaSalida:formViaje.fechaSalida,horaSalida:formViaje.horaSalida,kilometrajeSalida:parseInt(formViaje.kilometrajeSalida),destino:formViaje.destino,motivoViaje:formViaje.motivoViaje,observaciones:formViaje.observaciones,estado:'en_curso',iniciadoEn:new Date().toISOString()};// Actualizar estado del vehículo a \"en_uso\"\nawait vehiculosService.updateVehiculoEstado(vehiculoAsignado.id,'en_uso',{asignadoA:currentUser.uid,asignadoNombre:currentUser.name,destino:formViaje.destino,kilometrajeUltimoViaje:parseInt(formViaje.kilometrajeSalida),viajeActivo:viajeData});// Actualizar datos del trabajador con el viaje activo\nawait trabajadoresService.updateTrabajadorData(currentUser.uid,{viajeActivo:viajeData,estadoActual:'en_viaje',ultimoDestino:formViaje.destino});setViajeActivo(viajeData);setMessage({type:'success',text:'✅ Viaje iniciado exitosamente'});}catch(error){console.error('Error al iniciar viaje:',error);setMessage({type:'error',text:'❌ Error al iniciar el viaje'});}finally{setLoading(false);}};// Finalizar viaje\nconst handleFinalizarViaje=async()=>{const kilometrajeLlegada=prompt('Ingresa el kilometraje al finalizar el viaje:');if(!kilometrajeLlegada)return;setLoading(true);try{const horaLlegada=new Date().toLocaleTimeString('es-CL',{hour:'2-digit',minute:'2-digit'});const kmRecorridos=parseInt(kilometrajeLlegada)-viajeActivo.kilometrajeSalida;// Actualizar vehículo\nawait vehiculosService.updateVehiculoEstado(vehiculoAsignado.id,'disponible',{asignadoA:currentUser.uid,kilometraje:parseInt(kilometrajeLlegada),ultimoViaje:{...viajeActivo,fechaLlegada:new Date().toISOString().split('T')[0],horaLlegada:horaLlegada,kilometrajeLlegada:parseInt(kilometrajeLlegada),kilometrosRecorridos:kmRecorridos,estado:'finalizado'}});// Limpiar viaje activo del trabajador\nawait trabajadoresService.updateTrabajadorData(currentUser.uid,{viajeActivo:null,estadoActual:'disponible',ultimoViaje:{...viajeActivo,fechaLlegada:new Date().toISOString().split('T')[0],horaLlegada:horaLlegada,kilometrajeLlegada:parseInt(kilometrajeLlegada),kilometrosRecorridos:kmRecorridos}});setViajeActivo(null);setMessage({type:'success',text:`✅ Viaje finalizado. Recorriste ${kmRecorridos} km`});}catch(error){console.error('Error al finalizar viaje:',error);setMessage({type:'error',text:'❌ Error al finalizar el viaje'});}finally{setLoading(false);}};// Si está cargando, mostrar indicador de carga\nif(loadingVehiculo){return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:9999,padding:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',borderRadius:'12px',padding:'30px',maxWidth:'400px',width:'100%',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',marginBottom:'20px'},children:\"\\u23F3\"}),/*#__PURE__*/_jsx(\"h3\",{style:{color:'#1f2937',marginBottom:'10px'},children:\"Cargando informaci\\xF3n...\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#6b7280'},children:\"Verificando veh\\xEDculo asignado\"})]})});}// Si no hay vehículo asignado (después de cargar)\nif(!loadingVehiculo&&!vehiculoAsignado){return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:9999,padding:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',borderRadius:'12px',padding:'30px',maxWidth:'400px',width:'100%',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',marginBottom:'20px'},children:\"\\uD83D\\uDEAB\"}),/*#__PURE__*/_jsx(\"h3\",{style:{color:'#1f2937',marginBottom:'10px'},children:\"No tienes veh\\xEDculo asignado\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#6b7280',marginBottom:'20px'},children:\"Contacta con tu supervisor para que te asigne un veh\\xEDculo\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{padding:'10px 20px',background:'#6b7280',color:'white',border:'none',borderRadius:'8px',fontSize:'14px',cursor:'pointer'},children:\"Cerrar\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:9999,padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',borderRadius:'12px',width:'100%',maxWidth:'600px',maxHeight:'90vh',overflow:'auto',boxShadow:'0 10px 40px rgba(0,0,0,0.2)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px',borderBottom:'1px solid #e5e7eb',background:'linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)',borderRadius:'12px 12px 0 0',color:'white'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontSize:'24px',fontWeight:'600'},children:\"\\uD83D\\uDE9B Control de Veh\\xEDculo\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'5px 0 0 0',fontSize:'14px',opacity:0.9},children:viajeActivo?'Viaje en curso':'Registrar salida de vehículo'})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'rgba(255, 255, 255, 0.2)',border:'none',color:'white',padding:'8px',borderRadius:'6px',cursor:'pointer',fontSize:'18px'},children:\"\\u2716\"})]})}),message&&/*#__PURE__*/_jsx(\"div\",{style:{margin:'20px 20px 0',padding:'12px',borderRadius:'8px',background:message.type==='error'?'#fee2e2':'#d1fae5',color:message.type==='error'?'#dc2626':'#065f46',fontSize:'14px',fontWeight:'500'},children:message.text}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',background:'#f0f9ff',borderBottom:'1px solid #e5e7eb'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 15px 0',color:'#0c4a6e',fontSize:'16px',fontWeight:'600'},children:\"Veh\\xEDculo Asignado\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(2, 1fr)',gap:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#64748b'},children:\"Veh\\xEDculo:\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0',fontWeight:'600',color:'#0c4a6e'},children:vehiculoAsignado.nombre})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#64748b'},children:\"Patente:\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0',fontWeight:'600',color:'#0c4a6e'},children:vehiculoAsignado.patente||'Sin patente'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#64748b'},children:\"Marca/Modelo:\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'4px 0',fontWeight:'600',color:'#0c4a6e'},children:[vehiculoAsignado.marca,\" \",vehiculoAsignado.modelo]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#64748b'},children:\"Estado:\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0',fontWeight:'600'},children:/*#__PURE__*/_jsx(\"span\",{style:{padding:'4px 8px',borderRadius:'4px',fontSize:'12px',background:viajeActivo?'#fef3c7':'#dcfce7',color:viajeActivo?'#92400e':'#15803d'},children:viajeActivo?'🚗 En viaje':'✅ Disponible'})})]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:!viajeActivo?/*#__PURE__*/// Formulario para iniciar viaje\n_jsx(\"form\",{onSubmit:e=>{e.preventDefault();handleIniciarViaje();},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\uD83D\\uDCC5 Fecha de Salida\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formViaje.fechaSalida,onChange:e=>setFormViaje({...formViaje,fechaSalida:e.target.value}),style:{width:'100%',padding:'10px',border:'2px solid #e5e7eb',borderRadius:'8px',fontSize:'14px'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\u23F0 Hora de Salida\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:formViaje.horaSalida,onChange:e=>setFormViaje({...formViaje,horaSalida:e.target.value}),style:{width:'100%',padding:'10px',border:'2px solid #e5e7eb',borderRadius:'8px',fontSize:'14px'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\uD83D\\uDE97 Kilometraje Actual\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formViaje.kilometrajeSalida,onChange:e=>setFormViaje({...formViaje,kilometrajeSalida:e.target.value}),placeholder:\"Ej: 45000\",required:true,style:{width:'100%',padding:'10px',border:'2px solid #e5e7eb',borderRadius:'8px',fontSize:'14px'}}),/*#__PURE__*/_jsxs(\"small\",{style:{color:'#6b7280',fontSize:'12px'},children:[\"\\xDAltimo registro: \",vehiculoAsignado.kilometraje||0,\" km\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\uD83D\\uDCCD Destino\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formViaje.destino,onChange:e=>setFormViaje({...formViaje,destino:e.target.value}),placeholder:\"Ingresa el lugar de destino\",required:true,style:{width:'100%',padding:'10px',border:'2px solid #e5e7eb',borderRadius:'8px',fontSize:'14px'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\uD83D\\uDCCB Motivo del Viaje\"}),/*#__PURE__*/_jsxs(\"select\",{value:formViaje.motivoViaje,onChange:e=>setFormViaje({...formViaje,motivoViaje:e.target.value}),style:{width:'100%',padding:'10px',border:'2px solid #e5e7eb',borderRadius:'8px',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"trabajo\",children:\"Trabajo en terreno\"}),/*#__PURE__*/_jsx(\"option\",{value:\"emergencia\",children:\"Emergencia\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mantenimiento\",children:\"Mantenimiento\"}),/*#__PURE__*/_jsx(\"option\",{value:\"traslado\",children:\"Traslado de personal\"}),/*#__PURE__*/_jsx(\"option\",{value:\"carga\",children:\"Transporte de carga\"}),/*#__PURE__*/_jsx(\"option\",{value:\"otro\",children:\"Otro\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontSize:'14px',fontWeight:'500',color:'#374151'},children:\"\\uD83D\\uDCDD Observaciones (Opcional)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formViaje.observaciones,onChange:e=>setFormViaje({...formViaje,observaciones:e.target.value}),placeholder:\"Detalles adicionales del viaje...\",rows:3,style:{width:'100%',padding:'10px',border:'2px solid #e5e7eb',borderRadius:'8px',fontSize:'14px',resize:'none'}})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{padding:'14px',background:loading?'#9ca3af':'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'600',cursor:loading?'not-allowed':'pointer',display:'flex',alignItems:'center',justifyContent:'center',gap:'10px',transition:'transform 0.2s'},onMouseEnter:e=>!loading&&(e.currentTarget.style.transform='scale(1.02)'),onMouseLeave:e=>e.currentTarget.style.transform='scale(1)',children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{style:{width:'16px',height:'16px',border:'2px solid white',borderTop:'2px solid transparent',borderRadius:'50%',animation:'spin 1s linear infinite'}}),\"Iniciando...\"]}):/*#__PURE__*/_jsx(_Fragment,{children:\"\\uD83D\\uDE80 INICIAR VIAJE\"})})]})}):/*#__PURE__*/// Información del viaje activo\n_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',background:'#fef3c7',borderRadius:'8px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 15px 0',color:'#92400e',fontSize:'18px',fontWeight:'600'},children:\"\\uD83D\\uDE97 Viaje en Curso\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:'10px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'13px',color:'#92400e'},children:\"Destino:\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0',fontWeight:'600',fontSize:'15px'},children:viajeActivo.destino})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'13px',color:'#92400e'},children:\"Hora de salida:\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0',fontWeight:'600'},children:viajeActivo.horaSalida})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'13px',color:'#92400e'},children:\"Km de salida:\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'4px 0',fontWeight:'600'},children:[viajeActivo.kilometrajeSalida,\" km\"]})]})]}),viajeActivo.observaciones&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'13px',color:'#92400e'},children:\"Observaciones:\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0',fontSize:'14px'},children:viajeActivo.observaciones})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleFinalizarViaje,disabled:loading,style:{width:'100%',padding:'14px',background:loading?'#9ca3af':'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'600',cursor:loading?'not-allowed':'pointer',display:'flex',alignItems:'center',justifyContent:'center',gap:'10px'},children:loading?'Finalizando...':'🏁 FINALIZAR VIAJE'})]})})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `})]});};export default TrabajadorVehiclePanel;","map":{"version":3,"names":["React","useState","useEffect","vehiculosService","trabajadoresService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TrabajadorVehiclePanel","_ref","currentUser","onClose","vehiculoAsignado","setVehiculoAsignado","loading","setLoading","loadingVehiculo","setLoadingVehiculo","message","setMessage","trabajadorData","setTrabajadorData","formViaje","setFormViaje","fechaSalida","Date","toISOString","split","horaSalida","toLocaleTimeString","hour","minute","kilometrajeSalida","destino","motivoViaje","observaciones","viajeActivo","setViajeActivo","loadData","trabajadorInfo","unsubscribeTrabajador","getTrabajadorById","uid","data","Promise","resolve","setTimeout","unsubscribeVehiculos","subscribeToVehiculos","vehiculosData","_trabajadorInfo","vehiculoEncontrado","find","v","asignadoA","operadorAsignado","trabajadorAsignado","id","vehicleId","prev","_vehiculoEncontrado$k","kilometraje","toString","error","console","type","text","handleIniciarViaje","viajeData","vehiculoId","vehiculoNombre","nombre","trabajadorId","trabajadorNombre","name","parseInt","estado","iniciadoEn","updateVehiculoEstado","asignadoNombre","kilometrajeUltimoViaje","updateTrabajadorData","estadoActual","ultimoDestino","handleFinalizarViaje","kilometrajeLlegada","prompt","horaLlegada","kmRecorridos","ultimoViaje","fechaLlegada","kilometrosRecorridos","style","position","top","left","right","bottom","background","display","justifyContent","alignItems","zIndex","padding","children","borderRadius","maxWidth","width","textAlign","fontSize","marginBottom","color","onClick","border","cursor","maxHeight","overflow","boxShadow","borderBottom","margin","fontWeight","opacity","gridTemplateColumns","gap","patente","marca","modelo","onSubmit","e","preventDefault","value","onChange","target","placeholder","required","rows","resize","disabled","transition","onMouseEnter","currentTarget","transform","onMouseLeave","height","borderTop","animation"],"sources":["C:/Users/Izan/Desktop/AppReact/mapa-quillon/src/components/TrabajadorVehiclePanel.js"],"sourcesContent":["// src/components/TrabajadorVehiclePanel.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { vehiculosService, trabajadoresService } from '../services/firebaseservices';\r\n\r\nconst TrabajadorVehiclePanel = ({ currentUser, onClose }) => {\r\n  const [vehiculoAsignado, setVehiculoAsignado] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingVehiculo, setLoadingVehiculo] = useState(true); // NUEVO: Estado de carga inicial\r\n  const [message, setMessage] = useState(null);\r\n  const [trabajadorData, setTrabajadorData] = useState(null);\r\n  \r\n  // Estados del formulario de viaje\r\n  const [formViaje, setFormViaje] = useState({\r\n    fechaSalida: new Date().toISOString().split('T')[0], // Fecha de hoy\r\n    horaSalida: new Date().toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit' }),\r\n    kilometrajeSalida: '',\r\n    destino: '',\r\n    motivoViaje: 'trabajo', // trabajo, emergencia, mantenimiento\r\n    observaciones: ''\r\n  });\r\n\r\n  // Estado para el viaje activo\r\n  const [viajeActivo, setViajeActivo] = useState(null);\r\n\r\n  // Cargar datos del trabajador y su vehículo\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      setLoadingVehiculo(true); // Indicar que estamos cargando\r\n      \r\n      try {\r\n        let trabajadorInfo = null;\r\n        \r\n        // Cargar datos del trabajador primero\r\n        const unsubscribeTrabajador = trabajadoresService.getTrabajadorById(\r\n          currentUser.uid,\r\n          (data) => {\r\n            trabajadorInfo = data;\r\n            setTrabajadorData(data);\r\n            if (data?.viajeActivo) {\r\n              setViajeActivo(data.viajeActivo);\r\n            }\r\n          }\r\n        );\r\n\r\n        // Esperar un poco para asegurar que los datos del trabajador se carguen\r\n        await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n        // Cargar vehículos y buscar el asignado\r\n        const unsubscribeVehiculos = vehiculosService.subscribeToVehiculos((vehiculosData) => {\r\n          // Buscar vehículo asignado por diferentes campos posibles\r\n          let vehiculoEncontrado = null;\r\n          \r\n          // Primera prioridad: buscar por asignación directa\r\n          vehiculoEncontrado = vehiculosData.find(v => \r\n            v.asignadoA === currentUser.uid || \r\n            v.operadorAsignado === currentUser.uid ||\r\n            v.trabajadorAsignado === currentUser.uid\r\n          );\r\n          \r\n          // Segunda prioridad: buscar por ID del vehículo en datos del trabajador\r\n          if (!vehiculoEncontrado && trabajadorInfo?.vehiculoAsignado) {\r\n            vehiculoEncontrado = vehiculosData.find(v => v.id === trabajadorInfo.vehiculoAsignado);\r\n          }\r\n          \r\n          // Tercera prioridad: buscar por vehicleId del usuario\r\n          if (!vehiculoEncontrado && currentUser.vehicleId) {\r\n            vehiculoEncontrado = vehiculosData.find(v => v.id === currentUser.vehicleId);\r\n          }\r\n          \r\n          // Establecer el vehículo encontrado (o null si no hay)\r\n          if (vehiculoEncontrado) {\r\n            setVehiculoAsignado(vehiculoEncontrado);\r\n            setFormViaje(prev => ({\r\n              ...prev,\r\n              kilometrajeSalida: vehiculoEncontrado.kilometraje?.toString() || ''\r\n            }));\r\n          } else {\r\n            setVehiculoAsignado(null); // Explícitamente establecer null si no hay vehículo\r\n          }\r\n          \r\n          setLoadingVehiculo(false); // Terminó la carga\r\n        });\r\n\r\n        return () => {\r\n          unsubscribeTrabajador();\r\n          unsubscribeVehiculos();\r\n        };\r\n      } catch (error) {\r\n        console.error('Error al cargar datos:', error);\r\n        setMessage({\r\n          type: 'error',\r\n          text: '❌ Error al cargar información'\r\n        });\r\n        setLoadingVehiculo(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, [currentUser.uid]); // Removí la dependencia problemática\r\n\r\n  // Iniciar viaje\r\n  const handleIniciarViaje = async () => {\r\n    // Validaciones\r\n    if (!formViaje.destino) {\r\n      setMessage({ type: 'error', text: '⚠️ Debes indicar el destino' });\r\n      return;\r\n    }\r\n\r\n    if (!formViaje.kilometrajeSalida) {\r\n      setMessage({ type: 'error', text: '⚠️ Debes indicar el kilometraje actual' });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const viajeData = {\r\n        vehiculoId: vehiculoAsignado.id,\r\n        vehiculoNombre: vehiculoAsignado.nombre,\r\n        trabajadorId: currentUser.uid,\r\n        trabajadorNombre: currentUser.name,\r\n        fechaSalida: formViaje.fechaSalida,\r\n        horaSalida: formViaje.horaSalida,\r\n        kilometrajeSalida: parseInt(formViaje.kilometrajeSalida),\r\n        destino: formViaje.destino,\r\n        motivoViaje: formViaje.motivoViaje,\r\n        observaciones: formViaje.observaciones,\r\n        estado: 'en_curso',\r\n        iniciadoEn: new Date().toISOString()\r\n      };\r\n\r\n      // Actualizar estado del vehículo a \"en_uso\"\r\n      await vehiculosService.updateVehiculoEstado(vehiculoAsignado.id, 'en_uso', {\r\n        asignadoA: currentUser.uid,\r\n        asignadoNombre: currentUser.name,\r\n        destino: formViaje.destino,\r\n        kilometrajeUltimoViaje: parseInt(formViaje.kilometrajeSalida),\r\n        viajeActivo: viajeData\r\n      });\r\n\r\n      // Actualizar datos del trabajador con el viaje activo\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        viajeActivo: viajeData,\r\n        estadoActual: 'en_viaje',\r\n        ultimoDestino: formViaje.destino\r\n      });\r\n\r\n      setViajeActivo(viajeData);\r\n      setMessage({\r\n        type: 'success',\r\n        text: '✅ Viaje iniciado exitosamente'\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('Error al iniciar viaje:', error);\r\n      setMessage({\r\n        type: 'error',\r\n        text: '❌ Error al iniciar el viaje'\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Finalizar viaje\r\n  const handleFinalizarViaje = async () => {\r\n    const kilometrajeLlegada = prompt('Ingresa el kilometraje al finalizar el viaje:');\r\n    if (!kilometrajeLlegada) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const horaLlegada = new Date().toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit' });\r\n      const kmRecorridos = parseInt(kilometrajeLlegada) - viajeActivo.kilometrajeSalida;\r\n\r\n      // Actualizar vehículo\r\n      await vehiculosService.updateVehiculoEstado(vehiculoAsignado.id, 'disponible', {\r\n        asignadoA: currentUser.uid,\r\n        kilometraje: parseInt(kilometrajeLlegada),\r\n        ultimoViaje: {\r\n          ...viajeActivo,\r\n          fechaLlegada: new Date().toISOString().split('T')[0],\r\n          horaLlegada: horaLlegada,\r\n          kilometrajeLlegada: parseInt(kilometrajeLlegada),\r\n          kilometrosRecorridos: kmRecorridos,\r\n          estado: 'finalizado'\r\n        }\r\n      });\r\n\r\n      // Limpiar viaje activo del trabajador\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        viajeActivo: null,\r\n        estadoActual: 'disponible',\r\n        ultimoViaje: {\r\n          ...viajeActivo,\r\n          fechaLlegada: new Date().toISOString().split('T')[0],\r\n          horaLlegada: horaLlegada,\r\n          kilometrajeLlegada: parseInt(kilometrajeLlegada),\r\n          kilometrosRecorridos: kmRecorridos\r\n        }\r\n      });\r\n\r\n      setViajeActivo(null);\r\n      setMessage({\r\n        type: 'success',\r\n        text: `✅ Viaje finalizado. Recorriste ${kmRecorridos} km`\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('Error al finalizar viaje:', error);\r\n      setMessage({\r\n        type: 'error',\r\n        text: '❌ Error al finalizar el viaje'\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Si está cargando, mostrar indicador de carga\r\n  if (loadingVehiculo) {\r\n    return (\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0, 0, 0, 0.5)',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        zIndex: 9999,\r\n        padding: '20px'\r\n      }}>\r\n        <div style={{\r\n          background: 'white',\r\n          borderRadius: '12px',\r\n          padding: '30px',\r\n          maxWidth: '400px',\r\n          width: '100%',\r\n          textAlign: 'center'\r\n        }}>\r\n          <div style={{ fontSize: '48px', marginBottom: '20px' }}>⏳</div>\r\n          <h3 style={{ color: '#1f2937', marginBottom: '10px' }}>\r\n            Cargando información...\r\n          </h3>\r\n          <p style={{ color: '#6b7280' }}>\r\n            Verificando vehículo asignado\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Si no hay vehículo asignado (después de cargar)\r\n  if (!loadingVehiculo && !vehiculoAsignado) {\r\n    return (\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0, 0, 0, 0.5)',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        zIndex: 9999,\r\n        padding: '20px'\r\n      }}>\r\n        <div style={{\r\n          background: 'white',\r\n          borderRadius: '12px',\r\n          padding: '30px',\r\n          maxWidth: '400px',\r\n          width: '100%',\r\n          textAlign: 'center'\r\n        }}>\r\n          <div style={{ fontSize: '48px', marginBottom: '20px' }}>🚫</div>\r\n          <h3 style={{ color: '#1f2937', marginBottom: '10px' }}>\r\n            No tienes vehículo asignado\r\n          </h3>\r\n          <p style={{ color: '#6b7280', marginBottom: '20px' }}>\r\n            Contacta con tu supervisor para que te asigne un vehículo\r\n          </p>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              padding: '10px 20px',\r\n              background: '#6b7280',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '14px',\r\n              cursor: 'pointer'\r\n            }}\r\n          >\r\n            Cerrar\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      background: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      zIndex: 9999,\r\n      padding: '20px'\r\n    }}>\r\n      <div style={{\r\n        background: 'white',\r\n        borderRadius: '12px',\r\n        width: '100%',\r\n        maxWidth: '600px',\r\n        maxHeight: '90vh',\r\n        overflow: 'auto',\r\n        boxShadow: '0 10px 40px rgba(0,0,0,0.2)'\r\n      }}>\r\n        {/* Header */}\r\n        <div style={{\r\n          padding: '20px',\r\n          borderBottom: '1px solid #e5e7eb',\r\n          background: 'linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)',\r\n          borderRadius: '12px 12px 0 0',\r\n          color: 'white'\r\n        }}>\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center'\r\n          }}>\r\n            <div>\r\n              <h2 style={{ margin: 0, fontSize: '24px', fontWeight: '600' }}>\r\n                🚛 Control de Vehículo\r\n              </h2>\r\n              <p style={{ margin: '5px 0 0 0', fontSize: '14px', opacity: 0.9 }}>\r\n                {viajeActivo ? 'Viaje en curso' : 'Registrar salida de vehículo'}\r\n              </p>\r\n            </div>\r\n            <button\r\n              onClick={onClose}\r\n              style={{\r\n                background: 'rgba(255, 255, 255, 0.2)',\r\n                border: 'none',\r\n                color: 'white',\r\n                padding: '8px',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontSize: '18px'\r\n              }}\r\n            >\r\n              ✖\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Mensaje */}\r\n        {message && (\r\n          <div style={{\r\n            margin: '20px 20px 0',\r\n            padding: '12px',\r\n            borderRadius: '8px',\r\n            background: message.type === 'error' ? '#fee2e2' : '#d1fae5',\r\n            color: message.type === 'error' ? '#dc2626' : '#065f46',\r\n            fontSize: '14px',\r\n            fontWeight: '500'\r\n          }}>\r\n            {message.text}\r\n          </div>\r\n        )}\r\n\r\n        {/* Información del vehículo */}\r\n        <div style={{\r\n          padding: '20px',\r\n          background: '#f0f9ff',\r\n          borderBottom: '1px solid #e5e7eb'\r\n        }}>\r\n          <h3 style={{\r\n            margin: '0 0 15px 0',\r\n            color: '#0c4a6e',\r\n            fontSize: '16px',\r\n            fontWeight: '600'\r\n          }}>\r\n            Vehículo Asignado\r\n          </h3>\r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: 'repeat(2, 1fr)',\r\n            gap: '15px'\r\n          }}>\r\n            <div>\r\n              <span style={{ fontSize: '12px', color: '#64748b' }}>Vehículo:</span>\r\n              <p style={{ margin: '4px 0', fontWeight: '600', color: '#0c4a6e' }}>\r\n                {vehiculoAsignado.nombre}\r\n              </p>\r\n            </div>\r\n            <div>\r\n              <span style={{ fontSize: '12px', color: '#64748b' }}>Patente:</span>\r\n              <p style={{ margin: '4px 0', fontWeight: '600', color: '#0c4a6e' }}>\r\n                {vehiculoAsignado.patente || 'Sin patente'}\r\n              </p>\r\n            </div>\r\n            <div>\r\n              <span style={{ fontSize: '12px', color: '#64748b' }}>Marca/Modelo:</span>\r\n              <p style={{ margin: '4px 0', fontWeight: '600', color: '#0c4a6e' }}>\r\n                {vehiculoAsignado.marca} {vehiculoAsignado.modelo}\r\n              </p>\r\n            </div>\r\n            <div>\r\n              <span style={{ fontSize: '12px', color: '#64748b' }}>Estado:</span>\r\n              <p style={{ margin: '4px 0', fontWeight: '600' }}>\r\n                <span style={{\r\n                  padding: '4px 8px',\r\n                  borderRadius: '4px',\r\n                  fontSize: '12px',\r\n                  background: viajeActivo ? '#fef3c7' : '#dcfce7',\r\n                  color: viajeActivo ? '#92400e' : '#15803d'\r\n                }}>\r\n                  {viajeActivo ? '🚗 En viaje' : '✅ Disponible'}\r\n                </span>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Contenido principal */}\r\n        <div style={{ padding: '20px' }}>\r\n          {!viajeActivo ? (\r\n            // Formulario para iniciar viaje\r\n            <form onSubmit={(e) => { e.preventDefault(); handleIniciarViaje(); }}>\r\n              <div style={{ display: 'grid', gap: '15px' }}>\r\n                {/* Fecha y hora de salida */}\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px' }}>\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      marginBottom: '6px',\r\n                      fontSize: '14px',\r\n                      fontWeight: '500',\r\n                      color: '#374151'\r\n                    }}>\r\n                      📅 Fecha de Salida\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formViaje.fechaSalida}\r\n                      onChange={(e) => setFormViaje({ ...formViaje, fechaSalida: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '10px',\r\n                        border: '2px solid #e5e7eb',\r\n                        borderRadius: '8px',\r\n                        fontSize: '14px'\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      marginBottom: '6px',\r\n                      fontSize: '14px',\r\n                      fontWeight: '500',\r\n                      color: '#374151'\r\n                    }}>\r\n                      ⏰ Hora de Salida\r\n                    </label>\r\n                    <input\r\n                      type=\"time\"\r\n                      value={formViaje.horaSalida}\r\n                      onChange={(e) => setFormViaje({ ...formViaje, horaSalida: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '10px',\r\n                        border: '2px solid #e5e7eb',\r\n                        borderRadius: '8px',\r\n                        fontSize: '14px'\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Kilometraje */}\r\n                <div>\r\n                  <label style={{\r\n                    display: 'block',\r\n                    marginBottom: '6px',\r\n                    fontSize: '14px',\r\n                    fontWeight: '500',\r\n                    color: '#374151'\r\n                  }}>\r\n                    🚗 Kilometraje Actual\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={formViaje.kilometrajeSalida}\r\n                    onChange={(e) => setFormViaje({ ...formViaje, kilometrajeSalida: e.target.value })}\r\n                    placeholder=\"Ej: 45000\"\r\n                    required\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '10px',\r\n                      border: '2px solid #e5e7eb',\r\n                      borderRadius: '8px',\r\n                      fontSize: '14px'\r\n                    }}\r\n                  />\r\n                  <small style={{ color: '#6b7280', fontSize: '12px' }}>\r\n                    Último registro: {vehiculoAsignado.kilometraje || 0} km\r\n                  </small>\r\n                </div>\r\n\r\n                {/* Destino */}\r\n                <div>\r\n                  <label style={{\r\n                    display: 'block',\r\n                    marginBottom: '6px',\r\n                    fontSize: '14px',\r\n                    fontWeight: '500',\r\n                    color: '#374151'\r\n                  }}>\r\n                    📍 Destino\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formViaje.destino}\r\n                    onChange={(e) => setFormViaje({ ...formViaje, destino: e.target.value })}\r\n                    placeholder=\"Ingresa el lugar de destino\"\r\n                    required\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '10px',\r\n                      border: '2px solid #e5e7eb',\r\n                      borderRadius: '8px',\r\n                      fontSize: '14px'\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                {/* Motivo del viaje */}\r\n                <div>\r\n                  <label style={{\r\n                    display: 'block',\r\n                    marginBottom: '6px',\r\n                    fontSize: '14px',\r\n                    fontWeight: '500',\r\n                    color: '#374151'\r\n                  }}>\r\n                    📋 Motivo del Viaje\r\n                  </label>\r\n                  <select\r\n                    value={formViaje.motivoViaje}\r\n                    onChange={(e) => setFormViaje({ ...formViaje, motivoViaje: e.target.value })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '10px',\r\n                      border: '2px solid #e5e7eb',\r\n                      borderRadius: '8px',\r\n                      fontSize: '14px'\r\n                    }}\r\n                  >\r\n                    <option value=\"trabajo\">Trabajo en terreno</option>\r\n                    <option value=\"emergencia\">Emergencia</option>\r\n                    <option value=\"mantenimiento\">Mantenimiento</option>\r\n                    <option value=\"traslado\">Traslado de personal</option>\r\n                    <option value=\"carga\">Transporte de carga</option>\r\n                    <option value=\"otro\">Otro</option>\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Observaciones */}\r\n                <div>\r\n                  <label style={{\r\n                    display: 'block',\r\n                    marginBottom: '6px',\r\n                    fontSize: '14px',\r\n                    fontWeight: '500',\r\n                    color: '#374151'\r\n                  }}>\r\n                    📝 Observaciones (Opcional)\r\n                  </label>\r\n                  <textarea\r\n                    value={formViaje.observaciones}\r\n                    onChange={(e) => setFormViaje({ ...formViaje, observaciones: e.target.value })}\r\n                    placeholder=\"Detalles adicionales del viaje...\"\r\n                    rows={3}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '10px',\r\n                      border: '2px solid #e5e7eb',\r\n                      borderRadius: '8px',\r\n                      fontSize: '14px',\r\n                      resize: 'none'\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                {/* Botón de acción */}\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  style={{\r\n                    padding: '14px',\r\n                    background: loading ? '#9ca3af' : 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    borderRadius: '8px',\r\n                    fontSize: '16px',\r\n                    fontWeight: '600',\r\n                    cursor: loading ? 'not-allowed' : 'pointer',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    gap: '10px',\r\n                    transition: 'transform 0.2s'\r\n                  }}\r\n                  onMouseEnter={(e) => !loading && (e.currentTarget.style.transform = 'scale(1.02)')}\r\n                  onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <span style={{\r\n                        width: '16px',\r\n                        height: '16px',\r\n                        border: '2px solid white',\r\n                        borderTop: '2px solid transparent',\r\n                        borderRadius: '50%',\r\n                        animation: 'spin 1s linear infinite'\r\n                      }}></span>\r\n                      Iniciando...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      🚀 INICIAR VIAJE\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          ) : (\r\n            // Información del viaje activo\r\n            <div>\r\n              <div style={{\r\n                padding: '20px',\r\n                background: '#fef3c7',\r\n                borderRadius: '8px',\r\n                marginBottom: '20px'\r\n              }}>\r\n                <h3 style={{\r\n                  margin: '0 0 15px 0',\r\n                  color: '#92400e',\r\n                  fontSize: '18px',\r\n                  fontWeight: '600'\r\n                }}>\r\n                  🚗 Viaje en Curso\r\n                </h3>\r\n                <div style={{ display: 'grid', gap: '10px' }}>\r\n                  <div>\r\n                    <span style={{ fontSize: '13px', color: '#92400e' }}>Destino:</span>\r\n                    <p style={{ margin: '4px 0', fontWeight: '600', fontSize: '15px' }}>\r\n                      {viajeActivo.destino}\r\n                    </p>\r\n                  </div>\r\n                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px' }}>\r\n                    <div>\r\n                      <span style={{ fontSize: '13px', color: '#92400e' }}>Hora de salida:</span>\r\n                      <p style={{ margin: '4px 0', fontWeight: '600' }}>\r\n                        {viajeActivo.horaSalida}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <span style={{ fontSize: '13px', color: '#92400e' }}>Km de salida:</span>\r\n                      <p style={{ margin: '4px 0', fontWeight: '600' }}>\r\n                        {viajeActivo.kilometrajeSalida} km\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  {viajeActivo.observaciones && (\r\n                    <div>\r\n                      <span style={{ fontSize: '13px', color: '#92400e' }}>Observaciones:</span>\r\n                      <p style={{ margin: '4px 0', fontSize: '14px' }}>\r\n                        {viajeActivo.observaciones}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              <button\r\n                onClick={handleFinalizarViaje}\r\n                disabled={loading}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '14px',\r\n                  background: loading ? '#9ca3af' : 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '8px',\r\n                  fontSize: '16px',\r\n                  fontWeight: '600',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  gap: '10px'\r\n                }}\r\n              >\r\n                {loading ? 'Finalizando...' : '🏁 FINALIZAR VIAJE'}\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <style>{`\r\n        @keyframes spin {\r\n          0% { transform: rotate(0deg); }\r\n          100% { transform: rotate(360deg); }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TrabajadorVehiclePanel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}