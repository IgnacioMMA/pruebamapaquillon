{"ast":null,"code":"// src/components/SistemaTrabajadoresFirebase.js\nimport React,{useEffect,useRef,useState}from'react';import{trabajadoresService}from'../services/firebaseservices';import{database}from'../config/firebase';import{ref,onValue,update}from'firebase/database';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SistemaTrabajadoresFirebase=_ref=>{let{currentUser,onLogout}=_ref;// Log para debugging\nconsole.log('üîç Current User Data:',currentUser);// Estados principales\nconst mapRef=useRef(null);const[map,setMap]=useState(null);const[userPosition,setUserPosition]=useState(null);const[selectedZona,setSelectedZona]=useState(null);const[isTracking,setIsTracking]=useState(false);const[isNavigating,setIsNavigating]=useState(false);const[workStatus,setWorkStatus]=useState('idle');// idle, traveling, working, completed\nconst[workLog,setWorkLog]=useState({startTime:null,arrivalTime:null,endTime:null,zona:null});// Estados para zonas y notificaciones\nconst[zonasAsignadas,setZonasAsignadas]=useState([]);const[notificaciones,setNotificaciones]=useState([]);// Referencias para marcadores y servicios\nconst userMarkerRef=useRef(null);const zonaMarkerRef=useRef(null);const directionsServiceRef=useRef(null);const directionsRendererRef=useRef(null);const watchIdRef=useRef(null);const lastUpdateRef=useRef(null);// Estados de UI\nconst[mapLoaded,setMapLoaded]=useState(false);const[error,setError]=useState(null);const[distance,setDistance]=useState(null);const[duration,setDuration]=useState(null);const[showWorkLog,setShowWorkLog]=useState(false);const[gpsStatus,setGpsStatus]=useState('inactive');// inactive, activating, active, error\nconst API_KEY='AIzaSyA7DrdL36n5cx-RNzuXGAQggFeGCheHDbY';// Cargar zonas asignadas desde Firebase\nuseEffect(()=>{if(currentUser&&currentUser.uid){console.log('üîÑ Cargando zonas asignadas para trabajador:',currentUser.uid);// Escuchar zonas asignadas al trabajador\nconst zonasRef=ref(database,'zonas_asignadas');const unsubZonas=onValue(zonasRef,snapshot=>{const data=snapshot.val();console.log('üì¶ Datos de zonas recibidos:',data);if(data){// Filtrar solo las zonas asignadas a este trabajador\nconst zonasArray=Object.entries(data).filter(_ref2=>{let[id,zona]=_ref2;console.log(`Zona ${id}: asignada a ${zona.trabajadorAsignado}, yo soy ${currentUser.uid}`);return zona.trabajadorAsignado===currentUser.uid&&zona.estado!=='completado';}).map(_ref3=>{let[id,zona]=_ref3;return{id,...zona};});console.log('‚úÖ Zonas asignadas filtradas:',zonasArray);setZonasAsignadas(zonasArray);}else{console.log('‚ö†Ô∏è No hay zonas en Firebase');setZonasAsignadas([]);}});// Escuchar notificaciones\nconst notifRef=ref(database,'notificaciones');const unsubNotif=onValue(notifRef,snapshot=>{const data=snapshot.val();if(data){const notifArray=Object.entries(data).filter(_ref4=>{let[id,notif]=_ref4;return notif.trabajadorId===currentUser.uid&&!notif.leido;}).map(_ref5=>{let[id,notif]=_ref5;return{id,...notif};});setNotificaciones(notifArray);}});return()=>{unsubZonas();unsubNotif();};}},[currentUser]);// Registrar trabajador al montar el componente\nuseEffect(()=>{if(currentUser&&currentUser.uid){console.log('üîÑ Iniciando registro de trabajador en Realtime Database...');console.log('   - User ID:',currentUser.uid);console.log('   - Nombre:',currentUser.name);// Crear o actualizar el trabajador en Realtime Database\nconst registrarTrabajador=async()=>{try{await trabajadoresService.createOrUpdateTrabajador(currentUser.uid,{id:currentUser.uid,nombre:currentUser.name||currentUser.email||'Trabajador',email:currentUser.email,telefono:currentUser.phone||'',vehicleId:currentUser.vehicleId||null,estado:'inactivo',rol:'trabajador',ubicacion:null,createdAt:new Date().toISOString(),ultimaActualizacion:new Date().toISOString()});console.log('‚úÖ Trabajador registrado exitosamente en Realtime Database');console.log('   - Path: trabajadores/'+currentUser.uid);}catch(error){console.error('‚ùå ERROR CR√çTICO al registrar trabajador:',error);console.error('   - Mensaje:',error.message);console.error('   - Stack:',error.stack);}};registrarTrabajador();}else{console.warn('‚ö†Ô∏è No hay currentUser disponible todav√≠a');}},[currentUser]);// Funci√≥n para cargar Google Maps\nuseEffect(()=>{const loadGoogleMaps=()=>{return new Promise((resolve,reject)=>{if(window.google&&window.google.maps){resolve(window.google.maps);return;}const existingScript=document.querySelector('script[src*=\"maps.googleapis.com\"]');if(existingScript){existingScript.addEventListener('load',()=>{if(window.google&&window.google.maps){resolve(window.google.maps);}else{reject(new Error('Google Maps no disponible'));}});return;}const script=document.createElement('script');script.src=`https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places,geometry&v=weekly`;script.async=true;script.defer=true;script.onload=()=>{if(window.google&&window.google.maps){resolve(window.google.maps);}else{reject(new Error('Google Maps no disponible'));}};script.onerror=()=>{reject(new Error('Error al cargar Google Maps'));};document.head.appendChild(script);});};const initMap=async()=>{try{const maps=await loadGoogleMaps();if(!mapRef.current)return;const mapInstance=new maps.Map(mapRef.current,{center:{lat:-36.7333,lng:-72.4667},zoom:13,mapTypeId:'roadmap',zoomControl:true,mapTypeControl:false,scaleControl:false,streetViewControl:false,rotateControl:false,fullscreenControl:true});setMap(mapInstance);// Inicializar servicios de direcciones\ndirectionsServiceRef.current=new maps.DirectionsService();directionsRendererRef.current=new maps.DirectionsRenderer({map:mapInstance,suppressMarkers:false,polylineOptions:{strokeColor:'#4285F4',strokeWeight:6,strokeOpacity:0.8}});setMapLoaded(true);}catch(err){setError('Error al cargar el mapa: '+err.message);}};initMap();},[]);// üî• FUNCI√ìN CR√çTICA - Actualizar posici√≥n del usuario Y ENVIAR A FIREBASE\nconst updateUserPosition=position=>{console.log('üîÑ Actualizando posici√≥n:',position);setUserPosition(position);// Mostrar precisi√≥n en el UI\nif(window.google&&map){// Opcional: Mostrar c√≠rculo de precisi√≥n en el mapa\nconst accuracy=position.accuracy||100;console.log('üìç Precisi√≥n actual:',accuracy,'metros');}// üî• ENVIAR UBICACI√ìN A FIREBASE - ESTO ES LO QUE FALTABA\n// Solo actualizar si ha pasado al menos 5 segundos desde la √∫ltima actualizaci√≥n\nconst ahora=Date.now();if(!lastUpdateRef.current||ahora-lastUpdateRef.current>5000){console.log('üìç Enviando ubicaci√≥n a Firebase:',position);if(currentUser&&currentUser.uid){// Actualizar ubicaci√≥n en Firebase\ntrabajadoresService.updateTrabajadorLocation(currentUser.uid,{lat:position.lat,lng:position.lng,timestamp:new Date().toISOString(),accuracy:position.accuracy||null// Guardar precisi√≥n tambi√©n\n}).then(()=>{console.log('‚úÖ Ubicaci√≥n enviada a Firebase exitosamente');console.log('   - Trabajador ID:',currentUser.uid);console.log('   - Posici√≥n:',position);}).catch(error=>{console.error('‚ùå Error al enviar ubicaci√≥n a Firebase:',error);console.error('   - Detalles:',error.message);});// Tambi√©n actualizar el estado del trabajador si es necesario\nconst estadoActual=workStatus==='traveling'?'en_camino':workStatus==='working'?'trabajando':'disponible';// Actualizar datos adicionales del trabajador\ntrabajadoresService.updateTrabajadorData(currentUser.uid,{nombre:currentUser.name||currentUser.email,email:currentUser.email,estado:estadoActual,zonaDestino:selectedZona?selectedZona.nombre:null,ultimaActualizacion:new Date().toISOString()}).then(()=>{console.log('‚úÖ Datos del trabajador actualizados');}).catch(error=>{console.error('‚ùå Error al actualizar datos del trabajador:',error);});lastUpdateRef.current=ahora;}}// Actualizar marcador en el mapa local\nif(!map||!window.google)return;// Crear o actualizar marcador del usuario\nif(!userMarkerRef.current){userMarkerRef.current=new window.google.maps.Marker({position:position,map:map,title:'Tu ubicaci√≥n',icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:10,fillColor:'#4285F4',fillOpacity:1,strokeColor:'#ffffff',strokeWeight:3},zIndex:1000});// Centrar mapa en usuario\nmap.setCenter(position);map.setZoom(15);}else{userMarkerRef.current.setPosition(position);}// Si est√° navegando, actualizar distancia\nif(isNavigating&&selectedZona){const distance=window.google.maps.geometry.spherical.computeDistanceBetween(new window.google.maps.LatLng(position.lat,position.lng),new window.google.maps.LatLng(selectedZona.lat,selectedZona.lng));// Si lleg√≥ al destino (menos de 50 metros)\nif(distance<50&&workStatus==='traveling'){handleArrival();}}};// Funci√≥n para activar/desactivar GPS\nconst toggleGPS=()=>{if(isTracking){// Detener tracking\nif(watchIdRef.current){navigator.geolocation.clearWatch(watchIdRef.current);watchIdRef.current=null;}setIsTracking(false);setGpsStatus('inactive');// Mantener √∫ltima posici√≥n para la pr√≥xima activaci√≥n\nconsole.log('üìç GPS desactivado, √∫ltima ubicaci√≥n guardada:',userPosition);// Limpiar marcador de usuario\nif(userMarkerRef.current){userMarkerRef.current.setMap(null);userMarkerRef.current=null;}// Limpiar ubicaci√≥n en Firebase al desactivar GPS (sin await)\nif(currentUser&&currentUser.uid){trabajadoresService.updateTrabajadorData(currentUser.uid,{estado:'inactivo',// NO borrar la ubicaci√≥n, solo marcar como inactivo\n// ubicacion: null, // COMENTADO - mantener √∫ltima ubicaci√≥n\nultimaActualizacion:new Date().toISOString()}).then(()=>{console.log('üìç GPS desactivado - Estado actualizado a inactivo');}).catch(error=>{console.error('Error al actualizar estado en Firebase:',error);});}// Mantener √∫ltima posici√≥n conocida\nconsole.log('üìç √öltima ubicaci√≥n conocida guardada:',userPosition);}else{// Iniciar tracking\nif(!navigator.geolocation){alert('Tu navegador no soporta geolocalizaci√≥n');setGpsStatus('error');return;}console.log('üîÑ Iniciando GPS...');setIsTracking(true);setGpsStatus('activating');// Registrar el trabajador en Firebase si no existe (sin bloquear)\nif(currentUser&&currentUser.uid){console.log('üìù Registrando trabajador en Realtime Database...');console.log('   - User ID:',currentUser.uid);console.log('   - Datos:',currentUser);trabajadoresService.createOrUpdateTrabajador(currentUser.uid,{nombre:currentUser.name||currentUser.email||'Trabajador',email:currentUser.email,telefono:currentUser.phone||'',estado:'disponible',rol:'trabajador',vehicleId:currentUser.vehicleId||null,createdAt:new Date().toISOString()}).then(()=>{console.log('‚úÖ Trabajador registrado en Realtime Database');console.log('   - Path: trabajadores/'+currentUser.uid);}).catch(error=>{console.error('‚ùå Error al registrar trabajador:',error);console.error('   - Detalles:',error.message);});}else{console.error('‚ö†Ô∏è No hay currentUser o uid disponible');}// Obtener posici√≥n inicial\nnavigator.geolocation.getCurrentPosition(position=>{console.log('üìç Posici√≥n obtenida:',position.coords);const pos={lat:position.coords.latitude,lng:position.coords.longitude};updateUserPosition(pos);setGpsStatus('active');},error=>{console.error('‚ùå Error al obtener ubicaci√≥n:',error);// Si es timeout, ofrecer usar ubicaci√≥n de prueba autom√°ticamente\nif(error.code===error.TIMEOUT){console.log('‚è±Ô∏è Timeout del GPS - Usando ubicaci√≥n de prueba');// Usar ubicaci√≥n de prueba autom√°ticamente\nconst testPosition={lat:-36.7333+(Math.random()-0.5)*0.01,// A√±adir peque√±a variaci√≥n\nlng:-72.4667+(Math.random()-0.5)*0.01};updateUserPosition(testPosition);setGpsStatus('active');// Notificar al usuario\nconsole.log('üìç Usando ubicaci√≥n simulada debido a timeout del GPS');}else{let errorMessage='Error al obtener tu ubicaci√≥n. ';switch(error.code){case error.PERMISSION_DENIED:errorMessage+='Permiso denegado. Habilita el GPS en tu navegador.';break;case error.POSITION_UNAVAILABLE:errorMessage+='Ubicaci√≥n no disponible.';break;default:errorMessage+='Error desconocido.';}alert(errorMessage);setIsTracking(false);setGpsStatus('error');}},{enableHighAccuracy:false,// Cambiar a false para evitar timeouts\ntimeout:5000,// Reducir timeout\nmaximumAge:0});// Seguimiento continuo con ALTA PRECISI√ìN\nconst gpsWatchId=navigator.geolocation.watchPosition(position=>{console.log('üìç GPS - Actualizaci√≥n:',position.coords);console.log('   - Precisi√≥n:',position.coords.accuracy,'metros');// Solo actualizar si la precisi√≥n es mejor que 150 metros\nif(position.coords.accuracy<=150){const pos={lat:position.coords.latitude,lng:position.coords.longitude};updateUserPosition(pos);setGpsStatus('active');}else{console.log('‚ö†Ô∏è Precisi√≥n insuficiente, esperando mejor se√±al...');}},error=>{console.log('‚è±Ô∏è Esperando se√±al GPS...',error.message);},{enableHighAccuracy:true,// üî¥ ALTA PRECISI√ìN\ntimeout:30000,maximumAge:0,// Siempre ubicaci√≥n fresca\ndistanceFilter:5// Actualizar cada 5 metros de movimiento\n});watchIdRef.current=gpsWatchId;}};// Seleccionar zona de trabajo\nconst selectZona=zona=>{setSelectedZona(zona);if(!map||!window.google)return;// Limpiar marcador anterior\nif(zonaMarkerRef.current){zonaMarkerRef.current.setMap(null);}// Crear marcador de zona\nzonaMarkerRef.current=new window.google.maps.Marker({position:{lat:zona.lat,lng:zona.lng},map:map,title:zona.nombre,icon:{path:window.google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,scale:8,fillColor:'#22c55e',fillOpacity:1,strokeColor:'#ffffff',strokeWeight:2}});// Ajustar vista para mostrar ambos puntos\nif(userPosition){const bounds=new window.google.maps.LatLngBounds();bounds.extend(userPosition);bounds.extend({lat:zona.lat,lng:zona.lng});map.fitBounds(bounds,100);}else{map.setCenter({lat:zona.lat,lng:zona.lng});map.setZoom(15);}};// Iniciar navegaci√≥n\nconst startNavigation=async()=>{if(!selectedZona||!userPosition){alert('Debes activar el GPS y seleccionar una zona primero');return;}setIsNavigating(true);setWorkStatus('traveling');setWorkLog({...workLog,startTime:new Date().toISOString(),zona:selectedZona});// üî• Actualizar estado en Firebase y en la zona\ntry{// Actualizar estado del trabajador\nawait trabajadoresService.updateTrabajadorData(currentUser.uid,{estado:'en_camino',zonaDestino:selectedZona.nombre,recorridoInicio:new Date().toISOString()});// Actualizar estado de la zona a \"en_progreso\"\nif(selectedZona.id){await update(ref(database,`zonas_asignadas/${selectedZona.id}`),{estado:'en_progreso',ultimaActualizacion:new Date().toISOString()});}console.log('‚úÖ Estado actualizado a \"en_camino\" en Firebase');}catch(error){console.error('Error al actualizar estado en Firebase:',error);}// Calcular y mostrar ruta\nconst request={origin:userPosition,destination:{lat:selectedZona.lat,lng:selectedZona.lng},travelMode:window.google.maps.TravelMode.DRIVING};directionsServiceRef.current.route(request,(result,status)=>{if(status==='OK'){directionsRendererRef.current.setDirections(result);const route=result.routes[0];const leg=route.legs[0];setDistance(leg.distance.text);setDuration(leg.duration.text);}else{alert('No se pudo calcular la ruta: '+status);}});};// Manejar llegada a la zona\nconst handleArrival=async()=>{setWorkStatus('working');setWorkLog({...workLog,arrivalTime:new Date().toISOString()});// üî• Actualizar estado en Firebase\ntry{await trabajadoresService.updateTrabajadorData(currentUser.uid,{estado:'trabajando',horaLlegada:new Date().toISOString()});console.log('‚úÖ Llegada registrada en Firebase');}catch(error){console.error('Error al registrar llegada en Firebase:',error);}alert('¬°Has llegado a la zona de trabajo! Puedes iniciar tu tarea.');};// Finalizar trabajo\nconst finishWork=async()=>{const endTime=new Date().toISOString();const finalLog={...workLog,endTime:endTime};setWorkLog(finalLog);setWorkStatus('completed');setIsNavigating(false);setShowWorkLog(true);// Limpiar ruta\nif(directionsRendererRef.current){directionsRendererRef.current.setDirections({routes:[]});}// üî• Registrar finalizaci√≥n en Firebase y actualizar zona\ntry{// Actualizar estado del trabajador\nawait trabajadoresService.updateTrabajadorData(currentUser.uid,{estado:'disponible',zonaDestino:null,ultimoTrabajo:{zona:selectedZona.nombre,horaInicio:workLog.startTime,horaLlegada:workLog.arrivalTime,horaFin:endTime}});// Marcar zona como completada\nif(selectedZona.id){await update(ref(database,`zonas_asignadas/${selectedZona.id}`),{estado:'completado',fechaCompletado:endTime,ultimaActualizacion:new Date().toISOString()});}console.log('‚úÖ Trabajo finalizado y registrado en Firebase');}catch(error){console.error('Error al registrar finalizaci√≥n en Firebase:',error);}console.log('Registro de trabajo:',finalLog);};// Resetear para nuevo trabajo\nconst resetWork=()=>{setSelectedZona(null);setWorkStatus('idle');setWorkLog({startTime:null,arrivalTime:null,endTime:null,zona:null});setIsNavigating(false);setDistance(null);setDuration(null);setShowWorkLog(false);if(zonaMarkerRef.current){zonaMarkerRef.current.setMap(null);zonaMarkerRef.current=null;}if(directionsRendererRef.current){directionsRendererRef.current.setDirections({routes:[]});}};// Formatear tiempo\nconst formatTime=isoString=>{if(!isoString)return'--:--';const date=new Date(isoString);return date.toLocaleTimeString('es-CL',{hour:'2-digit',minute:'2-digit',hour12:false});};// Calcular duraci√≥n\nconst calculateDuration=(start,end)=>{if(!start||!end)return'--';const diff=new Date(end)-new Date(start);const hours=Math.floor(diff/3600000);const minutes=Math.floor(diff%3600000/60000);return`${hours}h ${minutes}m`;};// Limpiar al desmontar componente\nuseEffect(()=>{return()=>{// Limpiar GPS al salir\nif(watchIdRef.current){navigator.geolocation.clearWatch(watchIdRef.current);}// Marcar como inactivo en Firebase\nif(currentUser!==null&&currentUser!==void 0&&currentUser.uid){trabajadoresService.updateTrabajadorData(currentUser.uid,{estado:'inactivo',ubicacion:null}).catch(console.error);}};},[currentUser]);if(error){return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Error\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.reload(),children:\"Reintentar\"})]});}return/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:'100vh',position:'relative'},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:0,left:0,right:0,background:'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',color:'white',padding:'15px 20px',zIndex:1000,boxShadow:'0 2px 10px rgba(0,0,0,0.1)'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{style:{margin:0,fontSize:'20px',fontWeight:'600'},children:\"\\uD83D\\uDC77\\u200D\\u2642\\uFE0F Panel del Trabajador\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'4px 0 0 0',fontSize:'14px',opacity:0.95},children:[\"GPS y Navegaci\\xF3n a Zona de Trabajo - \",currentUser.name||currentUser.email]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onLogout,style:{padding:'8px 16px',background:'rgba(255,255,255,0.2)',color:'white',border:'1px solid rgba(255,255,255,0.3)',borderRadius:'6px',cursor:'pointer',fontSize:'14px'},children:\"Cerrar Sesi\\xF3n\"})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'80px',left:'10px',right:'10px',background:'white',borderRadius:'12px',padding:'15px',boxShadow:'0 4px 20px rgba(0,0,0,0.1)',zIndex:1000,maxWidth:'400px'},children:[!userPosition&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',padding:'10px',background:'#fff3cd',border:'1px solid #ffc107',borderRadius:'6px'},children:[/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'12px',color:'#856404',margin:'0 0 8px 0'},children:[\"\\uD83D\\uDD27 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Herramientas de Debug\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{console.log('üîß Forzando registro en Realtime Database...');try{// Importar directamente para debug\nconst{database}=await import('../config/firebase');const{ref,set}=await import('firebase/database');const trabajadorData={id:currentUser.uid,nombre:currentUser.name||currentUser.email,email:currentUser.email,telefono:currentUser.phone||'',vehicleId:currentUser.vehicleId||null,estado:'disponible',rol:'trabajador',ubicacion:{lat:-36.7333,lng:-72.4667,timestamp:new Date().toISOString()},createdAt:new Date().toISOString(),ultimaActualizacion:new Date().toISOString()};const trabajadorRef=ref(database,`trabajadores/${currentUser.uid}`);await set(trabajadorRef,trabajadorData);console.log('‚úÖ Trabajador registrado manualmente!');console.log('   - ID:',currentUser.uid);console.log('   - Datos:',trabajadorData);alert('‚úÖ Trabajador registrado en Firebase. Activa el GPS ahora.');}catch(error){console.error('‚ùå Error al registrar manualmente:',error);alert('Error: '+error.message);}},style:{width:'100%',padding:'8px',background:'#ffc107',color:'#000',border:'none',borderRadius:'4px',fontSize:'12px',cursor:'pointer',fontWeight:'bold'},children:\"\\uD83D\\uDD27 Forzar Registro en Realtime Database\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleGPS,style:{width:'100%',padding:'12px',background:isTracking?'#ef4444':'#22c55e',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'500',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',gap:'8px'},children:isTracking?'üìç Desactivar GPS':'üìç Activar GPS'}),gpsStatus!=='inactive'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px',fontSize:'12px',textAlign:'center',padding:'6px',borderRadius:'6px',background:gpsStatus==='active'?'#dcfce7':gpsStatus==='activating'?'#fef3c7':gpsStatus==='error'?'#fee2e2':'#f3f4f6',color:gpsStatus==='active'?'#166534':gpsStatus==='activating'?'#92400e':gpsStatus==='error'?'#991b1b':'#374151'},children:[gpsStatus==='active'&&'üü¢ GPS activo - Transmitiendo ubicaci√≥n',gpsStatus==='activating'&&'üü° Activando GPS... (Acepta los permisos del navegador)',gpsStatus==='error'&&'üî¥ Error en GPS - Verificar permisos del navegador']}),userPosition&&/*#__PURE__*/_jsxs(\"details\",{style:{marginTop:'8px',padding:'8px',background:'#f0f9ff',borderRadius:'6px',border:'1px solid #bae6fd'},children:[/*#__PURE__*/_jsx(\"summary\",{style:{cursor:'pointer',fontSize:'12px',fontWeight:'bold',color:'#0369a1'},children:\"\\uD83C\\uDFAF Ajustar ubicaci\\xF3n manualmente\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px'},children:[/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'11px',color:'#666',marginBottom:'8px'},children:\"Si el GPS no es preciso, puedes ajustar tu ubicaci\\xF3n:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Abrir Google Maps para obtener coordenadas exactas\nwindow.open(`https://www.google.com/maps?q=${userPosition.lat},${userPosition.lng}`,'_blank');},style:{width:'100%',padding:'6px',marginBottom:'6px',background:'#4285F4',color:'white',border:'none',borderRadius:'4px',fontSize:'11px',cursor:'pointer'},children:\"\\uD83D\\uDCCD Ver ubicaci\\xF3n actual en Google Maps\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'4px',marginBottom:'6px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.000001\",placeholder:\"Latitud\",id:\"manual-lat\",defaultValue:userPosition.lat,style:{flex:1,padding:'4px',fontSize:'11px',border:'1px solid #ddd',borderRadius:'4px'}}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.000001\",placeholder:\"Longitud\",id:\"manual-lng\",defaultValue:userPosition.lng,style:{flex:1,padding:'4px',fontSize:'11px',border:'1px solid #ddd',borderRadius:'4px'}})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const lat=parseFloat(document.getElementById('manual-lat').value);const lng=parseFloat(document.getElementById('manual-lng').value);if(!isNaN(lat)&&!isNaN(lng)){const manualPos={lat,lng,accuracy:5};// Alta precisi√≥n manual\nconsole.log('üìç Ubicaci√≥n ajustada manualmente:',manualPos);updateUserPosition(manualPos);alert('‚úÖ Ubicaci√≥n actualizada');}else{alert('‚ùå Coordenadas inv√°lidas');}},style:{width:'100%',padding:'6px',background:'#22c55e',color:'white',border:'none',borderRadius:'4px',fontSize:'11px',cursor:'pointer',fontWeight:'bold'},children:\"\\u2705 Aplicar ubicaci\\xF3n manual\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'10px',color:'#666',marginTop:'6px'},children:\"\\uD83D\\uDCA1 Tip: Haz clic derecho en Google Maps \\u2192 \\\"\\xBFQu\\xE9 hay aqu\\xED?\\\" para obtener coordenadas exactas\"})]})]}),!userPosition&&isTracking&&gpsStatus==='activating'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Usar ubicaci√≥n de prueba en Quill√≥n si el GPS real falla\nconst testPosition={lat:-36.7333,lng:-72.4667};console.log('üìç Usando ubicaci√≥n de prueba');updateUserPosition(testPosition);setGpsStatus('active');},style:{marginTop:'8px',width:'100%',padding:'8px',background:'#6b7280',color:'white',border:'none',borderRadius:'6px',fontSize:'12px',cursor:'pointer'},children:\"\\uD83D\\uDD27 Usar ubicaci\\xF3n de prueba (Quill\\xF3n)\"})]}),notificaciones.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px',padding:'10px',background:'#fef3c7',border:'1px solid #fde68a',borderRadius:'8px'},children:[/*#__PURE__*/_jsxs(\"h4\",{style:{margin:'0 0 8px 0',fontSize:'14px',color:'#92400e'},children:[\"\\uD83D\\uDD14 Nuevas notificaciones (\",notificaciones.length,\")\"]}),notificaciones.map(notif=>/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',marginBottom:'4px'},children:[\"\\u2022 \",notif.mensaje]},notif.id))]}),isTracking&&workStatus==='idle'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontSize:'14px',fontWeight:'500'},children:\"\\uD83C\\uDFD7\\uFE0F Seleccionar Zona de Trabajo:\"}),zonasAsignadas.length>0?/*#__PURE__*/_jsxs(\"select\",{value:(selectedZona===null||selectedZona===void 0?void 0:selectedZona.id)||'',onChange:e=>{const zona=zonasAsignadas.find(z=>z.id===e.target.value);if(zona)selectZona(zona);},style:{width:'100%',padding:'10px',borderRadius:'6px',border:'1px solid #ddd',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Seleccionar zona --\"}),zonasAsignadas.map(zona=>/*#__PURE__*/_jsxs(\"option\",{value:zona.id,children:[zona.nombre,\" - \",zona.direccion,zona.prioridad==='urgente'&&' üö®',zona.prioridad==='alta'&&' üî¥']},zona.id))]}):/*#__PURE__*/_jsx(\"div\",{style:{padding:'10px',background:'#f3f4f6',borderRadius:'6px',textAlign:'center',fontSize:'13px',color:'#6b7280'},children:\"No tienes zonas asignadas actualmente\"})]}),selectedZona&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f0f9ff',padding:'12px',borderRadius:'8px',marginBottom:'15px',border:'1px solid #bae6fd'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 8px 0',color:'#0369a1',fontSize:'14px'},children:\"Zona Seleccionada:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'13px',color:'#333'},children:[/*#__PURE__*/_jsx(\"strong\",{children:selectedZona.nombre}),/*#__PURE__*/_jsx(\"br\",{}),\"\\uD83D\\uDCCD \",selectedZona.direccion,distance&&duration&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px',color:'#666'},children:[\"\\uD83D\\uDE97 \",distance,\" \\u2022 \\u23F1\\uFE0F \",duration]})]})]}),workStatus==='idle'&&selectedZona&&userPosition&&/*#__PURE__*/_jsx(\"button\",{onClick:startNavigation,style:{width:'100%',padding:'12px',background:'#3b82f6',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'500',cursor:'pointer'},children:\"\\uD83D\\uDE97 Iniciar Recorrido\"}),workStatus==='traveling'&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fef3c7',padding:'12px',borderRadius:'8px',textAlign:'center',border:'1px solid #fde68a'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'16px',fontWeight:'500',color:'#92400e'},children:\"\\uD83D\\uDE97 En camino...\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',marginTop:'4px',color:'#78350f'},children:[\"Hora de salida: \",formatTime(workLog.startTime)]})]}),workStatus==='working'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'#dcfce7',padding:'12px',borderRadius:'8px',marginBottom:'12px',border:'1px solid #bbf7d0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'16px',fontWeight:'500',color:'#14532d'},children:\"\\u2705 En zona de trabajo\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',marginTop:'4px',color:'#166534'},children:[\"Llegada: \",formatTime(workLog.arrivalTime)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:finishWork,style:{width:'100%',padding:'12px',background:'#dc2626',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'500',cursor:'pointer'},children:\"\\uD83C\\uDFC1 Finalizar Trabajo\"})]}),workStatus==='completed'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'#e0e7ff',padding:'12px',borderRadius:'8px',marginBottom:'12px',border:'1px solid #c7d2fe'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'16px',fontWeight:'500',color:'#312e81'},children:\"\\u2705 Trabajo Completado\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowWorkLog(!showWorkLog),style:{marginTop:'8px',padding:'6px 12px',background:'#4f46e5',color:'white',border:'none',borderRadius:'6px',fontSize:'12px',cursor:'pointer'},children:\"\\uD83D\\uDCCB Ver Resumen\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:resetWork,style:{width:'100%',padding:'12px',background:'#22c55e',color:'white',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'500',cursor:'pointer'},children:\"\\uD83D\\uDD04 Nuevo Trabajo\"})]})]}),showWorkLog&&workLog.zona&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0,0,0,0.5)',display:'flex',justifyContent:'center',alignItems:'center',zIndex:2000,padding:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',borderRadius:'12px',padding:'20px',maxWidth:'400px',width:'100%',maxHeight:'80vh',overflow:'auto'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 20px 0',color:'#1f2937'},children:\"\\uD83D\\uDCCB Resumen del Trabajo\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'14px',lineHeight:'1.8'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Zona de trabajo:\"}),/*#__PURE__*/_jsx(\"br\",{}),workLog.zona.nombre,/*#__PURE__*/_jsx(\"br\",{}),\"\\uD83D\\uDCCD \",workLog.zona.direccion]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f8fafc',padding:'12px',borderRadius:'8px',marginBottom:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDE97 Hora de salida:\"}),\" \",formatTime(workLog.startTime)]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u2705 Hora de llegada:\"}),\" \",formatTime(workLog.arrivalTime)]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83C\\uDFC1 Hora de t\\xE9rmino:\"}),\" \",formatTime(workLog.endTime)]}),/*#__PURE__*/_jsx(\"hr\",{style:{margin:'10px 0',border:'none',borderTop:'1px solid #e5e7eb'}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u23F1\\uFE0F Tiempo de viaje:\"}),\" \",calculateDuration(workLog.startTime,workLog.arrivalTime)]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u23F1\\uFE0F Tiempo trabajado:\"}),\" \",calculateDuration(workLog.arrivalTime,workLog.endTime)]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u23F1\\uFE0F Tiempo total:\"}),\" \",calculateDuration(workLog.startTime,workLog.endTime)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowWorkLog(false),style:{width:'100%',padding:'10px',background:'#6b7280',color:'white',border:'none',borderRadius:'6px',fontSize:'14px',cursor:'pointer'},children:\"Cerrar\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{ref:mapRef,style:{width:'100%',height:'100%'}}),!mapLoaded&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',textAlign:'center',zIndex:1001},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'50px',height:'50px',border:'4px solid #f3f3f3',borderTop:'4px solid #22c55e',borderRadius:'50%',animation:'spin 1s linear infinite'}}),/*#__PURE__*/_jsx(\"p\",{style:{marginTop:'10px',color:'#666'},children:\"Cargando mapa...\"})]}),/*#__PURE__*/_jsx(\"style\",{jsx:true,children:`\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `})]});};export default SistemaTrabajadoresFirebase;","map":{"version":3,"names":["React","useEffect","useRef","useState","trabajadoresService","database","ref","onValue","update","jsx","_jsx","jsxs","_jsxs","SistemaTrabajadoresFirebase","_ref","currentUser","onLogout","console","log","mapRef","map","setMap","userPosition","setUserPosition","selectedZona","setSelectedZona","isTracking","setIsTracking","isNavigating","setIsNavigating","workStatus","setWorkStatus","workLog","setWorkLog","startTime","arrivalTime","endTime","zona","zonasAsignadas","setZonasAsignadas","notificaciones","setNotificaciones","userMarkerRef","zonaMarkerRef","directionsServiceRef","directionsRendererRef","watchIdRef","lastUpdateRef","mapLoaded","setMapLoaded","error","setError","distance","setDistance","duration","setDuration","showWorkLog","setShowWorkLog","gpsStatus","setGpsStatus","API_KEY","uid","zonasRef","unsubZonas","snapshot","data","val","zonasArray","Object","entries","filter","_ref2","id","trabajadorAsignado","estado","_ref3","notifRef","unsubNotif","notifArray","_ref4","notif","trabajadorId","leido","_ref5","name","registrarTrabajador","createOrUpdateTrabajador","nombre","email","telefono","phone","vehicleId","rol","ubicacion","createdAt","Date","toISOString","ultimaActualizacion","message","stack","warn","loadGoogleMaps","Promise","resolve","reject","window","google","maps","existingScript","document","querySelector","addEventListener","Error","script","createElement","src","async","defer","onload","onerror","head","appendChild","initMap","current","mapInstance","Map","center","lat","lng","zoom","mapTypeId","zoomControl","mapTypeControl","scaleControl","streetViewControl","rotateControl","fullscreenControl","DirectionsService","DirectionsRenderer","suppressMarkers","polylineOptions","strokeColor","strokeWeight","strokeOpacity","err","updateUserPosition","position","accuracy","ahora","now","updateTrabajadorLocation","timestamp","then","catch","estadoActual","updateTrabajadorData","zonaDestino","Marker","title","icon","path","SymbolPath","CIRCLE","scale","fillColor","fillOpacity","zIndex","setCenter","setZoom","setPosition","geometry","spherical","computeDistanceBetween","LatLng","handleArrival","toggleGPS","navigator","geolocation","clearWatch","alert","getCurrentPosition","coords","pos","latitude","longitude","code","TIMEOUT","testPosition","Math","random","errorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","enableHighAccuracy","timeout","maximumAge","gpsWatchId","watchPosition","distanceFilter","selectZona","BACKWARD_CLOSED_ARROW","bounds","LatLngBounds","extend","fitBounds","startNavigation","recorridoInicio","request","origin","destination","travelMode","TravelMode","DRIVING","route","result","status","setDirections","routes","leg","legs","text","horaLlegada","finishWork","finalLog","ultimoTrabajo","horaInicio","horaFin","fechaCompletado","resetWork","formatTime","isoString","date","toLocaleTimeString","hour","minute","hour12","calculateDuration","start","end","diff","hours","floor","minutes","style","padding","textAlign","children","onClick","location","reload","width","height","top","left","right","background","color","boxShadow","display","justifyContent","alignItems","margin","fontSize","fontWeight","opacity","border","borderRadius","cursor","maxWidth","marginTop","set","trabajadorData","trabajadorRef","marginBottom","gap","open","type","step","placeholder","defaultValue","flex","parseFloat","getElementById","value","isNaN","manualPos","length","mensaje","onChange","e","find","z","target","direccion","prioridad","bottom","maxHeight","overflow","lineHeight","borderTop","transform","animation"],"sources":["C:/Users/Izan/Desktop/AppReact/mapa-quillon/src/components/SistemaTrabajadoresFirebase.js"],"sourcesContent":["// src/components/SistemaTrabajadoresFirebase.js\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { trabajadoresService } from '../services/firebaseservices';\r\nimport { database } from '../config/firebase';\r\nimport { ref, onValue, update } from 'firebase/database';\r\n\r\nconst SistemaTrabajadoresFirebase = ({ currentUser, onLogout }) => {\r\n  // Log para debugging\r\n  console.log('üîç Current User Data:', currentUser);\r\n  \r\n  // Estados principales\r\n  const mapRef = useRef(null);\r\n  const [map, setMap] = useState(null);\r\n  const [userPosition, setUserPosition] = useState(null);\r\n  const [selectedZona, setSelectedZona] = useState(null);\r\n  const [isTracking, setIsTracking] = useState(false);\r\n  const [isNavigating, setIsNavigating] = useState(false);\r\n  const [workStatus, setWorkStatus] = useState('idle'); // idle, traveling, working, completed\r\n  const [workLog, setWorkLog] = useState({\r\n    startTime: null,\r\n    arrivalTime: null,\r\n    endTime: null,\r\n    zona: null\r\n  });\r\n  \r\n  // Estados para zonas y notificaciones\r\n  const [zonasAsignadas, setZonasAsignadas] = useState([]);\r\n  const [notificaciones, setNotificaciones] = useState([]);\r\n  \r\n  // Referencias para marcadores y servicios\r\n  const userMarkerRef = useRef(null);\r\n  const zonaMarkerRef = useRef(null);\r\n  const directionsServiceRef = useRef(null);\r\n  const directionsRendererRef = useRef(null);\r\n  const watchIdRef = useRef(null);\r\n  const lastUpdateRef = useRef(null);\r\n  \r\n  // Estados de UI\r\n  const [mapLoaded, setMapLoaded] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [distance, setDistance] = useState(null);\r\n  const [duration, setDuration] = useState(null);\r\n  const [showWorkLog, setShowWorkLog] = useState(false);\r\n  const [gpsStatus, setGpsStatus] = useState('inactive'); // inactive, activating, active, error\r\n\r\n  const API_KEY = 'AIzaSyA7DrdL36n5cx-RNzuXGAQggFeGCheHDbY';\r\n\r\n  // Cargar zonas asignadas desde Firebase\r\n  useEffect(() => {\r\n    if (currentUser && currentUser.uid) {\r\n      console.log('üîÑ Cargando zonas asignadas para trabajador:', currentUser.uid);\r\n      \r\n      // Escuchar zonas asignadas al trabajador\r\n      const zonasRef = ref(database, 'zonas_asignadas');\r\n      const unsubZonas = onValue(zonasRef, (snapshot) => {\r\n        const data = snapshot.val();\r\n        console.log('üì¶ Datos de zonas recibidos:', data);\r\n        \r\n        if (data) {\r\n          // Filtrar solo las zonas asignadas a este trabajador\r\n          const zonasArray = Object.entries(data)\r\n            .filter(([id, zona]) => {\r\n              console.log(`Zona ${id}: asignada a ${zona.trabajadorAsignado}, yo soy ${currentUser.uid}`);\r\n              return zona.trabajadorAsignado === currentUser.uid && zona.estado !== 'completado';\r\n            })\r\n            .map(([id, zona]) => ({\r\n              id,\r\n              ...zona\r\n            }));\r\n          \r\n          console.log('‚úÖ Zonas asignadas filtradas:', zonasArray);\r\n          setZonasAsignadas(zonasArray);\r\n        } else {\r\n          console.log('‚ö†Ô∏è No hay zonas en Firebase');\r\n          setZonasAsignadas([]);\r\n        }\r\n      });\r\n\r\n      // Escuchar notificaciones\r\n      const notifRef = ref(database, 'notificaciones');\r\n      const unsubNotif = onValue(notifRef, (snapshot) => {\r\n        const data = snapshot.val();\r\n        if (data) {\r\n          const notifArray = Object.entries(data)\r\n            .filter(([id, notif]) => notif.trabajadorId === currentUser.uid && !notif.leido)\r\n            .map(([id, notif]) => ({\r\n              id,\r\n              ...notif\r\n            }));\r\n          setNotificaciones(notifArray);\r\n        }\r\n      });\r\n\r\n      return () => {\r\n        unsubZonas();\r\n        unsubNotif();\r\n      };\r\n    }\r\n  }, [currentUser]);\r\n\r\n  // Registrar trabajador al montar el componente\r\n  useEffect(() => {\r\n    if (currentUser && currentUser.uid) {\r\n      console.log('üîÑ Iniciando registro de trabajador en Realtime Database...');\r\n      console.log('   - User ID:', currentUser.uid);\r\n      console.log('   - Nombre:', currentUser.name);\r\n      \r\n      // Crear o actualizar el trabajador en Realtime Database\r\n      const registrarTrabajador = async () => {\r\n        try {\r\n          await trabajadoresService.createOrUpdateTrabajador(currentUser.uid, {\r\n            id: currentUser.uid,\r\n            nombre: currentUser.name || currentUser.email || 'Trabajador',\r\n            email: currentUser.email,\r\n            telefono: currentUser.phone || '',\r\n            vehicleId: currentUser.vehicleId || null,\r\n            estado: 'inactivo',\r\n            rol: 'trabajador',\r\n            ubicacion: null,\r\n            createdAt: new Date().toISOString(),\r\n            ultimaActualizacion: new Date().toISOString()\r\n          });\r\n          console.log('‚úÖ Trabajador registrado exitosamente en Realtime Database');\r\n          console.log('   - Path: trabajadores/' + currentUser.uid);\r\n        } catch (error) {\r\n          console.error('‚ùå ERROR CR√çTICO al registrar trabajador:', error);\r\n          console.error('   - Mensaje:', error.message);\r\n          console.error('   - Stack:', error.stack);\r\n        }\r\n      };\r\n      \r\n      registrarTrabajador();\r\n    } else {\r\n      console.warn('‚ö†Ô∏è No hay currentUser disponible todav√≠a');\r\n    }\r\n  }, [currentUser]);\r\n\r\n  // Funci√≥n para cargar Google Maps\r\n  useEffect(() => {\r\n    const loadGoogleMaps = () => {\r\n      return new Promise((resolve, reject) => {\r\n        if (window.google && window.google.maps) {\r\n          resolve(window.google.maps);\r\n          return;\r\n        }\r\n\r\n        const existingScript = document.querySelector('script[src*=\"maps.googleapis.com\"]');\r\n        if (existingScript) {\r\n          existingScript.addEventListener('load', () => {\r\n            if (window.google && window.google.maps) {\r\n              resolve(window.google.maps);\r\n            } else {\r\n              reject(new Error('Google Maps no disponible'));\r\n            }\r\n          });\r\n          return;\r\n        }\r\n\r\n        const script = document.createElement('script');\r\n        script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places,geometry&v=weekly`;\r\n        script.async = true;\r\n        script.defer = true;\r\n\r\n        script.onload = () => {\r\n          if (window.google && window.google.maps) {\r\n            resolve(window.google.maps);\r\n          } else {\r\n            reject(new Error('Google Maps no disponible'));\r\n          }\r\n        };\r\n\r\n        script.onerror = () => {\r\n          reject(new Error('Error al cargar Google Maps'));\r\n        };\r\n\r\n        document.head.appendChild(script);\r\n      });\r\n    };\r\n\r\n    const initMap = async () => {\r\n      try {\r\n        const maps = await loadGoogleMaps();\r\n        \r\n        if (!mapRef.current) return;\r\n\r\n        const mapInstance = new maps.Map(mapRef.current, {\r\n          center: { lat: -36.7333, lng: -72.4667 },\r\n          zoom: 13,\r\n          mapTypeId: 'roadmap',\r\n          zoomControl: true,\r\n          mapTypeControl: false,\r\n          scaleControl: false,\r\n          streetViewControl: false,\r\n          rotateControl: false,\r\n          fullscreenControl: true\r\n        });\r\n\r\n        setMap(mapInstance);\r\n        \r\n        // Inicializar servicios de direcciones\r\n        directionsServiceRef.current = new maps.DirectionsService();\r\n        directionsRendererRef.current = new maps.DirectionsRenderer({\r\n          map: mapInstance,\r\n          suppressMarkers: false,\r\n          polylineOptions: {\r\n            strokeColor: '#4285F4',\r\n            strokeWeight: 6,\r\n            strokeOpacity: 0.8\r\n          }\r\n        });\r\n\r\n        setMapLoaded(true);\r\n      } catch (err) {\r\n        setError('Error al cargar el mapa: ' + err.message);\r\n      }\r\n    };\r\n\r\n    initMap();\r\n  }, []);\r\n\r\n  // üî• FUNCI√ìN CR√çTICA - Actualizar posici√≥n del usuario Y ENVIAR A FIREBASE\r\n  const updateUserPosition = (position) => {\r\n    console.log('üîÑ Actualizando posici√≥n:', position);\r\n    setUserPosition(position);\r\n    \r\n    // Mostrar precisi√≥n en el UI\r\n    if (window.google && map) {\r\n      // Opcional: Mostrar c√≠rculo de precisi√≥n en el mapa\r\n      const accuracy = position.accuracy || 100;\r\n      console.log('üìç Precisi√≥n actual:', accuracy, 'metros');\r\n    }\r\n    \r\n    // üî• ENVIAR UBICACI√ìN A FIREBASE - ESTO ES LO QUE FALTABA\r\n    // Solo actualizar si ha pasado al menos 5 segundos desde la √∫ltima actualizaci√≥n\r\n    const ahora = Date.now();\r\n    if (!lastUpdateRef.current || (ahora - lastUpdateRef.current) > 5000) {\r\n      console.log('üìç Enviando ubicaci√≥n a Firebase:', position);\r\n      \r\n      if (currentUser && currentUser.uid) {\r\n        // Actualizar ubicaci√≥n en Firebase\r\n        trabajadoresService.updateTrabajadorLocation(currentUser.uid, {\r\n          lat: position.lat,\r\n          lng: position.lng,\r\n          timestamp: new Date().toISOString(),\r\n          accuracy: position.accuracy || null // Guardar precisi√≥n tambi√©n\r\n        }).then(() => {\r\n          console.log('‚úÖ Ubicaci√≥n enviada a Firebase exitosamente');\r\n          console.log('   - Trabajador ID:', currentUser.uid);\r\n          console.log('   - Posici√≥n:', position);\r\n        }).catch(error => {\r\n          console.error('‚ùå Error al enviar ubicaci√≥n a Firebase:', error);\r\n          console.error('   - Detalles:', error.message);\r\n        });\r\n        \r\n        // Tambi√©n actualizar el estado del trabajador si es necesario\r\n        const estadoActual = workStatus === 'traveling' ? 'en_camino' : \r\n                            workStatus === 'working' ? 'trabajando' : \r\n                            'disponible';\r\n        \r\n        // Actualizar datos adicionales del trabajador\r\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n          nombre: currentUser.name || currentUser.email,\r\n          email: currentUser.email,\r\n          estado: estadoActual,\r\n          zonaDestino: selectedZona ? selectedZona.nombre : null,\r\n          ultimaActualizacion: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('‚úÖ Datos del trabajador actualizados');\r\n        }).catch(error => {\r\n          console.error('‚ùå Error al actualizar datos del trabajador:', error);\r\n        });\r\n        \r\n        lastUpdateRef.current = ahora;\r\n      }\r\n    }\r\n    \r\n    // Actualizar marcador en el mapa local\r\n    if (!map || !window.google) return;\r\n\r\n    // Crear o actualizar marcador del usuario\r\n    if (!userMarkerRef.current) {\r\n      userMarkerRef.current = new window.google.maps.Marker({\r\n        position: position,\r\n        map: map,\r\n        title: 'Tu ubicaci√≥n',\r\n        icon: {\r\n          path: window.google.maps.SymbolPath.CIRCLE,\r\n          scale: 10,\r\n          fillColor: '#4285F4',\r\n          fillOpacity: 1,\r\n          strokeColor: '#ffffff',\r\n          strokeWeight: 3\r\n        },\r\n        zIndex: 1000\r\n      });\r\n      \r\n      // Centrar mapa en usuario\r\n      map.setCenter(position);\r\n      map.setZoom(15);\r\n    } else {\r\n      userMarkerRef.current.setPosition(position);\r\n    }\r\n\r\n    // Si est√° navegando, actualizar distancia\r\n    if (isNavigating && selectedZona) {\r\n      const distance = window.google.maps.geometry.spherical.computeDistanceBetween(\r\n        new window.google.maps.LatLng(position.lat, position.lng),\r\n        new window.google.maps.LatLng(selectedZona.lat, selectedZona.lng)\r\n      );\r\n      \r\n      // Si lleg√≥ al destino (menos de 50 metros)\r\n      if (distance < 50 && workStatus === 'traveling') {\r\n        handleArrival();\r\n      }\r\n    }\r\n  };\r\n\r\n  // Funci√≥n para activar/desactivar GPS\r\n  const toggleGPS = () => {\r\n    if (isTracking) {\r\n      // Detener tracking\r\n      if (watchIdRef.current) {\r\n        navigator.geolocation.clearWatch(watchIdRef.current);\r\n        watchIdRef.current = null;\r\n      }\r\n      setIsTracking(false);\r\n      setGpsStatus('inactive');\r\n      \r\n      // Mantener √∫ltima posici√≥n para la pr√≥xima activaci√≥n\r\n      console.log('üìç GPS desactivado, √∫ltima ubicaci√≥n guardada:', userPosition);\r\n      \r\n      // Limpiar marcador de usuario\r\n      if (userMarkerRef.current) {\r\n        userMarkerRef.current.setMap(null);\r\n        userMarkerRef.current = null;\r\n      }\r\n      \r\n      // Limpiar ubicaci√≥n en Firebase al desactivar GPS (sin await)\r\n      if (currentUser && currentUser.uid) {\r\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n          estado: 'inactivo',\r\n          // NO borrar la ubicaci√≥n, solo marcar como inactivo\r\n          // ubicacion: null, // COMENTADO - mantener √∫ltima ubicaci√≥n\r\n          ultimaActualizacion: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('üìç GPS desactivado - Estado actualizado a inactivo');\r\n        }).catch(error => {\r\n          console.error('Error al actualizar estado en Firebase:', error);\r\n        });\r\n      }\r\n      \r\n      // Mantener √∫ltima posici√≥n conocida\r\n      console.log('üìç √öltima ubicaci√≥n conocida guardada:', userPosition);\r\n    } else {\r\n      // Iniciar tracking\r\n      if (!navigator.geolocation) {\r\n        alert('Tu navegador no soporta geolocalizaci√≥n');\r\n        setGpsStatus('error');\r\n        return;\r\n      }\r\n\r\n      console.log('üîÑ Iniciando GPS...');\r\n      setIsTracking(true);\r\n      setGpsStatus('activating');\r\n      \r\n      // Registrar el trabajador en Firebase si no existe (sin bloquear)\r\n      if (currentUser && currentUser.uid) {\r\n        console.log('üìù Registrando trabajador en Realtime Database...');\r\n        console.log('   - User ID:', currentUser.uid);\r\n        console.log('   - Datos:', currentUser);\r\n        \r\n        trabajadoresService.createOrUpdateTrabajador(currentUser.uid, {\r\n          nombre: currentUser.name || currentUser.email || 'Trabajador',\r\n          email: currentUser.email,\r\n          telefono: currentUser.phone || '',\r\n          estado: 'disponible',\r\n          rol: 'trabajador',\r\n          vehicleId: currentUser.vehicleId || null,\r\n          createdAt: new Date().toISOString()\r\n        }).then(() => {\r\n          console.log('‚úÖ Trabajador registrado en Realtime Database');\r\n          console.log('   - Path: trabajadores/' + currentUser.uid);\r\n        }).catch(error => {\r\n          console.error('‚ùå Error al registrar trabajador:', error);\r\n          console.error('   - Detalles:', error.message);\r\n        });\r\n      } else {\r\n        console.error('‚ö†Ô∏è No hay currentUser o uid disponible');\r\n      }\r\n      \r\n      // Obtener posici√≥n inicial\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          console.log('üìç Posici√≥n obtenida:', position.coords);\r\n          const pos = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          };\r\n          updateUserPosition(pos);\r\n          setGpsStatus('active');\r\n        },\r\n        (error) => {\r\n          console.error('‚ùå Error al obtener ubicaci√≥n:', error);\r\n          \r\n          // Si es timeout, ofrecer usar ubicaci√≥n de prueba autom√°ticamente\r\n          if (error.code === error.TIMEOUT) {\r\n            console.log('‚è±Ô∏è Timeout del GPS - Usando ubicaci√≥n de prueba');\r\n            // Usar ubicaci√≥n de prueba autom√°ticamente\r\n            const testPosition = {\r\n              lat: -36.7333 + (Math.random() - 0.5) * 0.01, // A√±adir peque√±a variaci√≥n\r\n              lng: -72.4667 + (Math.random() - 0.5) * 0.01\r\n            };\r\n            updateUserPosition(testPosition);\r\n            setGpsStatus('active');\r\n            \r\n            // Notificar al usuario\r\n            console.log('üìç Usando ubicaci√≥n simulada debido a timeout del GPS');\r\n          } else {\r\n            let errorMessage = 'Error al obtener tu ubicaci√≥n. ';\r\n            \r\n            switch(error.code) {\r\n              case error.PERMISSION_DENIED:\r\n                errorMessage += 'Permiso denegado. Habilita el GPS en tu navegador.';\r\n                break;\r\n              case error.POSITION_UNAVAILABLE:\r\n                errorMessage += 'Ubicaci√≥n no disponible.';\r\n                break;\r\n              default:\r\n                errorMessage += 'Error desconocido.';\r\n            }\r\n            \r\n            alert(errorMessage);\r\n            setIsTracking(false);\r\n            setGpsStatus('error');\r\n          }\r\n        },\r\n        {\r\n          enableHighAccuracy: false, // Cambiar a false para evitar timeouts\r\n          timeout: 5000, // Reducir timeout\r\n          maximumAge: 0\r\n        }\r\n      );\r\n\r\n      // Seguimiento continuo con ALTA PRECISI√ìN\r\n      const gpsWatchId = navigator.geolocation.watchPosition(\r\n        (position) => {\r\n          console.log('üìç GPS - Actualizaci√≥n:', position.coords);\r\n          console.log('   - Precisi√≥n:', position.coords.accuracy, 'metros');\r\n          \r\n          // Solo actualizar si la precisi√≥n es mejor que 150 metros\r\n          if (position.coords.accuracy <= 150) {\r\n            const pos = {\r\n              lat: position.coords.latitude,\r\n              lng: position.coords.longitude\r\n            };\r\n            updateUserPosition(pos);\r\n            setGpsStatus('active');\r\n          } else {\r\n            console.log('‚ö†Ô∏è Precisi√≥n insuficiente, esperando mejor se√±al...');\r\n          }\r\n        },\r\n        (error) => {\r\n          console.log('‚è±Ô∏è Esperando se√±al GPS...', error.message);\r\n        },\r\n        {\r\n          enableHighAccuracy: true, // üî¥ ALTA PRECISI√ìN\r\n          timeout: 30000,\r\n          maximumAge: 0, // Siempre ubicaci√≥n fresca\r\n          distanceFilter: 5 // Actualizar cada 5 metros de movimiento\r\n        }\r\n      );\r\n      \r\n      watchIdRef.current = gpsWatchId;\r\n    }\r\n  };\r\n\r\n  // Seleccionar zona de trabajo\r\n  const selectZona = (zona) => {\r\n    setSelectedZona(zona);\r\n    \r\n    if (!map || !window.google) return;\r\n\r\n    // Limpiar marcador anterior\r\n    if (zonaMarkerRef.current) {\r\n      zonaMarkerRef.current.setMap(null);\r\n    }\r\n\r\n    // Crear marcador de zona\r\n    zonaMarkerRef.current = new window.google.maps.Marker({\r\n      position: { lat: zona.lat, lng: zona.lng },\r\n      map: map,\r\n      title: zona.nombre,\r\n      icon: {\r\n        path: window.google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,\r\n        scale: 8,\r\n        fillColor: '#22c55e',\r\n        fillOpacity: 1,\r\n        strokeColor: '#ffffff',\r\n        strokeWeight: 2\r\n      }\r\n    });\r\n\r\n    // Ajustar vista para mostrar ambos puntos\r\n    if (userPosition) {\r\n      const bounds = new window.google.maps.LatLngBounds();\r\n      bounds.extend(userPosition);\r\n      bounds.extend({ lat: zona.lat, lng: zona.lng });\r\n      map.fitBounds(bounds, 100);\r\n    } else {\r\n      map.setCenter({ lat: zona.lat, lng: zona.lng });\r\n      map.setZoom(15);\r\n    }\r\n  };\r\n\r\n  // Iniciar navegaci√≥n\r\n  const startNavigation = async () => {\r\n    if (!selectedZona || !userPosition) {\r\n      alert('Debes activar el GPS y seleccionar una zona primero');\r\n      return;\r\n    }\r\n\r\n    setIsNavigating(true);\r\n    setWorkStatus('traveling');\r\n    setWorkLog({\r\n      ...workLog,\r\n      startTime: new Date().toISOString(),\r\n      zona: selectedZona\r\n    });\r\n\r\n    // üî• Actualizar estado en Firebase y en la zona\r\n    try {\r\n      // Actualizar estado del trabajador\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        estado: 'en_camino',\r\n        zonaDestino: selectedZona.nombre,\r\n        recorridoInicio: new Date().toISOString()\r\n      });\r\n      \r\n      // Actualizar estado de la zona a \"en_progreso\"\r\n      if (selectedZona.id) {\r\n        await update(ref(database, `zonas_asignadas/${selectedZona.id}`), {\r\n          estado: 'en_progreso',\r\n          ultimaActualizacion: new Date().toISOString()\r\n        });\r\n      }\r\n      \r\n      console.log('‚úÖ Estado actualizado a \"en_camino\" en Firebase');\r\n    } catch (error) {\r\n      console.error('Error al actualizar estado en Firebase:', error);\r\n    }\r\n\r\n    // Calcular y mostrar ruta\r\n    const request = {\r\n      origin: userPosition,\r\n      destination: { lat: selectedZona.lat, lng: selectedZona.lng },\r\n      travelMode: window.google.maps.TravelMode.DRIVING\r\n    };\r\n\r\n    directionsServiceRef.current.route(request, (result, status) => {\r\n      if (status === 'OK') {\r\n        directionsRendererRef.current.setDirections(result);\r\n        \r\n        const route = result.routes[0];\r\n        const leg = route.legs[0];\r\n        \r\n        setDistance(leg.distance.text);\r\n        setDuration(leg.duration.text);\r\n      } else {\r\n        alert('No se pudo calcular la ruta: ' + status);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Manejar llegada a la zona\r\n  const handleArrival = async () => {\r\n    setWorkStatus('working');\r\n    setWorkLog({\r\n      ...workLog,\r\n      arrivalTime: new Date().toISOString()\r\n    });\r\n    \r\n    // üî• Actualizar estado en Firebase\r\n    try {\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        estado: 'trabajando',\r\n        horaLlegada: new Date().toISOString()\r\n      });\r\n      console.log('‚úÖ Llegada registrada en Firebase');\r\n    } catch (error) {\r\n      console.error('Error al registrar llegada en Firebase:', error);\r\n    }\r\n    \r\n    alert('¬°Has llegado a la zona de trabajo! Puedes iniciar tu tarea.');\r\n  };\r\n\r\n  // Finalizar trabajo\r\n  const finishWork = async () => {\r\n    const endTime = new Date().toISOString();\r\n    const finalLog = {\r\n      ...workLog,\r\n      endTime: endTime\r\n    };\r\n    \r\n    setWorkLog(finalLog);\r\n    setWorkStatus('completed');\r\n    setIsNavigating(false);\r\n    setShowWorkLog(true);\r\n    \r\n    // Limpiar ruta\r\n    if (directionsRendererRef.current) {\r\n      directionsRendererRef.current.setDirections({ routes: [] });\r\n    }\r\n    \r\n    // üî• Registrar finalizaci√≥n en Firebase y actualizar zona\r\n    try {\r\n      // Actualizar estado del trabajador\r\n      await trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n        estado: 'disponible',\r\n        zonaDestino: null,\r\n        ultimoTrabajo: {\r\n          zona: selectedZona.nombre,\r\n          horaInicio: workLog.startTime,\r\n          horaLlegada: workLog.arrivalTime,\r\n          horaFin: endTime\r\n        }\r\n      });\r\n      \r\n      // Marcar zona como completada\r\n      if (selectedZona.id) {\r\n        await update(ref(database, `zonas_asignadas/${selectedZona.id}`), {\r\n          estado: 'completado',\r\n          fechaCompletado: endTime,\r\n          ultimaActualizacion: new Date().toISOString()\r\n        });\r\n      }\r\n      \r\n      console.log('‚úÖ Trabajo finalizado y registrado en Firebase');\r\n    } catch (error) {\r\n      console.error('Error al registrar finalizaci√≥n en Firebase:', error);\r\n    }\r\n    \r\n    console.log('Registro de trabajo:', finalLog);\r\n  };\r\n\r\n  // Resetear para nuevo trabajo\r\n  const resetWork = () => {\r\n    setSelectedZona(null);\r\n    setWorkStatus('idle');\r\n    setWorkLog({\r\n      startTime: null,\r\n      arrivalTime: null,\r\n      endTime: null,\r\n      zona: null\r\n    });\r\n    setIsNavigating(false);\r\n    setDistance(null);\r\n    setDuration(null);\r\n    setShowWorkLog(false);\r\n    \r\n    if (zonaMarkerRef.current) {\r\n      zonaMarkerRef.current.setMap(null);\r\n      zonaMarkerRef.current = null;\r\n    }\r\n    \r\n    if (directionsRendererRef.current) {\r\n      directionsRendererRef.current.setDirections({ routes: [] });\r\n    }\r\n  };\r\n\r\n  // Formatear tiempo\r\n  const formatTime = (isoString) => {\r\n    if (!isoString) return '--:--';\r\n    const date = new Date(isoString);\r\n    return date.toLocaleTimeString('es-CL', { \r\n      hour: '2-digit', \r\n      minute: '2-digit',\r\n      hour12: false \r\n    });\r\n  };\r\n\r\n  // Calcular duraci√≥n\r\n  const calculateDuration = (start, end) => {\r\n    if (!start || !end) return '--';\r\n    const diff = new Date(end) - new Date(start);\r\n    const hours = Math.floor(diff / 3600000);\r\n    const minutes = Math.floor((diff % 3600000) / 60000);\r\n    return `${hours}h ${minutes}m`;\r\n  };\r\n\r\n  // Limpiar al desmontar componente\r\n  useEffect(() => {\r\n    return () => {\r\n      // Limpiar GPS al salir\r\n      if (watchIdRef.current) {\r\n        navigator.geolocation.clearWatch(watchIdRef.current);\r\n      }\r\n      \r\n      // Marcar como inactivo en Firebase\r\n      if (currentUser?.uid) {\r\n        trabajadoresService.updateTrabajadorData(currentUser.uid, {\r\n          estado: 'inactivo',\r\n          ubicacion: null\r\n        }).catch(console.error);\r\n      }\r\n    };\r\n  }, [currentUser]);\r\n\r\n  if (error) {\r\n    return (\r\n      <div style={{ padding: '20px', textAlign: 'center' }}>\r\n        <h2>Error</h2>\r\n        <p>{error}</p>\r\n        <button onClick={() => window.location.reload()}>Reintentar</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ width: '100%', height: '100vh', position: 'relative' }}>\r\n      {/* Encabezado */}\r\n      <div style={{\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        background: 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\r\n        color: 'white',\r\n        padding: '15px 20px',\r\n        zIndex: 1000,\r\n        boxShadow: '0 2px 10px rgba(0,0,0,0.1)'\r\n      }}>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, fontSize: '20px', fontWeight: '600' }}>\r\n              üë∑‚Äç‚ôÇÔ∏è Panel del Trabajador\r\n            </h1>\r\n            <p style={{ margin: '4px 0 0 0', fontSize: '14px', opacity: 0.95 }}>\r\n              GPS y Navegaci√≥n a Zona de Trabajo - {currentUser.name || currentUser.email}\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onLogout}\r\n            style={{\r\n              padding: '8px 16px',\r\n              background: 'rgba(255,255,255,0.2)',\r\n              color: 'white',\r\n              border: '1px solid rgba(255,255,255,0.3)',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px'\r\n            }}\r\n          >\r\n            Cerrar Sesi√≥n\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Panel de control principal */}\r\n      <div style={{\r\n        position: 'absolute',\r\n        top: '80px',\r\n        left: '10px',\r\n        right: '10px',\r\n        background: 'white',\r\n        borderRadius: '12px',\r\n        padding: '15px',\r\n        boxShadow: '0 4px 20px rgba(0,0,0,0.1)',\r\n        zIndex: 1000,\r\n        maxWidth: '400px'\r\n      }}>\r\n        {/* Bot√≥n de DEBUG para forzar registro en Firebase */}\r\n        {!userPosition && (\r\n          <div style={{\r\n            marginTop: '10px',\r\n            padding: '10px',\r\n            background: '#fff3cd',\r\n            border: '1px solid #ffc107',\r\n            borderRadius: '6px'\r\n          }}>\r\n            <p style={{ fontSize: '12px', color: '#856404', margin: '0 0 8px 0' }}>\r\n              üîß <strong>Herramientas de Debug</strong>\r\n            </p>\r\n            <button\r\n              onClick={async () => {\r\n                console.log('üîß Forzando registro en Realtime Database...');\r\n                try {\r\n                  // Importar directamente para debug\r\n                  const { database } = await import('../config/firebase');\r\n                  const { ref, set } = await import('firebase/database');\r\n                  \r\n                  const trabajadorData = {\r\n                    id: currentUser.uid,\r\n                    nombre: currentUser.name || currentUser.email,\r\n                    email: currentUser.email,\r\n                    telefono: currentUser.phone || '',\r\n                    vehicleId: currentUser.vehicleId || null,\r\n                    estado: 'disponible',\r\n                    rol: 'trabajador',\r\n                    ubicacion: {\r\n                      lat: -36.7333,\r\n                      lng: -72.4667,\r\n                      timestamp: new Date().toISOString()\r\n                    },\r\n                    createdAt: new Date().toISOString(),\r\n                    ultimaActualizacion: new Date().toISOString()\r\n                  };\r\n                  \r\n                  const trabajadorRef = ref(database, `trabajadores/${currentUser.uid}`);\r\n                  await set(trabajadorRef, trabajadorData);\r\n                  \r\n                  console.log('‚úÖ Trabajador registrado manualmente!');\r\n                  console.log('   - ID:', currentUser.uid);\r\n                  console.log('   - Datos:', trabajadorData);\r\n                  alert('‚úÖ Trabajador registrado en Firebase. Activa el GPS ahora.');\r\n                } catch (error) {\r\n                  console.error('‚ùå Error al registrar manualmente:', error);\r\n                  alert('Error: ' + error.message);\r\n                }\r\n              }}\r\n              style={{\r\n                width: '100%',\r\n                padding: '8px',\r\n                background: '#ffc107',\r\n                color: '#000',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                fontSize: '12px',\r\n                cursor: 'pointer',\r\n                fontWeight: 'bold'\r\n              }}\r\n            >\r\n              üîß Forzar Registro en Realtime Database\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Activaci√≥n GPS con indicador de estado */}\r\n        <div style={{ marginBottom: '15px' }}>\r\n          <button\r\n            onClick={toggleGPS}\r\n            style={{\r\n              width: '100%',\r\n              padding: '12px',\r\n              background: isTracking ? '#ef4444' : '#22c55e',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '16px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gap: '8px'\r\n            }}\r\n          >\r\n            {isTracking ? 'üìç Desactivar GPS' : 'üìç Activar GPS'}\r\n          </button>\r\n          \r\n          {/* Indicador de estado del GPS */}\r\n          {gpsStatus !== 'inactive' && (\r\n            <div style={{ \r\n              marginTop: '8px', \r\n              fontSize: '12px', \r\n              textAlign: 'center',\r\n              padding: '6px',\r\n              borderRadius: '6px',\r\n              background: gpsStatus === 'active' ? '#dcfce7' : \r\n                         gpsStatus === 'activating' ? '#fef3c7' : \r\n                         gpsStatus === 'error' ? '#fee2e2' : '#f3f4f6',\r\n              color: gpsStatus === 'active' ? '#166534' : \r\n                     gpsStatus === 'activating' ? '#92400e' : \r\n                     gpsStatus === 'error' ? '#991b1b' : '#374151'\r\n            }}>\r\n              {gpsStatus === 'active' && 'üü¢ GPS activo - Transmitiendo ubicaci√≥n'}\r\n              {gpsStatus === 'activating' && 'üü° Activando GPS... (Acepta los permisos del navegador)'}\r\n              {gpsStatus === 'error' && 'üî¥ Error en GPS - Verificar permisos del navegador'}\r\n            </div>\r\n          )}\r\n          \r\n          {/* Ajuste manual de ubicaci√≥n para mejor precisi√≥n */}\r\n          {userPosition && (\r\n            <details style={{\r\n              marginTop: '8px',\r\n              padding: '8px',\r\n              background: '#f0f9ff',\r\n              borderRadius: '6px',\r\n              border: '1px solid #bae6fd'\r\n            }}>\r\n              <summary style={{\r\n                cursor: 'pointer',\r\n                fontSize: '12px',\r\n                fontWeight: 'bold',\r\n                color: '#0369a1'\r\n              }}>\r\n                üéØ Ajustar ubicaci√≥n manualmente\r\n              </summary>\r\n              <div style={{ marginTop: '8px' }}>\r\n                <p style={{ fontSize: '11px', color: '#666', marginBottom: '8px' }}>\r\n                  Si el GPS no es preciso, puedes ajustar tu ubicaci√≥n:\r\n                </p>\r\n                <button\r\n                  onClick={() => {\r\n                    // Abrir Google Maps para obtener coordenadas exactas\r\n                    window.open(`https://www.google.com/maps?q=${userPosition.lat},${userPosition.lng}`, '_blank');\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '6px',\r\n                    marginBottom: '6px',\r\n                    background: '#4285F4',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    borderRadius: '4px',\r\n                    fontSize: '11px',\r\n                    cursor: 'pointer'\r\n                  }}\r\n                >\r\n                  üìç Ver ubicaci√≥n actual en Google Maps\r\n                </button>\r\n                <div style={{ display: 'flex', gap: '4px', marginBottom: '6px' }}>\r\n                  <input\r\n                    type=\"number\"\r\n                    step=\"0.000001\"\r\n                    placeholder=\"Latitud\"\r\n                    id=\"manual-lat\"\r\n                    defaultValue={userPosition.lat}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '4px',\r\n                      fontSize: '11px',\r\n                      border: '1px solid #ddd',\r\n                      borderRadius: '4px'\r\n                    }}\r\n                  />\r\n                  <input\r\n                    type=\"number\"\r\n                    step=\"0.000001\"\r\n                    placeholder=\"Longitud\"\r\n                    id=\"manual-lng\"\r\n                    defaultValue={userPosition.lng}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '4px',\r\n                      fontSize: '11px',\r\n                      border: '1px solid #ddd',\r\n                      borderRadius: '4px'\r\n                    }}\r\n                  />\r\n                </div>\r\n                <button\r\n                  onClick={() => {\r\n                    const lat = parseFloat(document.getElementById('manual-lat').value);\r\n                    const lng = parseFloat(document.getElementById('manual-lng').value);\r\n                    if (!isNaN(lat) && !isNaN(lng)) {\r\n                      const manualPos = { lat, lng, accuracy: 5 }; // Alta precisi√≥n manual\r\n                      console.log('üìç Ubicaci√≥n ajustada manualmente:', manualPos);\r\n                      updateUserPosition(manualPos);\r\n                      alert('‚úÖ Ubicaci√≥n actualizada');\r\n                    } else {\r\n                      alert('‚ùå Coordenadas inv√°lidas');\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '6px',\r\n                    background: '#22c55e',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    borderRadius: '4px',\r\n                    fontSize: '11px',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 'bold'\r\n                  }}\r\n                >\r\n                  ‚úÖ Aplicar ubicaci√≥n manual\r\n                </button>\r\n                <p style={{ fontSize: '10px', color: '#666', marginTop: '6px' }}>\r\n                  üí° Tip: Haz clic derecho en Google Maps ‚Üí \"¬øQu√© hay aqu√≠?\" para obtener coordenadas exactas\r\n                </p>\r\n              </div>\r\n            </details>\r\n          )}\r\n          \r\n          {/* Bot√≥n de prueba manual de ubicaci√≥n */}\r\n          {!userPosition && isTracking && gpsStatus === 'activating' && (\r\n            <button\r\n              onClick={() => {\r\n                // Usar ubicaci√≥n de prueba en Quill√≥n si el GPS real falla\r\n                const testPosition = {\r\n                  lat: -36.7333,\r\n                  lng: -72.4667\r\n                };\r\n                console.log('üìç Usando ubicaci√≥n de prueba');\r\n                updateUserPosition(testPosition);\r\n                setGpsStatus('active');\r\n              }}\r\n              style={{\r\n                marginTop: '8px',\r\n                width: '100%',\r\n                padding: '8px',\r\n                background: '#6b7280',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                fontSize: '12px',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              üîß Usar ubicaci√≥n de prueba (Quill√≥n)\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Notificaciones de nuevas zonas */}\r\n        {notificaciones.length > 0 && (\r\n          <div style={{\r\n            marginBottom: '15px',\r\n            padding: '10px',\r\n            background: '#fef3c7',\r\n            border: '1px solid #fde68a',\r\n            borderRadius: '8px'\r\n          }}>\r\n            <h4 style={{ margin: '0 0 8px 0', fontSize: '14px', color: '#92400e' }}>\r\n              üîî Nuevas notificaciones ({notificaciones.length})\r\n            </h4>\r\n            {notificaciones.map(notif => (\r\n              <div key={notif.id} style={{ fontSize: '12px', marginBottom: '4px' }}>\r\n                ‚Ä¢ {notif.mensaje}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Selector de zona ACTUALIZADO */}\r\n        {isTracking && workStatus === 'idle' && (\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ \r\n              display: 'block', \r\n              marginBottom: '8px', \r\n              fontSize: '14px', \r\n              fontWeight: '500' \r\n            }}>\r\n              üèóÔ∏è Seleccionar Zona de Trabajo:\r\n            </label>\r\n            {zonasAsignadas.length > 0 ? (\r\n              <select\r\n                value={selectedZona?.id || ''}\r\n                onChange={(e) => {\r\n                  const zona = zonasAsignadas.find(z => z.id === e.target.value);\r\n                  if (zona) selectZona(zona);\r\n                }}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '10px',\r\n                  borderRadius: '6px',\r\n                  border: '1px solid #ddd',\r\n                  fontSize: '14px'\r\n                }}\r\n              >\r\n                <option value=\"\">-- Seleccionar zona --</option>\r\n                {zonasAsignadas.map(zona => (\r\n                  <option key={zona.id} value={zona.id}>\r\n                    {zona.nombre} - {zona.direccion}\r\n                    {zona.prioridad === 'urgente' && ' üö®'}\r\n                    {zona.prioridad === 'alta' && ' üî¥'}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            ) : (\r\n              <div style={{\r\n                padding: '10px',\r\n                background: '#f3f4f6',\r\n                borderRadius: '6px',\r\n                textAlign: 'center',\r\n                fontSize: '13px',\r\n                color: '#6b7280'\r\n              }}>\r\n                No tienes zonas asignadas actualmente\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Informaci√≥n de zona seleccionada */}\r\n        {selectedZona && (\r\n          <div style={{\r\n            background: '#f0f9ff',\r\n            padding: '12px',\r\n            borderRadius: '8px',\r\n            marginBottom: '15px',\r\n            border: '1px solid #bae6fd'\r\n          }}>\r\n            <h4 style={{ margin: '0 0 8px 0', color: '#0369a1', fontSize: '14px' }}>\r\n              Zona Seleccionada:\r\n            </h4>\r\n            <div style={{ fontSize: '13px', color: '#333' }}>\r\n              <strong>{selectedZona.nombre}</strong><br/>\r\n              üìç {selectedZona.direccion}\r\n              {distance && duration && (\r\n                <div style={{ marginTop: '8px', color: '#666' }}>\r\n                  üöó {distance} ‚Ä¢ ‚è±Ô∏è {duration}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Botones de acci√≥n seg√∫n estado */}\r\n        {workStatus === 'idle' && selectedZona && userPosition && (\r\n          <button\r\n            onClick={startNavigation}\r\n            style={{\r\n              width: '100%',\r\n              padding: '12px',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '16px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer'\r\n            }}\r\n          >\r\n            üöó Iniciar Recorrido\r\n          </button>\r\n        )}\r\n\r\n        {workStatus === 'traveling' && (\r\n          <div style={{\r\n            background: '#fef3c7',\r\n            padding: '12px',\r\n            borderRadius: '8px',\r\n            textAlign: 'center',\r\n            border: '1px solid #fde68a'\r\n          }}>\r\n            <div style={{ fontSize: '16px', fontWeight: '500', color: '#92400e' }}>\r\n              üöó En camino...\r\n            </div>\r\n            <div style={{ fontSize: '12px', marginTop: '4px', color: '#78350f' }}>\r\n              Hora de salida: {formatTime(workLog.startTime)}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {workStatus === 'working' && (\r\n          <div>\r\n            <div style={{\r\n              background: '#dcfce7',\r\n              padding: '12px',\r\n              borderRadius: '8px',\r\n              marginBottom: '12px',\r\n              border: '1px solid #bbf7d0'\r\n            }}>\r\n              <div style={{ fontSize: '16px', fontWeight: '500', color: '#14532d' }}>\r\n                ‚úÖ En zona de trabajo\r\n              </div>\r\n              <div style={{ fontSize: '12px', marginTop: '4px', color: '#166534' }}>\r\n                Llegada: {formatTime(workLog.arrivalTime)}\r\n              </div>\r\n            </div>\r\n            <button\r\n              onClick={finishWork}\r\n              style={{\r\n                width: '100%',\r\n                padding: '12px',\r\n                background: '#dc2626',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '8px',\r\n                fontSize: '16px',\r\n                fontWeight: '500',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              üèÅ Finalizar Trabajo\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {workStatus === 'completed' && (\r\n          <div>\r\n            <div style={{\r\n              background: '#e0e7ff',\r\n              padding: '12px',\r\n              borderRadius: '8px',\r\n              marginBottom: '12px',\r\n              border: '1px solid #c7d2fe'\r\n            }}>\r\n              <div style={{ fontSize: '16px', fontWeight: '500', color: '#312e81' }}>\r\n                ‚úÖ Trabajo Completado\r\n              </div>\r\n              <button\r\n                onClick={() => setShowWorkLog(!showWorkLog)}\r\n                style={{\r\n                  marginTop: '8px',\r\n                  padding: '6px 12px',\r\n                  background: '#4f46e5',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  fontSize: '12px',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                üìã Ver Resumen\r\n              </button>\r\n            </div>\r\n            <button\r\n              onClick={resetWork}\r\n              style={{\r\n                width: '100%',\r\n                padding: '12px',\r\n                background: '#22c55e',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '8px',\r\n                fontSize: '16px',\r\n                fontWeight: '500',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              üîÑ Nuevo Trabajo\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modal de resumen de trabajo */}\r\n      {showWorkLog && workLog.zona && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.5)',\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          zIndex: 2000,\r\n          padding: '20px'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            borderRadius: '12px',\r\n            padding: '20px',\r\n            maxWidth: '400px',\r\n            width: '100%',\r\n            maxHeight: '80vh',\r\n            overflow: 'auto'\r\n          }}>\r\n            <h3 style={{ margin: '0 0 20px 0', color: '#1f2937' }}>\r\n              üìã Resumen del Trabajo\r\n            </h3>\r\n            \r\n            <div style={{ fontSize: '14px', lineHeight: '1.8' }}>\r\n              <div style={{ marginBottom: '15px' }}>\r\n                <strong>Zona de trabajo:</strong><br/>\r\n                {workLog.zona.nombre}<br/>\r\n                üìç {workLog.zona.direccion}\r\n              </div>\r\n              \r\n              <div style={{\r\n                background: '#f8fafc',\r\n                padding: '12px',\r\n                borderRadius: '8px',\r\n                marginBottom: '15px'\r\n              }}>\r\n                <div style={{ marginBottom: '8px' }}>\r\n                  <strong>üöó Hora de salida:</strong> {formatTime(workLog.startTime)}\r\n                </div>\r\n                <div style={{ marginBottom: '8px' }}>\r\n                  <strong>‚úÖ Hora de llegada:</strong> {formatTime(workLog.arrivalTime)}\r\n                </div>\r\n                <div style={{ marginBottom: '8px' }}>\r\n                  <strong>üèÅ Hora de t√©rmino:</strong> {formatTime(workLog.endTime)}\r\n                </div>\r\n                <hr style={{ margin: '10px 0', border: 'none', borderTop: '1px solid #e5e7eb' }}/>\r\n                <div>\r\n                  <strong>‚è±Ô∏è Tiempo de viaje:</strong> {calculateDuration(workLog.startTime, workLog.arrivalTime)}\r\n                </div>\r\n                <div>\r\n                  <strong>‚è±Ô∏è Tiempo trabajado:</strong> {calculateDuration(workLog.arrivalTime, workLog.endTime)}\r\n                </div>\r\n                <div>\r\n                  <strong>‚è±Ô∏è Tiempo total:</strong> {calculateDuration(workLog.startTime, workLog.endTime)}\r\n                </div>\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setShowWorkLog(false)}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '10px',\r\n                  background: '#6b7280',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  fontSize: '14px',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Cerrar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Mapa */}\r\n      <div \r\n        ref={mapRef}\r\n        style={{ \r\n          width: '100%', \r\n          height: '100%'\r\n        }} \r\n      />\r\n      \r\n      {/* Indicador de carga */}\r\n      {!mapLoaded && (\r\n        <div style={{\r\n          position: 'absolute',\r\n          top: '50%',\r\n          left: '50%',\r\n          transform: 'translate(-50%, -50%)',\r\n          textAlign: 'center',\r\n          zIndex: 1001\r\n        }}>\r\n          <div style={{\r\n            width: '50px',\r\n            height: '50px',\r\n            border: '4px solid #f3f3f3',\r\n            borderTop: '4px solid #22c55e',\r\n            borderRadius: '50%',\r\n            animation: 'spin 1s linear infinite'\r\n          }}></div>\r\n          <p style={{ marginTop: '10px', color: '#666' }}>Cargando mapa...</p>\r\n        </div>\r\n      )}\r\n\r\n      <style jsx>{`\r\n        @keyframes spin {\r\n          0% { transform: rotate(0deg); }\r\n          100% { transform: rotate(360deg); }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SistemaTrabajadoresFirebase;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}